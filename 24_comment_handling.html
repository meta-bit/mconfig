<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://meta-bit.github.io/mconfig/24_comment_handling.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>2.4 Comment Handling - mConfig Documentation</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2.4 Comment Handling";
        var mkdocs_page_input_path = "24_comment_handling.md";
        var mkdocs_page_url = "/mconfig/24_comment_handling.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> mConfig Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Part 1 Introduction & Basics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="11_what_is_mconfig.html">1.1 What is mConfig?</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="12_features_and_use_cases.html">1.2 Features and Use Cases</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="13_getting_started.html">1.3 Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="14_regular_use.html">1.4 Regular Use</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="15_test_mode.html">1.5 Test Mode</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Part 2 Core Concepts</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="21_how_it_works.html">2.1 How it Works</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="22_priorities_and_hierarchies.html">2.2 Priorities and Hierarchies</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="23_configuration_schemes.html">2.3 Configuration Schemes</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">2.4 Comment Handling</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#core-principles">Core Principles</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#programmatic-comments">Programmatic Comments</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configuration-features">Configuration Features</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#format-support-matrix">Format Support Matrix</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#implementation-details">Implementation Details</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#multi-line-comments">Multi-line Comments</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#heuristics-and-association">Heuristics and Association</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#priority-and-merging">Priority and Merging</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="25_config_features.html">2.5 Config Features</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Part 3 Advanced Topics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="31_writing_configurations.html">3.1 Writing Configurations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="32_updates.html">3.2 Updates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="33_getting_information.html">3.3 Getting Information</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="34_definitions_and_valid_values.html">3.4 Definitions and Valid Values</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="35_handling_secrets.html">3.5 Handling Secrets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="36_windows_registry.html">3.6 Windows Registry Access</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="37_extensions_and_advanced_use.html">3.7 Extensions and Advanced Use</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="38_code_improvements.html">3.8 Code Improvements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Part 4 Reference & Project</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="41_mconfig_tool.html">4.1 mConfig Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="42_logging.html">4.2 Logging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="43_faq.html">4.3 FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="44_design_consolidated.html">4.4 Design Consolidated</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="45_ai_guidance.html">4.5 AI Guidance</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="46_versions.html">4.6 Versions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="47_contributing.html">4.7 Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="48_legal.html">4.8 Legal</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="examples/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/simple_configuration_loading.html">Simple Configuration Loading</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/advanced_configuration_handling.html">Advanced Configuration Handling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/integration_with_cicd.html">Integration with CI/CD</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/testing_configurations.html">Testing Configurations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/mconfig-modules.html">mConfig Modules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/java-modules.html">JPMS (Java Modules)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/configuration_views.html">Configuration Views</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/zookeeper.html">ZooKeeper</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/handling_crypto_keys_and_certificates.html">Handling Crypto Keys and Certificates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="examples/schemes.html">Schemes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendix</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="49_links.html">4.9 Links</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mConfig Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Part 2 Core Concepts</li>
      <li class="breadcrumb-item active">2.4 Comment Handling</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="24-comment-handling-in-mconfig">2.4 Comment Handling in mConfig<a class="headerlink" href="#24-comment-handling-in-mconfig" title="Permanent link">&para;</a></h1>
<p>Of the possible configuration sources, files are the ones that support comments. 
Comments in configuration files are an important source of information for users. They can be used to explain configuration options, document decisions, provide context, or include relevant links.</p>
<p>mConfig aims to keep comments intact in configuration files to ensure that human-readable information is not lost during programmatic updates.</p>
<h2 id="core-principles">Core Principles<a class="headerlink" href="#core-principles" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Write-Preservation</strong>: Writing to a configuration file should not erase existing comments.</li>
<li><strong>Read-Write Symmetry</strong>: Maintaining the original structure and documentation of the file is a priority.</li>
<li><strong>Human-Centric</strong>: Comments are for humans. They should not be used for machine processing or "shebang" style logic.</li>
</ul>
<h2 id="programmatic-comments">Programmatic Comments<a class="headerlink" href="#programmatic-comments" title="Permanent link">&para;</a></h2>
<p>While mConfig prioritizes preserving existing comments, it also supports adding comments programmatically:</p>
<ol>
<li><strong>Description from Scheme</strong>: When an entry is first created, mConfig can automatically include the description defined in the <code>ConfigScheme</code> as a comment. This is controlled by the <code>ConfigFeature.DESCRIPTION_ON_CREATE</code> feature.</li>
<li><strong>Explicit Comments</strong>: Developers can add comments to a <code>ConfigEntry</code> using the <code>setComment(String)</code> method. This is useful for documenting automated changes (e.g., "# AUTO-REDUCED: Disk space was below 5%").</li>
</ol>
<h2 id="configuration-features">Configuration Features<a class="headerlink" href="#configuration-features" title="Permanent link">&para;</a></h2>
<p>The behavior of comment handling is governed by several <code>ConfigFeature</code> flags:</p>
<ul>
<li><strong><code>ConfigFeature.COMMENTS_WRITING</code></strong> (default: <code>false</code>): When set to <code>true</code>, mConfig will write programmatic comments to the configuration. Even when <code>false</code>, the library still attempts to preserve <em>existing</em> comments for supported formats.</li>
<li><strong><code>ConfigFeature.COMMENTS_READING</code></strong> (default: <code>false</code>): Enables reading comments from files into the <code>ConfigEntry</code> objects. Note that determining exactly which lines belong to which key is heuristic-based and may not be perfect for all formats.</li>
<li><strong><code>ConfigFeature.DESCRIPTION_ON_CREATE</code></strong> (default: <code>false</code>): When <code>true</code>, uses the <code>description</code> field from the <code>ConfigSchemeEntry</code> to populate comments for new entries.</li>
</ul>
<h2 id="format-support-matrix">Format Support Matrix<a class="headerlink" href="#format-support-matrix" title="Permanent link">&para;</a></h2>
<p>Preservation of comments depends on the underlying format module. Some high-level libraries (like Jackson) may strip comments by design.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">File Format</th>
<th style="text-align: left;">mConfig Module</th>
<th style="text-align: left;">Preserve Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>.properties</code></td>
<td style="text-align: left;"><code>mConfigFormatJavaProperties</code></td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;"><code>INI</code></td>
<td style="text-align: left;"><code>mConfigFormatINI</code></td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;"><code>TOML</code></td>
<td style="text-align: left;"><code>mConfigFormatTOML</code></td>
<td style="text-align: left;">Yes</td>
</tr>
<tr>
<td style="text-align: left;"><code>YAML</code></td>
<td style="text-align: left;"><code>mConfigFormatYAMLwithSnakeYAML</code></td>
<td style="text-align: left;">Partially</td>
</tr>
<tr>
<td style="text-align: left;"><code>TOML</code></td>
<td style="text-align: left;"><code>mConfigFormatTOMLwithJackson</code></td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;"><code>YAML</code></td>
<td style="text-align: left;"><code>mConfigFormatYAMLwithJackson</code></td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;"><code>JSON</code></td>
<td style="text-align: left;"><code>mConfigFormatJSONwithJackson</code></td>
<td style="text-align: left;">No</td>
</tr>
<tr>
<td style="text-align: left;"><code>JSON5</code></td>
<td style="text-align: left;"><code>mConfigFormatJSONwithJackson</code></td>
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
<h2 id="implementation-details">Implementation Details<a class="headerlink" href="#implementation-details" title="Permanent link">&para;</a></h2>
<h3 id="multi-line-comments">Multi-line Comments<a class="headerlink" href="#multi-line-comments" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Representation</strong>: Represented as a single <code>String</code> with <code>\n</code> line separators.</li>
<li><strong>Markers</strong>: On reading, format-specific markers (e.g., <code>#</code>, <code>!</code>, <code>;</code>) are preserved.</li>
<li><strong>Writing</strong>: mConfig ensures each line is correctly prefixed with the format's primary marker if it's missing.</li>
</ul>
<h3 id="heuristics-and-association">Heuristics and Association<a class="headerlink" href="#heuristics-and-association" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Leading Comments</strong>: Consecutive comment lines immediately preceding a key are associated with that key.</li>
<li><strong>Global Headers</strong>: Comment blocks at the top of a file (or between entries) separated by empty lines are treated as "Global Headers". They are preserved and rewritten at the top of the file but are not attached to any specific <code>ConfigEntry</code>.</li>
<li><strong>Inline Comments</strong>: Comments on the same line as a value are appended to the entry's comment string on a best-effort basis.</li>
</ul>
<h3 id="priority-and-merging">Priority and Merging<a class="headerlink" href="#priority-and-merging" title="Permanent link">&para;</a></h3>
<p>When writing an entry, comments are merged based on the following priority (top to bottom):
1.  <strong>Description from Scheme</strong>: If <code>DESCRIPTION_ON_CREATE=true</code> and the entry is new.
2.  <strong>Existing Comments</strong>: Preserved from the original file.
3.  <strong>Programmatic Comments</strong>: Added via <code>ConfigEntry.setComment()</code>.</p>
<p><em>Duplicate lines are automatically filtered during the merge process.</em></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="23_configuration_schemes.html" class="btn btn-neutral float-left" title="2.3 Configuration Schemes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="25_config_features.html" class="btn btn-neutral float-right" title="2.5 Config Features">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="23_configuration_schemes.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="25_config_features.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
