{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"mConfig Documentation","text":"<p>mConfig is a modular Java library for unified, portable configuration management. It abstracts OS-specific locations (e.g., <code>~/.config/</code>, <code>/etc/</code>, Windows Registry), multiple sources (files, env vars, JAR resources, ZooKeeper), and formats (JSON, YAML, TOML, Properties, etc.). The mConfig Tool is a powerful companion for exploring and managing these configurations from the command line.</p> <p>Core Principle: Layered resolution stack prioritizes scopes (highest first):</p> <p>```mermaid graph LR   POLICY[POLICYEnforced/GPO] --&gt; RUNTIME[RUNTIMEVolatile RAM]   RUNTIME --&gt; SESSION[SESSIONEnv/CLI]   SESSION --&gt; USER[USER~/.config/]   USER --&gt; APPLICATION[APPLICATIONPortable/Install]   APPLICATION --&gt; HOST[HOST/etc/, HKLM]   HOST --&gt; CLUSTER[CLUSTERZK/Networks]   CLUSTER --&gt; CLOUD[CLOUDProviders]   CLOUD --&gt; ORGANIZATION[ORGANIZATIONLicensee]   ORGANIZATION --&gt; PRODUCT[PRODUCTJAR Defaults]</p> <p>classDef high fill:#ff9999   class POLICY,RUNTIME high   ```</p> <p>Ties within scope: Later-added &gt; earlier; storage prio: RAM &gt; secrets &gt; files &gt; registry &gt; JAR.</p> <p>Quick Start: What is mConfig? \u2192 Getting Started</p> <p>Architecture: Design Consolidated</p>"},{"location":"index.html#part-1-introduction-basics","title":"Part 1: Introduction &amp; Basics","text":"<ul> <li>1.1 What is mConfig?</li> <li>1.2 Features and Use Cases</li> <li>1.3 Getting Started</li> <li>1.4 Regular Use</li> <li>1.5 Test Mode</li> </ul>"},{"location":"index.html#part-2-core-concepts","title":"Part 2: Core Concepts","text":"<ul> <li>2.1 How it Works</li> <li>2.2 Priorities and Hierarchies</li> <li>2.3 Configuration Schemes</li> <li>2.4 Comment Handling</li> <li>2.5 Config Features</li> </ul>"},{"location":"index.html#part-3-advanced-topics","title":"Part 3: Advanced Topics","text":"<ul> <li>3.1 Writing Configurations</li> <li>3.2 Updates</li> <li>3.3 Getting Information</li> <li>3.4 Definitions and Valid Values</li> <li>3.5 Handling Secrets</li> <li>3.6 Windows Registry Access</li> <li>3.7 Extensions and Advanced Use</li> <li>3.8 Code Improvements and Best Practices</li> </ul>"},{"location":"index.html#part-4-reference-project","title":"Part 4: Reference &amp; Project","text":"<ul> <li>4.1 mConfig Tool</li> <li>4.2 Logging</li> <li>4.3 FAQ</li> <li>4.4 Design Consolidated</li> <li>4.5 AI Guidance (Notes for Code-Generating Tools)</li> <li>4.6 Versions</li> <li>4.7 Contributing</li> <li>4.8 Legal</li> <li>Examples</li> <li>4.9 Links and References</li> </ul>"},{"location":"11_what_is_mconfig.html","title":"1.1 What is mConfig?","text":"<p>mConfig: unified, portable configuration access</p>"},{"location":"11_what_is_mconfig.html#what-is-it","title":"What is it?","text":"<p>mConfig is a (Java) library for configuration access. It allows to access configuration data without prior knowledge.</p> <ul> <li>compliant with OS/platform rules</li> <li>from many sources (files, network, hardware, registries, environment, \u2026)</li> <li>in many formats (.properties, JSON, YAML, \u2026)</li> </ul> <p>It consists of several modules, so it can be kept small and adapted to the specific use case.</p>"},{"location":"11_what_is_mconfig.html#minimal-example","title":"minimal example","text":"<p><pre><code>    Configuration cfg = ConfigUtil.quickConfig(\"ACME\",\"ourApp\",\"itsConfig\");\nString message = cfg.getString(\"hello\");\nSystem.out.println(message);\n</code></pre> See examples for the recommended way to do this, and sample code for some use cases.</p>"},{"location":"11_what_is_mconfig.html#getting-started","title":"getting started","text":"<p>Proceed to the Getting Started section for step-by-step instructions on integrating mConfig into your project, including dependencies, first code examples, and resource placement.</p>"},{"location":"11_what_is_mconfig.html#features","title":"Features","text":"<ul> <li>unifying access, abstracting OS specifics</li> <li>cross-platform development</li> <li>support for CI/CD and automated testing</li> <li> <p>not a framework, but a modular library</p> </li> <li> <p>File formats supported: JSON, JSON5, YAML, TOML, INI, Java Properties, raw binary and raw text files</p> </li> <li>File formats planned: ASN.1 and PEM, DHALL, HOCON.</li> </ul>"},{"location":"11_what_is_mconfig.html#open-source","title":"Open Source","text":"<p>mConfig is an open source project distributed under the CC-BY-ND 4.0 license. Commercial use is free of charge. The source code is available on github.</p>"},{"location":"11_what_is_mconfig.html#status","title":"Status","text":"<p>mConfig as of 0.7 is in pre-release; usable, but work in progress</p>"},{"location":"11_what_is_mconfig.html#citing-mconfig","title":"Citing mConfig","text":"<p>If you use mConfig in research or technical documentation, you can cite it as:</p> <p>metabit JWilkes. mConfig: Unified Configuration Access (2002-present). Available at: https://metabit.org</p> <pre><code>@misc{mConfig,\nauthor = { J.Wilkes, metabit },\ntitle = {mConfig: Unified Configuration Access},\nyear = {2026},\nurl = {https://metabit.org/}\n}\n</code></pre>"},{"location":"12_features_and_use_cases.html","title":"1.2 Features and Use Cases","text":"<p>mConfig abstracts configuration access.</p> <p>mConfig:</p> <ul> <li>abstracts OS platform differences in configuration locations</li> <li>makes cross-platform configuration access easier</li> <li>abstracts config file formats</li> <li>automatically detects changes to configuration sources</li> <li>provides a fallback hierarchy for defaults</li> <li>supports hierarchical scopes, e.g. user settings override local installation settings</li> <li>provides a TEST mode for automated tests</li> <li>supports development vs. production separation</li> <li>supports optional parameter type checking and parsing</li> <li>supports runtime documentation</li> <li>supports build-time documentation generation</li> </ul> <p>You set things up, then your code can just getInteger(), getString(), getBoolean(), getBigDecimal() and so on from the Configuration object, whenever it needs a config value.</p> <ul> <li>handles XDG Desktop standards overrides</li> <li>supports late-bound configurations (useful e.g. in cloud-native environments)</li> <li>supports multiple configuration sources</li> </ul>"},{"location":"13_getting_started.html","title":"1.3 Getting Started","text":""},{"location":"13_getting_started.html#131-include-the-library-in-your-project-build","title":"1.3.1 Include the library in your project build","text":"<p>For Java, start with adding the dependency to your project build:</p> <p>Maven: <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.metabit.platform.support.config&lt;/groupId&gt;\n&lt;artifactId&gt;mConfigStandard&lt;/artifactId&gt;\n&lt;version&gt;${mconfig.version}&lt;/version&gt;\n&lt;type&gt;pom&lt;/type&gt;\n&lt;/dependency&gt;\n</code></pre></p> <p>Gradle: <pre><code>implementation 'org.metabit.platform.support.config:mConfigStandard:${mconfig.version}'\n</code></pre> (update version as needed)</p> <p>In case you are defining an <code>module-info.java</code> in your project, add this to the <code>requires</code> section: <pre><code>    requires metabit.mconfig.core;\nrequires metabit.mconfig.util;\n</code></pre></p>"},{"location":"13_getting_started.html#starters-recommended","title":"Starters (Recommended)","text":"<p>For instant frustration-free setup, copy from examples/starters:</p> <ul> <li> <code>mvn compile exec:java</code></li> <li> <code>./gradlew run</code></li> <li> <code>mvn compile exec:java</code> (module-info included!)</li> </ul> <p>See each README for details.</p>"},{"location":"13_getting_started.html#snippets-quick-wins","title":"Snippets (Quick Wins \ud83d\ude80)","text":"<p>Copy-paste solutions for common config pains: hardcodes \u2192 env vars \u2192 secrets \u2192 tests.</p>"},{"location":"13_getting_started.html#132-start-with-a-simple-use-case","title":"1.3.2 Start with a simple use case","text":"<pre><code>    Config cfg = ConfigUtil.quickConfig(\"myCompany\",\"myApplication\",\"network\");\n\nString  peerName    = cfg.getString(\"peer\");\nint     portNumber  = cfg.getInteger(\"port\");\ndouble  probability = cfg.getDouble(\"probability\");\n//...\n</code></pre> <p>This will get you the requested values from the \"network\" configuration,  wherever in the standard directories or other places they are kept.</p> <p>If it's not working as expected, consult the Quick Verification Checklist in the FAQ.</p> <p>For more information on how to define the contract for your configurations (keys, types, defaults, and validation), see Configuration Schemes.</p>"},{"location":"13_getting_started.html#133-common-pitfalls","title":"1.3.3 Common Pitfalls","text":"<p>For advice on avoiding typical mistakes and leveraging feature flags effectively, see Code Improvements and Best Practices.</p>"},{"location":"13_getting_started.html#134-resource-placement-the-config-folder","title":"1.3.4 Resource Placement (the .config/ folder)","text":"<p>To bundle configurations, schemes, or library settings with your application,  use the <code>.config/</code> resource folder in your classpath (e.g., <code>src/main/resources/.config/</code>).</p> <ul> <li>Configurations: <code>.config/&lt;company&gt;/&lt;application&gt;/&lt;configName&gt;.&lt;ext&gt;</code></li> <li>Schemes: <code>.config/&lt;company&gt;/&lt;application&gt;/&lt;configName&gt;.scheme.json</code></li> <li>Library Self-Configuration: <code>.config/metabit/mConfig/mconfig.properties</code></li> </ul> <p>For testing, as a starting point,  you can create a <code>.config/myCompany/myApplication/network.properties</code> in subdirectories of your home directory, and see its contents turn up in your code.</p> <p>Regular paths would be in <code>/etc/myCompany/myApplication/network.properties</code> for Linux, <code>%AppData%\\myCompany\\myApplication\\network.properties</code> for Windows, and so on - and taking care of all these different locations is part of the library. Also, parsing different formats like JSON, YAML, and so on. And much more.</p> <p>The cleaner way, without shortcuts, goes like this:</p> <pre><code>   try (ConfigFactory factory = ConfigFactoryBuilder.create(\"myCompany\", \"myApplication\").build())\n{\nConfig cfg = factory.getConfiguration(\"network\");\n\nString  peerName    = cfg.getString(\"peer\");\nint     portNumber  = cfg.getInteger(\"port\");\ndouble  probability = cfg.getDouble(\"probability\");\n//...\n}\n</code></pre> <p>The try-with-resources in the top line instantiates the library with all defaults; the getConfiguration() line asks for a specific configuration, and then you can get config entries, typesafe.</p> <p>You can also list all available configuration names:</p> <pre><code>   try (ConfigFactory factory = ConfigFactoryBuilder.create(\"myCompany\", \"myApplication\").build())\n{\nSet&lt;ConfigDiscoveryInfo&gt; info = factory.listAvailableConfigurations();\nfor (ConfigDiscoveryInfo c : info)\n{\nSystem.out.println(\"Found: \" + c.getConfigName() + \" in scope \" + c.getScope() + \" URL: \" + c.getUri());\n}\n}\n</code></pre> <p>Caveat: When you use the values stored in your local variables, you miss out on receiving changes.  It is preferable to use the mConfig objects directly; they'll have the latest values.</p>"},{"location":"13_getting_started.html#135-search-list-and-priority","title":"1.3.5 Search List and Priority","text":"<p>Everything should just work, by default. But in some environments, you may want to customize the search list, or the storage types priority, or the file format priority... </p> <p>You can add extra directories to the search list, or change the priority of the storage types.</p> <p>see 2.2 Priorities and Hierarchies for details.</p>"},{"location":"13_getting_started.html#136-navigating-lists-with-configcursor","title":"1.3.6 Navigating Lists with ConfigCursor","text":"<p>Configuration formats that support arrays (like YAML, JSON, or TOML) may have lists/sets where the entries are not named, have no key.</p> <p>So you can't access them by name. </p> <p>You can use the <code>ConfigCursor</code> to navigate through list items as individual nodes.</p> <p>(Actually, you can use the ConfigCursor for all the configuration;  it is just especially useful for navigating lists.)</p> <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"myCompany\", \"myApp\").build())\n{\nConfig cfg = factory.getConfig(\"myConfig\");\nConfigCursor cursor = cfg.getConfigCursor();\n\nif (cursor.moveTo(\"servers\") &amp;&amp; cursor.isOnList())\n{\ncursor.enter(); // Move into the array\nwhile (cursor.moveNext())\n{\n// Now positioned on a list item.\n// Items can be accessed as unnamed entries via virtual keys (indices).\nConfigEntry item = cursor.getCurrentElement();\nSystem.out.println(\"Server: \" + item.getValueAsString());\n}\ncursor.leave(); // Move back up to the \"servers\" node\n}\n}\n</code></pre>"},{"location":"13_getting_started.html#137-module-system-considerations","title":"1.3.7 Module System Considerations","text":"<p>mConfig uses the Java Module System. The architecture is:</p> <ul> <li><code>mConfigBase</code>: Aggregator module that bundles some standard dependencies</li> <li><code>metabit.mconfig.core</code>: Core functionality</li> <li><code>metabit.mconfig.util</code>: Utility functions</li> <li>Additional modules (e.g. Formats and configuration sources)</li> </ul> <p>When using Java modules, you must: 1. Include <code>mConfigBase</code> as a Maven/Gradle dependency 2. Explicitly require the core modules in your <code>module-info.java</code> 3. Require any additional modules you may need</p> <p>The internal modules are provided via services and do not have an API for your use, so you don't need to \"require\" them in your <code>module-info.java</code>.</p>"},{"location":"14_regular_use.html","title":"1.4 Regular Use","text":""},{"location":"14_regular_use.html#141-providing-a-default-configuration-product-scope","title":"1.4.1 Providing a default configuration (PRODUCT scope)","text":"<p>The lowest-priority layer is <code>PRODUCT</code> scope. Defaults come from two places: - ConfigScheme defaults (recommended for typed, documented defaults) - JAR resources (optional: ship default config files inside the JAR)</p> <p>For JAR resources, mConfig searches these paths (in order): - <code>.config/[&lt;company&gt;/]&lt;application&gt;/&lt;configName&gt;.&lt;ext&gt;</code> - <code>.config/&lt;application&gt;/&lt;configName&gt;.&lt;ext&gt;</code> - <code>.config/&lt;configName&gt;.&lt;ext&gt;</code></p> <p>In a Maven/Gradle project, place them here: - <code>src/main/resources/.config/[&lt;company&gt;/]&lt;application&gt;/&lt;configName&gt;.&lt;ext&gt;</code> (production) - <code>src/test/resources/.config/[&lt;company&gt;/]&lt;application&gt;/&lt;configName&gt;.&lt;ext&gt;</code> (tests)</p> <p>Note: <code>&lt;company&gt;</code> optional; omitted if blank/null/whitespace.  Normally, one should supply both company and application names. (company, organization, vendor, etc - we use \"company\" here for brevity.) While it is possible to omit the company name, it is not recommended. Some environments may use no company name by convention, but developing multi-platform,</p> <p>ConfigScheme defaults are always part of the PRODUCT scope default layer. If you want schemes to replace existing defaults rather than merge them, use <code>SCHEME_RESETS_DEFAULTS</code>.</p> <p>Note: JAR defaults are active when running from a JAR, but during development the JAR source still reads resources from the classpath, so the same paths work in IDE runs.</p>"},{"location":"14_regular_use.html#142-configuration-schemes-discovery","title":"1.4.2 Configuration Schemes Discovery","text":"<p>Config Schemes (<code>*.scheme.json</code>) are automatically discovered from the <code>.config/</code> directory on the classpath.</p> <ul> <li>Development Time: Both <code>src/main/resources/.config/</code> and <code>src/test/resources/.config/</code> are searched.</li> <li>Precedence: If a scheme for the same configuration name exists in both locations, the one found last by the <code>ClassLoader</code> takes precedence.</li> <li>Production vs Test: Unlike configuration data, schemes are not bypassed in <code>TEST_MODE</code>. Production schemes are always loaded from the classpath to ensure the configuration contract is maintained.</li> </ul> <p>Recommended: Place in the main resources only. Schemes are a \"contract\" for the configurations, so they should be valid both for testing and production.</p> <p>Most IDE don't do the testing with JAR files, they run class files from the directories instead. </p> <p>The JAR config source won't just take any relative path for its default values; either the files are within the JAR, or it refuses to use them. That is intentional behaviour for security and safety purposes.</p> <p>You can activate Test Mode, however: In Test Mode, the relative paths are  accepted (along with all the other directories test mode uses).</p>"},{"location":"14_regular_use.html#143-use-a-config-scheme","title":"1.4.3 Use a config scheme","text":""},{"location":"14_regular_use.html#1431-reasons","title":"1.4.3.1 Reasons","text":"<p>There are some benefits to declaring the contents of your configurations separately from the code. - better maintenance (all in one place, instead of scattered) - enables automated documentation (both runtime and compile-time), which is always up-to-date with the code, without extra work. - type safety for your configuration parameters - automatic parameter validation before your code gets the values.</p> <p>Ideally, for a configuration there is just theme ConfigScheme you declared, and the key names your code uses. Once the mConfig Configuration is instantiated, the sole connection between the code and the values should be the keys it asks for.</p> <p>(In the API, we stick with String keys for ease of use.  If you want to be strict in your development, you can declare an enum and use  its names as keys.)</p>"},{"location":"14_regular_use.html#1432-normal-use","title":"1.4.3.2 Normal use","text":"<p>Normally, you'll place a JSON file in a subfolder of your resource directory,  and that's it. </p> <p>The file name is the name of the Configuration you want to use, plus the suffix \".scheme.json\". It is a JSON(-style) file, following a specific format (see Configuration Schemes)</p> <p>You declare all the configuration parameters your code can or will use. mConfig will automatically detect and use these files.</p> <p>Example: If your code uses a Configuration named \"MyConfig\" for Company \"MyCompany\" and Application \"MyApplication\", you would place the corresponding scheme file in <code>src/main/resources/.config/MyCompany/MyApplication/MyConfig.scheme.json</code></p>"},{"location":"14_regular_use.html#1433-explicit-setting","title":"1.4.3.3 Explicit setting","text":"<p>If, for reasons whatsoever, you want to provide the configuration scheme yourself, prepare the JSON string according to the format. Convert it to a ConfigScheme <code>ConfigScheme testScheme = ConfigScheme.statics.fromJSON(yourConfigSchemeString);</code> and apply it to the respective Configuration <code>cfg.setConfigScheme(testScheme);</code>.</p> <p>Note: default values in your scheme will replace potentially existing defaults.</p>"},{"location":"14_regular_use.html#144-runtime-dynamic-configurations","title":"1.4.4 Runtime Dynamic Configurations","text":"<p>Mutable Puts: you can change the values of existing entries at runtime. Example: <pre><code>configFactory.put(\"voting.database.name\", \"dynamicDB\", ConfigScope.RUNTIME);\n</code></pre> The RUNTIME scope is at the highest priority \u00b9, so it overrides all others.</p> <p>So dynamically changing the configuration at runtime is quite possible.</p> <p>\u00b9: the highest priority of all regular scopes, that is. the POLICY scope can enforce its settings over everything else; that's for security reasons.</p>"},{"location":"14_regular_use.html#145-put-and-write","title":"1.4.5 Put and write","text":"<p>Configurations can be written to; the put operation is the same for all scopes. The puts are typed. You can pick either a single scope, or an enum set of scopes. When writing, mConfig follows the \"principle of least surprise\" when writing to a scope: - If an entry for the key already exists in a writeable layer within the scope, its contents are changed, and written. - If no entry for the key exists in the scope yet, it is created and written, if there is a writeable layer available within the scope or scopes specified. - If no writeable layer is available in the scope, the put fails with an exception. No silent data loss.</p>"},{"location":"15_test_mode.html","title":"1.5 Test Mode","text":"<p>mConfig has a test mode. This is to support software using mConfig in performing automated tests.</p> <p>Test mode supports: - manual tests by individual developers, - unit and integration testing, - the CI/CD pipeline test environment.</p> <p>One of the problems with tests is to replace the real, runtime environment with the test environment \u2013 preferably with as little residue in the actual code as possible.</p> <p>One of the solution approaches is to supply the code with different configurations, depending on whether it is run in test mode, or regular runtime mode.</p>"},{"location":"15_test_mode.html#goals","title":"Goals","text":"<p>We want to allow testing configurations without modifying the actual code.</p> <p>The simple, straightforward way would be to provide <code>ConfigFactoryBuilder</code> instances to your code, set up differently depending on whether testing or not. But that's breaking encapsulation, and cumbersome.</p> <p>Instead, we provide a way to change the <code>ConfigFactoryBuilder</code> behaviour for the entire VM - \"static\"-like. This way, all instances in the respective JVM are turned to test mode or production mode, including the paths and settings you also specify.</p> <p>This way, your test code can set the test environment in a @BeforeAll/@BeforeEach function before the tests start, while tests and code stay free of test-specific modifications in regard to mConfig.</p>"},{"location":"15_test_mode.html#use","title":"Use","text":""},{"location":"15_test_mode.html#activate-test-mode","title":"Activate Test Mode","text":"<p><code>ConfigFactoryBuilder.setTestMode(true);</code></p> <p>or with Environment Variables, e.g. <code>MCONFIG_RUNTIME_TEST_MODE=true</code></p> <p>(requirements for Environment Variables to have effect:  1. EnvVar source module present,  2. ALLOW_RUNTIME_FLAG set to true in the ConfigFactoryBuilder. )</p>"},{"location":"15_test_mode.html#effects-of-test-mode","title":"Effects of Test Mode","text":"<p>this will</p> <ul> <li>disable lookup in the regular file paths</li> <li>instead, use \"./src/test/config\" and \"./src/test/resources/config\" paths   relative to current working directory as base paths.   Resource-based configurations in <code>src/test/resources/config/{SCOPE}</code>    take precedence over project-level test configurations in <code>src/test/config</code>.</li> </ul> <p>This is based on the standard maven test run setup,   where the tests are run from one level above the src directory. - disable lookup in default network environments, if network config sources are active - enable lookup in test network environments, if available/configured. - switch JAR lookup from regular resources folder to test resources.   Instead of <code>src/main/resources/config</code> from source,   in test mode <code>src/test/resources/config</code> becomes the starting point   for JAR-file resolution.</p> <ul> <li>NB: JARs rarely compile in test resources! The JAR aspect takes effect    only if you are building test JARs in addition to the regular ones.</li> </ul>"},{"location":"15_test_mode.html#paths-for-test-mode","title":"Paths for Test Mode","text":"<p>Below the src/test/resources/config/ directory, we check for subdirectories with the scope names in all-caps, e.g. PRODUCT, APPLICATION, USER, to allow for placement of respective contents.</p> <p>In the other case, we go test/.config/COMPANY/PRODUCTNAME, to mirror such entries for production.</p> <p>So, activating test mode results in these directories searched for entries:</p>"},{"location":"15_test_mode.html#test-mode-search-paths","title":"Test mode search paths","text":"<p>In test mode, standard OS paths are bypassed. Use explicit paths via <code>ConfigFactoryBuilder.setFeature(ConfigFeature.TESTMODE_DIRECTORIES, List.of(\"USER:/tmp/test-user\"))</code> or fallbacks like <code>src/test/resources/.config/&amp;lt;company&amp;gt;/&amp;lt;app&amp;gt;/</code> and <code>src/test/resources/config/{SCOPE}</code> (resources &gt; project configs).</p> Scope Path Notes POLICY TESTMODE_DIRECTORIES \"POLICY:/path\" or src/test/resources/config/POLICY Highest RUNTIME src/test/resources/config/RUNTIME SESSION src/test/resources/config/SESSION USER src/test/resources/config/USER APPLICATION src/test/config/&lt;company&gt;/&lt;app&gt;/ or src/test/resources/config/APPLICATION HOST src/test/resources/config/HOST CLUSTER src/test/resources/config/CLUSTER CLOUD src/test/resources/config/CLOUD ORGANIZATION src/test/resources/config/ORGANIZATION PRODUCT src/main/resources/.config/&lt;company&gt;/&lt;app&gt;/ Lowest <p>NB: \"COMPANY\" and \"APP\" placeholders replaced by code values. Scope dirs verbatim UPPERCASE. Resources override project configs; scopes follow enum priority (higher scopes override lower).</p>"},{"location":"15_test_mode.html#custom-test-directories","title":"Custom test directories","text":"<p>You can provide a list of directories for <code>TESTMODE_DIRECTORIES</code> with their respective scope.</p> <p>Format: <code>SCOPENAME \":\" PATH</code> e.g. <code>USER:/~developer/mylocaltest</code> or <code>APPLICATION:/tmp/generatedautomatedtestingdir</code>.</p> <p>Multiple entries per scope are possible, and used in order. If the scope name is omitted or invalid, it defaults to <code>RUNTIME</code> scope.</p> <p>Note: In <code>TEST_MODE</code>, <code>ADDITIONAL_RUNTIME_DIRECTORIES</code> and <code>ADDITIONAL_USER_DIRECTORIES</code>  are intentionally ignored to prevent tests from accidentally interacting with real production data. Only <code>TESTMODE_DIRECTORIES</code> and the default test resource locations are used.</p>"},{"location":"15_test_mode.html#set-your-own-paths-legacy-api-for-some-test-environments","title":"Set your own paths (legacy API for some test environments)","text":"<p>ConfigFactoryBuilder.setTestConfigPaths() allows you to set multiple paths for  each scope, to be used in test mode. Deprecated; use the custom test directories above.</p> <pre><code>@BeforeAll\nvoid setUpTestEnvironment()\n{\nList&lt;String&gt; paths = List.of(\"/my/local/fixed/config/environment\");\nConfigFactoryBuilder.setTestMode(true); // activate and set defaults\nConfigFactoryBuilder.setTestFilePaths(paths); // replace\nConfigFactoryBuilder.setTestJARURIs(null); // turn off\n}\n</code></pre> <p>Deprecated legacy API: Paths added at <code>RUNTIME</code> scope.</p>"},{"location":"15_test_mode.html#security-considerations","title":"Security Considerations","text":"<p>To prevent accidental or malicious activation of test mode in production environments, mConfig employs a two-tier security gate system.</p>"},{"location":"15_test_mode.html#151-global-static-gate-forbidtestmode-permittestmode","title":"1.5.1 Global Static Gate (<code>forbidTestMode()</code> / <code>permitTestMode()</code>)","text":"<p>This is a JVM-wide master switch. Calling <code>ConfigFactoryBuilder.forbidTestMode()</code>  ensures that no code within the JVM can activate <code>TEST_MODE</code>,  regardless of other settings. This is intended for production environments  to provide a hard security boundary.</p>"},{"location":"15_test_mode.html#152-instance-dynamic-gate-permit_test_mode-feature","title":"1.5.2 Instance Dynamic Gate (<code>PERMIT_TEST_MODE</code> Feature)","text":"<p>This is a per-builder configuration flag. It acts as a final check  before an instance activates test mode.</p>"},{"location":"15_test_mode.html#productive-by-default","title":"\"Productive by Default\"","text":"<p>To simplify development, the <code>PERMIT_TEST_MODE</code> feature defaults to <code>true</code>.  This allows developers to activate <code>TEST_MODE</code> using a single flag  (via environment variables, system properties, or <code>setFeature</code>)  without needing to explicitly enable permissions in standard environments.</p>"},{"location":"15_test_mode.html#test-mode-proofing-lockdown","title":"\"Test Mode Proofing\" (Lockdown)","text":"<p>Despite with the default being <code>true</code>, <code>PERMIT_TEST_MODE</code> remains an useful security tool for some situations. In a complex process where <code>TEST_MODE</code> might be enabled globally (e.g., via <code>-DTEST_MODE=true</code>) to facilitate integration testing of some modules, a critical production-facing <code>ConfigFactory</code> can be locked down:</p> <p><pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"metabit\", \"CRITICAL_APP\")\n.setFeature(ConfigFeature.PERMIT_TEST_MODE, false) // Lockdown this instance\n.build())\n{\n// ...\n}\n</code></pre> Even if <code>TEST_MODE</code> is requested externally, this specific instance will remain in production mode, ensuring it never reads from <code>src/test/resources</code> or other untrusted test locations, like some dynamically generated test directories and -files.</p>"},{"location":"15_test_mode.html#activation-logic","title":"Activation Logic","text":"<p>Test mode is only enabled if both the global gate and the instance gate allow it. The following logic is enforced during the <code>build()</code> process:</p> <pre><code>// Test mode is only enabled if BOTH the global gate AND the instance gate allow it.\nif (testModePermitted &amp;&amp; configFactorySettings.getBoolean(PERMIT_TEST_MODE)) {\n// Activation occurs if either the global trigger or instance trigger is set.\nif (testModeActive || configFactorySettings.getBoolean(TEST_MODE)) {\nconfigFactorySettings.setBoolean(TEST_MODE, true);\n}\n}\nelse {\n// If either permission gate is closed, test mode is forced to false.\nconfigFactorySettings.setBoolean(TEST_MODE, false);\n}\n</code></pre>"},{"location":"15_test_mode.html#153-self-configuration-security","title":"1.5.3 Self-Configuration Security","text":"<p>mConfig's self-configuration feature (loading <code>mconfig.properties</code> from the classpath) is another area where security can be tightened. If you don't want the library to automatically configure itself from classpath resources, you can disable it:</p> <pre><code>ConfigFactoryBuilder.create(\"metabit\", \"APP\")\n.setFeature(ConfigFeature.ENABLE_SELF_CONFIGURATION, false)\n.build();\n</code></pre> <p>This is particularly important in security-sensitive applications to ensure that no unexpected features (like <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> or <code>TEST_MODE</code>) are enabled by a JAR file placed on the classpath.</p>"},{"location":"21_how_it_works.html","title":"2.1 How it Works","text":"<p>To get started, we need a lot of preparation and settings. These are collected in a factory builder, <code>ConfigFactoryBuilder</code>, which then builds a <code>ConfigFactory</code> with specific settings.</p>"},{"location":"21_how_it_works.html#self-configuration","title":"Self-Configuration","text":"<p>Before the ConfigFactory is fully operational, it may perform \"self-configuration\". If the <code>mConfigSourceJAR</code> module is active, the factory searches the classpath for: <code>.config/metabit/mConfig/mconfig.properties</code></p> <p>This feature is enabled by default. It can be disabled by setting the <code>ENABLE_SELF_CONFIGURATION</code> flag to <code>false</code> in the <code>ConfigFactoryBuilder</code>.</p> <p>Settings found in this file (or files, as it uses <code>ClassLoader.getResources()</code>)  are used to populate the internal <code>ConfigFactorySettings</code>. This allows the library to configure its own features  (like enabling environment variable processing via <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code>)  using its standard resource discovery layout.</p> <p>The ConfigFactory in turn produces individual Configuration objects.</p> <p>That's the startup phase; once that is done, you use the Configuration objects.</p>"},{"location":"21_how_it_works.html#concept-scopes","title":"Concept: Scopes","text":"<p>mConfig uses the concept of hierarchical scopes (from the pre-2000 metabit MAUS project).</p> <p>The software may have its generic defaults, which can be overridden by settings of the individual local installation. But if you allow user-based settings, these take precedence over the local installation; and settings given for the individual software instance run may override those, in turn. It's a hierarchy.</p> <p>Scope order (lowest to highest priority): <code>PRODUCT</code> -&gt; <code>ORGANIZATION</code> -&gt; <code>CLOUD</code> -&gt; <code>CLUSTER</code> -&gt; <code>HOST</code> -&gt; <code>APPLICATION</code> -&gt; <code>USER</code> -&gt; <code>SESSION</code> -&gt; <code>RUNTIME</code> -&gt; <code>POLICY</code></p>"},{"location":"21_how_it_works.html#scope-meanings-short-version","title":"Scope meanings (short version)","text":"Scope Intended use Typical sources PRODUCT Defaults shipped with the software. ConfigScheme defaults, JAR resources ORGANIZATION Company-level defaults and licensing. Registry, network services CLOUD Cloud-based configurations, shared across multiple clusters. Cloud services, network services CLUSTER Cluster-wide settings. ZooKeeper, network services HOST System-wide settings for one host. Filesystem, Registry, System properties APPLICATION Installation-specific settings (portable installs, side-by-side versions). Filesystem near the binary USER Per-user overrides and preferences. Filesystem, Registry SESSION Shell/session overrides. Environment variables, command-line RUNTIME In-memory changes at runtime. RAM layer POLICY Enforced overrides (highest priority). GPO/Registry, policy files"},{"location":"21_how_it_works.html#default-scope-and-source-hierarchy","title":"Default scope and source hierarchy","text":"<p>Resolution priority between different storage types (within the same scope) is deterministic.</p> <p>Default Storage Priority (Highest to Lowest): 1. <code>RAM</code> (In-memory overrides) 2. <code>secrets</code> (Encrypted/sensitive data) 3. <code>files</code> (Local filesystem) 4. <code>registry</code> (Windows Registry) 5. <code>registryjni</code> (Windows Registry JNI) 6. <code>zookeeper</code> (ZooKeeper module) 7. <code>JAR</code> (Classpath resources/defaults)</p> <p>Use <code>STORAGE_TYPE_PRIORITIES</code> to change this order within a scope.</p>"},{"location":"21_how_it_works.html#filesystem-search-paths-fileconfigstorage","title":"Filesystem search paths (FileConfigStorage)","text":"<p>The lists below show the default search paths as added to the search list. Earlier entries are preferred for creation; later entries override earlier ones within the same scope. <code>SUB_PATH</code> (if set) is appended to the application paths. <code>ADDITIONAL_*_DIRECTORIES</code> are prepended to their scope lists.</p> <p>Optional Company Segment: <code>&lt;company&gt;</code> omitted if <code>COMPANY_NAME</code> blank/null/whitespace (recommended but can be intentionally left blank for app-only paths). Examples below show both forms where applicable.</p> <p>Linux (and most Unix-like systems)</p> <p>HOST scope: - <code>$XDG_CONFIG_DIRS</code> (default <code>/etc/xdg</code>), each entry: <code>&lt;dir&gt;/&lt;app&gt;</code> - <code>/etc/opt/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> - <code>/etc/opt/&lt;app&gt;/&lt;subPath&gt;</code> - <code>/usr/local/etc/&lt;app&gt;/&lt;subPath&gt;</code> - <code>/etc/&lt;app&gt;/&lt;subPath&gt;</code></p> <p>USER scope: - <code>$XDG_CONFIG_HOME/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> (if set) - <code>~/.config/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> - <code>~/.&lt;app&gt;/&lt;subPath&gt;</code> -  SESSION scope: - <code>$PWD/.config/&lt;app&gt;/&lt;subPath&gt;</code></p> <p>Windows</p> <p>SESSION scope: - <code>%CD%\\\\.config\\\\&lt;app&gt;\\\\&lt;subPath&gt;</code> - <code>%CD%</code> (legacy side-by-side .ini, .properties, etc.)</p> <p>USER scope: - <code>%XDG_CONFIG_HOME%\\\\&lt;app&gt;\\\\&lt;subPath&gt;</code> (if set) - <code>%AppData%\\\\[&lt;company&gt;\\\\&lt;]&lt;app&gt;\\\\&lt;subPath&gt;</code> - <code>%LocalAppData%\\\\[&lt;company&gt;\\\\&lt;]&lt;app&gt;\\\\&lt;subPath&gt;</code> - <code>%UserProfile%\\\\.config\\\\&lt;app&gt;\\\\&lt;subPath&gt;</code></p> <p>APPLICATION scope: - <code>&lt;appDir&gt;\\\\.config</code> - <code>&lt;appDir&gt;</code></p> <p>HOST scope: - <code>%ProgramData%\\\\[&lt;company&gt;\\\\&lt;]&lt;app&gt;</code> - <code>%AllUsersProfile%\\\\[&lt;company&gt;\\\\&lt;]&lt;app&gt;</code></p> <p>macOS (experimental)</p> <p>USER scope: - <code>$XDG_CONFIG_HOME/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> (if set) - <code>~/Library/Application Support/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> - <code>~/Library/Preferences/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> - <code>~/.&lt;app&gt;/&lt;subPath&gt;</code></p> <p>HOST scope: - <code>/Library/Application Support/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code> - <code>/Library/Preferences/[&lt;company&gt;/]&lt;app&gt;/&lt;subPath&gt;</code></p> <p>APPLICATION scope: - <code>&lt;appDir&gt;/.config</code> - <code>&lt;appDir&gt;</code></p> <p>SESSION scope: - <code>$PWD/.config/&lt;app&gt;/&lt;subPath&gt;</code></p> <p>Android (experimental)</p> <p>APPLICATION scope: - <code>/data/data/&lt;app&gt;/files/.config/&lt;subPath&gt;</code> - <code>/data/data/&lt;app&gt;/files/&lt;subPath&gt;</code></p> <p>USER scope: - <code>/data/data/&lt;app&gt;/files/&lt;subPath&gt;</code> - <code>/storage/emulated/0/Android/data/&lt;app&gt;/files/.config/&lt;subPath&gt;</code> (if <code>EXTERNAL_STORAGE</code> set) - <code>/storage/emulated/0/Android/data/&lt;app&gt;/files/&lt;subPath&gt;</code></p> <p>SESSION scope: - <code>/data/data/&lt;app&gt;/cache/.config/&lt;subPath&gt;</code> - Plus Linux-style fallbacks.</p> <p>Fallback (unknown OS)</p> <p>USER scope: - <code>~/.&lt;app&gt;/&lt;subPath&gt;</code></p> <p>HOST scope: - <code>$PWD/.config/&lt;app&gt;/&lt;subPath&gt;</code></p>"},{"location":"21_how_it_works.html#the-process","title":"The Process","text":""},{"location":"21_how_it_works.html#layered-stack","title":"Layered Stack","text":"<p>When you ask for a ConfigEntry (or just its value) by providing a key,  the library starts searching. The normal method is using a layered stack, sorted by the aforementioned scopes.</p> <p>At top, if enabled, is the cache layer, at RUNTIME scope. Below it follow the other scopes, down to the PRODUCT scope,  where you can find the defaults layer.</p> <p>For each layer, the respective configuration source is asked whether it has an entry matching the key. The topmost layer which has a valid entry wins, and you get the ConfigEntry it has found.</p> <p>If you asked for just the value, not the full ConfigEntry, then the library tries to return the data found in the Java class matching the type of value you asked for (e.g. Boolean, Integer, byte array).</p>"},{"location":"21_how_it_works.html#validation","title":"validation","text":"<p>Note the mention of valid data. You can, and should, provide a ConfigScheme which declares the expected entries, and some information about them.</p> <p>Mandatory for this is a key (~ name), and a type. The types match or are translated to types in the different config sources. The type is also used for initial conversion of the data. So if the type is NUMBER, then \"xyyyzy\" is not a valid value.</p> <p>The default behaviour is to skip such entries, but log a warning - we want to provide usable data to continue your program code with, best-effort. </p> <p>An optional field allows for more specific restrictions to be applied to fields, listing which contents are acceptable values.</p> <p>When a ConfigScheme is activated for a Configuration - it sets the DefaultLayer contents, if defaults are not disabled - it becomes available for the Configuration, to check entries against.  - it also is available for documentation generation</p> <p>The checks are performed @TODO continue</p>"},{"location":"21_how_it_works.html#changes-monitoring","title":"Changes &amp; Monitoring","text":"<p>There's two different aspects to changes.</p> <p>First, getting notifications when the value of a config entry changes. This is actively checking, even polling, for changes, to notify your code about such events. It checks across different ConfigSources, formats, and the like.</p> <p>mConfig provides a subscription mechanism via <code>subscribeToUpdates(Consumer&lt;ConfigLocation&gt;)</code>.  This allows applications (and tools like the <code>mconfig monitor</code> command) to react to configuration changes in real-time.</p> <p>Second, the automated cache flush for some config sources. For most, reading is not much effort; but certain ones - especially files and parsing their formats - are not that cheap. So these are read, parsed, and then cached for some time.</p> <p>But the cache should not stay indefinitely, it needs to detect changes and/or refresh automatically. \u2192 <code>ConfigFeature.UPDATE_CHECK_FREQUENCY_MS</code></p>"},{"location":"21_how_it_works.html#behind-the-scenes","title":"Behind the Scenes","text":"<p>mConfig uses these concepts for separation of concerns:</p> <ul> <li> <p>ConfigSource is something where configurations come from. it returns Configuration instances.</p> </li> <li> <p>ConfigStorage is a concept representing an access medium, e.g. Filesystem, OS registry, network config services. It provides the technical access.</p> </li> <li> <p>ConfigFormat is how the configuration is structured and formatted inside the access medium.   Files, specifically, come in a number of different formats; this handles the actual parsing.</p> </li> <li> <p>ConfigLocation: Represents the specific path/handle (the \"Directory\" part).</p> </li> </ul> <p>This is how it is supposed to be (and as of 0.6.x, isn't yet!) <pre><code>erDiagram\n    Configuration    }|--|| ConfigFactory : \"comes from\"\n    ConfigFactory    ||--|| ConfigSearchList : has\n    Configuration    ||--|| ConfigSearchList : uses\n    ConfigSearchList ||--|{ ConfigSource : contains\n    ConfigSource     ||--|| ConfigLocation : \"has a specific\"\n    ConfigSource     ||--|| ConfigStorage : \"reads from\"\n    ConfigSource     ||--|| ConfigFormat : \"uses a specific\"\n    ConfigStorage    ||--|{ ConfigFormat : \"compatible with\"\n\n    Configuration    ||--o| ConfigScheme : \"may use\"\n    ConfigScheme     ||--o{ ConfigSchemeEntry : contains </code></pre></p> <p>Configuration : the API interface to access configurations; produces/keeps ConfigEntry instances, and provides simple access to the values. They use their respective ConfigFactory search list, which consists of hierarchical and scoped ConfigSource entries, to get ConfigEntry instances.</p> <p>An Configuration object is a way to access configurations in an uniform way.</p> <p>ConfigSource : this is ((supposed to be)) the combined ConfigStorage+ConfigFormat tuple, instantiated, for active use. It can produce Configuration instances, which link back to it.</p> <p>A ConfigSource is where you can get a configurations from.</p> <p>ConfigStorage : Filesystem, Windows registry, Environment, networked system etc. - this provides the (potentially OS-specific) access mechanisms to wherever configurations come from.</p> <p>A ConfigStorage is where configurations are stored.</p> <p>ConfigFormat  : Java-Properties, JSON, YAML, Windows registry, ... - this maps general keys to storage-specific addressing, and - performs format-specific conversions.</p> <p>A ConfigFormat is a format configurations are stored in.</p>   As of 0.6, there is a confusion between ConfigSource and ConfigStorage;  also, the layer separation isn't clean yet.   The ConfigSource would be the instance combination of several tuples;  for example, using the FileConfigStorage, there would be a number of separate  ConfigSource entries in the search list, each for a different directory.  For the WindowsRegistryStorage, there's less of them (HKLM and so on);  for the EnvironmentVariableStorage, there is probably just one.   Whether ConfigSource will have different service-type instances is still open;  the matching of Format and Storage is the tricky bit here.   (( Should we present the available formats to the storages, ask them for compatibility?    Should we do it the other way around? The interface between the two may be very    specific. How to match them, and link them in a general way? ))  Situation as of 0.6 <pre><code>flowchart LR\n    ConfigSearchList --&gt;|contains several| ConfigLocationImpl\n    ConfigLocationImpl --&gt;|adds properties to| ConfigSourceInterface\n    ConfigLocationImpl --&gt; location\n    ConfigLocationImpl --&gt; flags\n    ConfigSourceInterface --&gt; FileConfigSource\n    ConfigSourceInterface --&gt; SchemeDefaultConfigSource</code></pre> <p>Planned for 0.7</p> <pre><code>flowchart LR    \n    ConfigSearchList --&gt; ConfigSource\n    ConfigSource  --&gt; ConfigStorage\n    ConfigStorage -..-&gt; ConfigFormat\n    ConfigStorage &lt;--&gt; ConfigLocation\n    Configuration --&gt; ConfigLocation</code></pre>"},{"location":"21_how_it_works.html#anchor","title":"Anchor","text":"<p>The ConfigFactoryBuilder gathers and combines all the settings. It creates a ConfigFactoryInstanceContext and a ConfigFactory to use it.</p> <p>The ConfigFactoryInstanceContext is passed to several objects the ConfigFactory uses, so they can get their respective features, settings, access to a logger, and so on - it is an internally shared resource.</p>"},{"location":"21_how_it_works.html#security-and-secrets","title":"Security and Secrets","text":"<p>mConfig has built-in support for sensitive data such as passwords, API keys, and private certificates.</p>"},{"location":"21_how_it_works.html#secret-redaction","title":"Secret Redaction","text":"<p>Config entries marked as secrets in the <code>ConfigScheme</code> are automatically handled with care: - Their <code>toString()</code> representation is redacted (<code>[REDACTED]</code>). (using stars could be ambiguous) - They are stored in specialized <code>SecretConfigEntryLeaf</code> objects. - In-memory storage uses <code>byte[]</code> or <code>char[]</code> to allow for clearing the data after use.</p>"},{"location":"21_how_it_works.html#the-secretvalue-api","title":"The SecretValue API","text":"<p>For programmatically accessing secrets, mConfig provides the <code>SecretValue</code> interface.  This allows retrieving the sensitive data without it being accidentally converted to a standard <code>String</code> that might linger in the Java String Pool.</p> <pre><code>SecretValue password = config.getSecret(\"database/password\");\nbyte[] rawBytes = password.getValue();\n// ... use and then potentially clear the bytes\n</code></pre>"},{"location":"21_how_it_works.html#binary-data-blobs","title":"Binary Data (BLOBs)","text":"<p>Not all configuration is text-based. mConfig supports Binary Large Objects (BLOBs) for things like license files, binary keys, or certificates.</p>"},{"location":"21_how_it_works.html#hierarchical-blobs","title":"Hierarchical BLOBs","text":"<p>In modern formats like JSON and YAML, binary data can be embedded directly. - YAML uses the standard <code>!!binary</code> tag. - JSON uses Base64 encoded strings. If a <code>ConfigScheme</code> is provided that marks a key as <code>BYTES</code> type, mConfig will automatically decode the Base64 string into a byte array.</p>"},{"location":"21_how_it_works.html#flat-binary-files","title":"Flat Binary Files","text":"<p>For legacy support or specific use cases, an entire file can be treated as a single binary blob. This uses the <code>binary_file</code> format and is accessed via the empty string key (<code>\"\"</code>).</p> <pre><code>// Retrieving an entire .bin file as a single blob\nConfiguration licenseCfg = factory.getConfig(\"license\");\nbyte[] licenseData = licenseCfg.getBytes(\"\");\n</code></pre>"},{"location":"21_how_it_works.html#failure-handling","title":"Failure Handling","text":"<p>If there is no ConfigEntry found at any layer, and no specific default is found, the reaction is determined by the ConfigFeature flags set.</p> <p>(a) return a generic default value depending on the type (b) throw ConfigException (runtime exception type) (c) return \"null\" as ConfigEntry handle, your own code wants to handle the details. \u2014 this will still cause an exception if you are asking for the value only. </p> <p>It is recommended, though, that you provide for each config entry you are reading a default value which is sensible and useful in the context of your use case. </p>"},{"location":"22_priorities_and_hierarchies.html","title":"2.2 Priorities and Hierarchies","text":""},{"location":"22_priorities_and_hierarchies.html#221-search-list-and-priority","title":"2.2.1 Search List and Priority","text":"<p>The <code>ConfigFactory</code> maintains an ordered Search List of locations. This order is crucial for two reasons:</p> <ol> <li>Finding and Creating Configurations: When looking for a configuration     or creating a new one (e.g., via <code>ConfigUtil.whereToPutMyFiles</code>),     mConfig searches through the list and picks the first matching writeable location.     Thus, entries earlier in the search list have higher priority for discovery and creation.</li> <li>Layered Overrides (Reading): Configurations are composed of multiple layers.     Layers from more specific scopes (e.g., <code>RUNTIME</code>) always override more     generic scopes (e.g., <code>SYSTEM</code>).     Within the same scope, however, the search list determines priority:     layers from locations appearing later in the search list are added later     to the configuration stack and thus override layers from locations     appearing earlier in the same scope.</li> </ol>"},{"location":"23_configuration_schemes.html","title":"2.3 Configuration Schemes","text":"<p>Configuration schemes define the contract for a set of configuration entries.  They specify what keys are expected, their data types, default values, validation rules, and other metadata.</p>"},{"location":"23_configuration_schemes.html#231-overview","title":"2.3.1 Overview","text":"<p>A scheme ensures that the configuration data used by the application is valid and consistent.  When a configuration is loaded (e.g., via <code>getConfig(name)</code>), mConfig attempts to bind it to a matching scheme.</p>"},{"location":"23_configuration_schemes.html#2311-benefits-of-using-schemes","title":"2.3.1.1 Benefits of using Schemes","text":"<ul> <li>Validation: Automatically check if values match expected types and patterns.</li> <li>Defaults: Provide fallback values if none are found in any configuration layer.</li> <li>Documentation: Automatically generate documentation for configuration entries.</li> <li>Type Safety: Preserve data types (e.g., Integer, Boolean) throughout the configuration stack.</li> <li>Security: Identify which entries contain sensitive data (secrets).</li> </ul>"},{"location":"23_configuration_schemes.html#232-example","title":"2.3.2 Example","text":"<p>Minimal example (single scheme entry with a default): <pre><code>[\n{ \"KEY\": \"server/port\", \"TYPE\": \"NUMBER\", \"DEFAULT\": 8080, \"DESCRIPTION\": \"Listening port\" }\n]\n</code></pre></p> <p>Named scheme example (multiple entries): <pre><code>{\n\"my-app-config\": {\n\"NAME\": \"my-app-config\",\n\"ENTRIES\": [\n{ \"KEY\": \"server/host\", \"TYPE\": \"STRING\", \"DEFAULT\": \"127.0.0.1\" },\n{ \"KEY\": \"server/port\", \"TYPE\": \"NUMBER\", \"DEFAULT\": 8080 }\n]\n}\n}\n</code></pre></p>"},{"location":"23_configuration_schemes.html#233-scheme-structure","title":"2.3.3 Scheme Structure","text":"<p>Schemes are typically defined in JSON format. A scheme file can contain a single scheme or multiple named schemes.</p>"},{"location":"23_configuration_schemes.html#2331-scheme-entry-properties","title":"2.3.3.1 Scheme Entry Properties","text":"<p>Each entry in a scheme (within the <code>ENTRIES</code> list) can have the following properties:</p> Property Type Description <code>KEY</code> String The hierarchical path of the entry (e.g., <code>database/host</code>). <code>TYPE</code> String The data type: <code>STRING</code>, <code>NUMBER</code>, <code>BOOLEAN</code>, <code>BYTES</code>, <code>MULTIPLE_STRINGS</code>, <code>ENUM</code>, <code>ENUM_SET</code>, <code>URI</code>, <code>FILEPATH</code>, <code>DATE</code>, <code>TIME</code>, <code>DATETIME</code>. <code>DESCRIPTION</code> String Human-readable description or Resource Bundle key for localized description. (Optional) <code>DEFAULT</code> (any) The default value used if no other value is provided. (Optional) <code>PATTERN</code> String A validation pattern (Regex, range specification, or enum list). (Optional) <code>SECRET</code> Boolean If <code>true</code>, the entry is treated as sensitive data (redacted in logs). (Optional, defaults to <code>false</code>) <code>HIDDEN</code> Boolean If <code>true</code>, the entry is hidden from automatic documentation. (Optional, defaults to <code>false</code>) <code>ARITY</code> String The number of allowed occurrences (e.g., <code>1</code>, <code>0..1</code>, <code>1..*</code>). (Optional; see defaults below) <code>MANDATORY</code> Object (Optional) Block for future-proofing and strict requirements. See below. <code>AFTER</code> String (Optional) For temporal types, value must be after this (ISO format or <code>now</code>). <code>BEFORE</code> String (Optional) For temporal types, value must be before this (ISO format or <code>now</code>). <code>REQUIRE_OFFSET</code> Boolean (Optional) For <code>DATETIME</code>, requires an offset (e.g., <code>+02:00</code> or <code>Z</code>)."},{"location":"23_configuration_schemes.html#2332-arity-arity","title":"2.3.3.2 Arity (<code>ARITY</code>)","text":"<p>The <code>ARITY</code> property defines the constraints on the number of elements for an entry. This is especially useful for <code>MULTIPLE_STRINGS</code> and <code>ENUM_SET</code> types.</p> <ul> <li>Exact number: <code>\"ARITY\": \"3\"</code> (exactly 3 items required).</li> <li>Range: <code>\"ARITY\": \"1..5\"</code> (minimum 1, maximum 5 items).</li> <li>Open-ended: <code>\"ARITY\": \"1..*\"</code> or <code>\"ARITY\": \"1..n\"</code> (at least 1 item, no upper limit).</li> <li>Defaults:<ul> <li>Mandatory entries: <code>1</code></li> <li>Optional entries: <code>0..1</code></li> <li>List types (<code>MULTIPLE_STRINGS</code>, <code>ENUM_SET</code>): <code>0..*</code> (optional) or <code>1..*</code> (mandatory).</li> </ul> </li> </ul>"},{"location":"23_configuration_schemes.html#2333-validation-patterns-pattern","title":"2.3.3.3 Validation Patterns (<code>PATTERN</code>)","text":"<p>Validation patterns depend on the <code>TYPE</code> of the entry:</p> <ul> <li><code>STRING</code>: A Java Regular Expression. Compiled with <code>Pattern.UNICODE_CHARACTER_CLASS</code> by default, supporting Unicode property escapes like <code>\\p{L}</code>.</li> <li><code>NUMBER</code>:<ul> <li>Mathematical Interval Notation: Supports <code>[min, max]</code>, <code>(min, max)</code>, <code>[min, max)</code>, and <code>(min, max]</code>. Example: <code>[1024, 65535]</code>.</li> <li>Predefined Aliases:<ul> <li>Unsigned: <code>uint8</code> (0-255), <code>uint16</code>, <code>uint32</code>, <code>uint64</code>.</li> <li>Signed: <code>int8</code> (-128 to 127), <code>int16</code>, <code>int32</code>, <code>int64</code>, and custom bit-widths like <code>int7</code>, <code>int15</code>, <code>int31</code>, <code>int63</code>.</li> </ul> </li> </ul> </li> <li><code>ENUM</code> / <code>ENUM_SET</code>: A pipe-separated list of valid options. Example: <code>DEBUG|INFO|WARN|ERROR</code>.</li> <li><code>URI</code>: A valid URI string (RFC 3986).</li> <li><code>FILEPATH</code>: A valid path on the filesystem.<ul> <li>Path Validation Flags: Can be placed inside the <code>MANDATORY</code> block for semantic checks:<ul> <li><code>EXISTS</code>: <code>true</code> (path must exist)</li> <li><code>IS_DIRECTORY</code>: <code>true</code> (path must be a directory)</li> <li><code>IS_FILE</code>: <code>true</code> (path must be a regular file)</li> <li><code>CAN_WRITE</code>: <code>true</code> (path must be writable)</li> </ul> </li> </ul> </li> <li><code>DATE</code> / <code>TIME</code> / <code>DATETIME</code>: Temporal types in ISO-8601 format.<ul> <li>Temporal Validation Flags: Can be used directly or inside <code>MANDATORY</code>:<ul> <li><code>AFTER</code>: Value must be chronologically after this (e.g., <code>\"2020-01-01\"</code>, <code>\"now\"</code>).</li> <li><code>BEFORE</code>: Value must be chronologically before this.</li> <li><code>REQUIRE_OFFSET</code>: (For <code>DATETIME</code> only) If <code>true</code>, requires the presence of a time zone offset (e.g., <code>+05:00</code> or <code>Z</code>).</li> </ul> </li> </ul> </li> </ul>"},{"location":"23_configuration_schemes.html#2334-internationalization-i18n","title":"2.3.3.4 Internationalization (I18N)","text":"<p>The <code>DESCRIPTION</code> property can be a plain string or a key in a Resource Bundle. - mConfig looks for Resource Bundles named <code>messages</code> in the same locations as schemes (e.g., <code>.config/messages.properties</code>). - If a matching key is found in the bundle for the current locale (configured via <code>ConfigFeature.PREFERRED_LANGUAGE</code>), the localized string is used. - Otherwise, the raw <code>DESCRIPTION</code> string is used as a fallback.</p>"},{"location":"23_configuration_schemes.html#234-configschemefactory","title":"2.3.4 ConfigSchemeFactory","text":"<p>For 1.0 and better multi-language support (JNI/Rust/Python), use <code>ConfigSchemeFactory</code> to create schemes and entries programmatically:</p> <pre><code>ConfigSchemeFactory factory = ConfigSchemeFactory.create();\nConfigScheme scheme = factory.createScheme();\nConfigSchemeEntry entry = factory.createEntry(\"port\", ConfigEntryType.NUMBER)\n.setValidationPattern(\"uint16\")\n.setDefault(\"8080\");\nscheme.addSchemeEntry(entry);\n</code></pre>"},{"location":"23_configuration_schemes.html#235-future-proofing-with-the-mandatory-block","title":"2.3.5 Future-Proofing with the <code>MANDATORY</code> block","text":"<p>To ensure that future extensions to the scheme format do not break older versions of the library, or conversely, that newer schemes can demand features that older versions must respect, mConfig uses a <code>MANDATORY</code> sub-item.</p> <p>If a scheme entry contains a <code>MANDATORY</code> block, the library MUST understand all keys within that block. If any key inside <code>MANDATORY</code> is unknown to the current version of mConfig, the scheme loading will fail with an <code>UNKNOWN_MANDATORY_FEATURE</code> error.</p> <p>Example: <pre><code>{\n\"KEY\": \"network/timeout\",\n\"TYPE\": \"NUMBER\",\n\"MANDATORY\": {\n\"UNIT\": \"milliseconds\"\n}\n}\n</code></pre> In this example, if a future version of mConfig introduces a <code>UNIT</code> feature and it's placed inside <code>MANDATORY</code>, an older version that doesn't know about <code>UNIT</code> will refuse to load the scheme, preventing potential misconfiguration (e.g., interpreting milliseconds as seconds).</p> <p>Features outside the <code>MANDATORY</code> block that are unknown to the library are silently ignored.</p>"},{"location":"23_configuration_schemes.html#236-formats","title":"2.3.6 Formats","text":"<p>mConfig supports several JSON structures for defining schemes:</p>"},{"location":"23_configuration_schemes.html#2361-named-scheme-object","title":"2.3.6.1 Named Scheme Object","text":"<pre><code>{\n\"my-app-config\": {\n\"NAME\": \"my-app-config\",\n\"ENTRIES\": [\n{ \"KEY\": \"port\", \"TYPE\": \"NUMBER\", \"DEFAULT\": 8080 }\n]\n}\n}\n</code></pre>"},{"location":"23_configuration_schemes.html#2362-list-of-entries-anonymous-scheme","title":"2.3.6.2 List of Entries (Anonymous Scheme)","text":"<p>If a JSON file contains only a list of entries, it is treated as a scheme for the configuration matching the filename (excluding <code>.scheme.json</code>). <pre><code>[\n{ \"KEY\": \"port\", \"TYPE\": \"NUMBER\", \"DEFAULT\": 8080 }\n]\n</code></pre></p>"},{"location":"23_configuration_schemes.html#237-discovery","title":"2.3.7 Discovery","text":"<p>Schemes are automatically discovered from the classpath within <code>.config/</code> directories. - Filenames should follow the pattern <code>name.scheme.json</code>. - Schemes can also be provided manually via <code>ConfigFactoryBuilder.setSchemes()</code>. - Discovered schemes are registered in the <code>ConfigSchemeRepository</code>.</p>"},{"location":"23_configuration_schemes.html#developer-notes","title":"Developer Notes","text":"<p>For internals/parsing/validation details, see project <code>devdocs/config_schemes_internals.md</code> (not included in public docs).</p>"},{"location":"24_comment_handling.html","title":"2.4 Comment Handling in mConfig","text":"<p>Of the possible configuration sources, files are the ones that support comments.  Comments in configuration files are an important source of information for users. They can be used to explain configuration options, document decisions, provide context, or include relevant links.</p> <p>mConfig aims to keep comments intact in configuration files to ensure that human-readable information is not lost during programmatic updates.</p>"},{"location":"24_comment_handling.html#core-principles","title":"Core Principles","text":"<ul> <li>Write-Preservation: Writing to a configuration file should not erase existing comments.</li> <li>Read-Write Symmetry: Maintaining the original structure and documentation of the file is a priority.</li> <li>Human-Centric: Comments are for humans. They should not be used for machine processing or \"shebang\" style logic.</li> </ul>"},{"location":"24_comment_handling.html#programmatic-comments","title":"Programmatic Comments","text":"<p>While mConfig prioritizes preserving existing comments, it also supports adding comments programmatically:</p> <ol> <li>Description from Scheme: When an entry is first created, mConfig can automatically include the description defined in the <code>ConfigScheme</code> as a comment. This is controlled by the <code>ConfigFeature.DESCRIPTION_ON_CREATE</code> feature.</li> <li>Explicit Comments: Developers can add comments to a <code>ConfigEntry</code> using the <code>setComment(String)</code> method. This is useful for documenting automated changes (e.g., \"# AUTO-REDUCED: Disk space was below 5%\").</li> </ol>"},{"location":"24_comment_handling.html#configuration-features","title":"Configuration Features","text":"<p>The behavior of comment handling is governed by several <code>ConfigFeature</code> flags:</p> <ul> <li><code>ConfigFeature.COMMENTS_WRITING</code> (default: <code>false</code>): When set to <code>true</code>, mConfig will write programmatic comments to the configuration. Even when <code>false</code>, the library still attempts to preserve existing comments for supported formats.</li> <li><code>ConfigFeature.COMMENTS_READING</code> (default: <code>false</code>): Enables reading comments from files into the <code>ConfigEntry</code> objects. Note that determining exactly which lines belong to which key is heuristic-based and may not be perfect for all formats.</li> <li><code>ConfigFeature.DESCRIPTION_ON_CREATE</code> (default: <code>false</code>): When <code>true</code>, uses the <code>description</code> field from the <code>ConfigSchemeEntry</code> to populate comments for new entries.</li> </ul>"},{"location":"24_comment_handling.html#format-support-matrix","title":"Format Support Matrix","text":"<p>Preservation of comments depends on the underlying format module. Some high-level libraries (like Jackson) may strip comments by design.</p> File Format mConfig Module Preserve Comments <code>.properties</code> <code>mConfigFormatJavaProperties</code> Yes <code>INI</code> <code>mConfigFormatINI</code> Yes <code>TOML</code> <code>mConfigFormatTOML</code> Yes <code>YAML</code> <code>mConfigFormatYAMLwithSnakeYAML</code> Partially <code>TOML</code> <code>mConfigFormatTOMLwithJackson</code> No <code>YAML</code> <code>mConfigFormatYAMLwithJackson</code> No <code>JSON</code> <code>mConfigFormatJSONwithJackson</code> No <code>JSON5</code> <code>mConfigFormatJSONwithJackson</code> No"},{"location":"24_comment_handling.html#implementation-details","title":"Implementation Details","text":""},{"location":"24_comment_handling.html#multi-line-comments","title":"Multi-line Comments","text":"<ul> <li>Representation: Represented as a single <code>String</code> with <code>\\n</code> line separators.</li> <li>Markers: On reading, format-specific markers (e.g., <code>#</code>, <code>!</code>, <code>;</code>) are preserved.</li> <li>Writing: mConfig ensures each line is correctly prefixed with the format's primary marker if it's missing.</li> </ul>"},{"location":"24_comment_handling.html#heuristics-and-association","title":"Heuristics and Association","text":"<ul> <li>Leading Comments: Consecutive comment lines immediately preceding a key are associated with that key.</li> <li>Global Headers: Comment blocks at the top of a file (or between entries) separated by empty lines are treated as \"Global Headers\". They are preserved and rewritten at the top of the file but are not attached to any specific <code>ConfigEntry</code>.</li> <li>Inline Comments: Comments on the same line as a value are appended to the entry's comment string on a best-effort basis.</li> </ul>"},{"location":"24_comment_handling.html#priority-and-merging","title":"Priority and Merging","text":"<p>When writing an entry, comments are merged based on the following priority (top to bottom): 1.  Description from Scheme: If <code>DESCRIPTION_ON_CREATE=true</code> and the entry is new. 2.  Existing Comments: Preserved from the original file. 3.  Programmatic Comments: Added via <code>ConfigEntry.setComment()</code>.</p> <p>Duplicate lines are automatically filtered during the merge process.</p>"},{"location":"25_config_features.html","title":"2.5 Config Features","text":"<p>ConfigFeature flags tune how a ConfigFactory is built and how it behaves. Set them on the ConfigFactoryBuilder before calling <code>build()</code>.</p> <p>Example: <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.ALLOW_MCONFIG_RUNTIME_SETTINGS, true)\n.setFeature(ConfigFeature.DEFAULT_ON_MISSING_ENTRY, true)\n.setFeature(ConfigFeature.ADDITIONAL_USER_DIRECTORIES, List.of(\"/opt/acme/overrides\"));\n</code></pre></p> <p>Notes: - Booleans default to <code>false</code> unless a default is explicitly listed below. - Some features are only used when the corresponding module is on the classpath   (e.g., ZooKeeper, Registry, Secrets, JAR). - Runtime environment variables can override a subset of settings if   <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> is enabled. See \"Runtime overrides\" below.</p>"},{"location":"25_config_features.html#runtime-overrides","title":"Runtime overrides","text":"<p>If <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> is set to <code>true</code>, mConfig accepts runtime settings via environment variables with the prefix <code>MCONFIG_RUNTIME_</code>:</p> <ul> <li><code>MCONFIG_RUNTIME_DEBUG_LEVEL</code> -&gt; <code>LOGLEVEL_NUMBER</code> (accepts numbers or: <code>off</code>, <code>error</code>, <code>warn</code>, <code>info</code>, <code>debug</code>, <code>trace</code>)</li> <li><code>MCONFIG_RUNTIME_DEBUG_OUTPUT</code> -&gt; <code>LOGGING_REDIRECT_TARGET</code></li> <li><code>MCONFIG_RUNTIME_DISABLE_MODULES</code> -&gt; <code>DISABLED_MODULE_IDS</code> (comma-separated)</li> <li><code>MCONFIG_RUNTIME_MODULES</code> -&gt; <code>ADDITIONAL_MODULE_PATHS</code> (comma-separated)</li> <li><code>MCONFIG_RUNTIME_TEST_MODE</code> -&gt; <code>TEST_MODE</code></li> </ul>"},{"location":"25_config_features.html#feature-reference","title":"Feature reference","text":""},{"location":"25_config_features.html#test-mode","title":"Test mode","text":"<ul> <li><code>PERMIT_TEST_MODE</code> (Boolean, default: true): Master gate for test mode usage.</li> <li><code>TEST_MODE</code> (Boolean, default: false): Activate test-mode search locations.</li> <li><code>TESTMODE_DIRECTORIES</code> (<code>List&lt;String&gt;</code>, default: empty): Scoped paths in <code>SCOPE:PATH</code> format.</li> <li><code>TESTMODE_PARAMETERS</code> (<code>Map&lt;String,String&gt;</code>): Additional test parameters.</li> </ul>"},{"location":"25_config_features.html#logging","title":"Logging","text":"<ul> <li><code>QUIET</code> (Boolean, default: false): Reduce internal mConfig logging.</li> <li><code>LOGGING_TO_USE_IN_CONFIGLIB</code> (String, default: \"\"): Force a specific logging module.</li> <li><code>LOGLEVEL_NUMBER</code> (Integer, default: 4): Numeric log level for basic loggers.</li> <li><code>LOGGING_REDIRECT_TARGET</code> (String): Redirect internal logging (<code>stderr</code>, <code>stdout</code>, <code>quiet</code>, <code>file:&lt;path&gt;</code>).</li> </ul>"},{"location":"25_config_features.html#filesystem-and-registry-paths","title":"Filesystem and registry paths","text":"<ul> <li><code>ADDITIONAL_RUNTIME_DIRECTORIES</code> (<code>List&lt;String&gt;</code>): Extra filesystem directories (prepended) for <code>RUNTIME</code> scope.</li> <li><code>ADDITIONAL_USER_DIRECTORIES</code> (<code>List&lt;String&gt;</code>): Extra filesystem directories (prepended) for <code>USER</code> scope.</li> <li><code>REGISTRY_BASE_PATH</code> (<code>String</code>): Registry root path (default <code>Software/[&lt;company&gt;/]&lt;application&gt;</code>; omits company if blank).</li> <li><code>FILENAME_EXTENSION_MAPPINGS</code> (<code>List&lt;String&gt;</code>): Extra filename extensions to try when reading config files.</li> <li><code>DEFAULT_TEXTFILE_CHARSET</code> (<code>String</code>, default: <code>UTF-8</code>): Charset for text formats.</li> <li><code>TRIM_TEXTVALUE_SPACES</code> (Boolean, default: true): Trim leading/trailing spaces in text values.</li> <li><code>WRITE_CONDENSED_FORMAT</code> (Boolean, default: false): Prefer compact output when writing text formats.</li> </ul>"},{"location":"25_config_features.html#format-priorities","title":"Format priorities","text":"<ul> <li><code>FILE_FORMAT_READING_PRIORITIES</code> (<code>List&lt;String&gt;</code>, default: <code>DHALL,TOML,YAML,JSON5,JSON,ASN1,properties,INI</code>): Read order.</li> <li><code>FILE_FORMAT_WRITING_PRIORITIES</code> (<code>List&lt;String&gt;</code>, default: <code>TOML,YAML,JSON5,JSON,properties</code>): Write order.</li> <li><code>FILE_FORMAT_READING_ALLOW_ALL_FORMATS</code> (Boolean, default: true): Fallback to non-listed formats.</li> <li><code>FILE_FORMAT_WRITING_ALLOW_ALL_FORMATS</code> (Boolean, default: true): Fallback to non-listed formats.</li> </ul>"},{"location":"25_config_features.html#storage-type-priorities","title":"Storage type priorities","text":"<ul> <li><code>STORAGE_TYPE_PRIORITIES</code> (<code>List&lt;String&gt;</code>, default: <code>RAM,secrets,files,registry,registryjni,zookeeper,JAR</code>): Init/search order within a scope.</li> <li><code>STORAGE_TYPE_ALLOW_ALL_STORAGES</code> (Boolean, default: true): Allow storages not explicitly listed.</li> </ul>"},{"location":"25_config_features.html#schemes-and-defaults","title":"Schemes and defaults","text":"<ul> <li><code>CONFIG_SCHEME_LIST</code> (<code>Map&lt;String,ConfigScheme&gt;</code>): Provide schemes programmatically.</li> <li><code>SCHEME_STRICT_MODE</code> (Boolean, default: false): Reject keys not in the scheme.</li> <li><code>SCHEME_RESETS_DEFAULTS</code> (Boolean, default: false): Replace existing defaults instead of merging.</li> <li><code>FREE_CONFIGURATION</code> (Boolean): Allow configs without a scheme (behavior may evolve).</li> </ul>"},{"location":"25_config_features.html#missing-entry-behavior","title":"Missing entry behavior","text":"<ul> <li><code>EXCEPTION_ON_MISSING_ENTRY</code> (Boolean, default: true): Throw when a key is absent.</li> <li><code>DEFAULT_ON_MISSING_ENTRY</code> (Boolean, default: false): Return scheme defaults if missing (requires exceptions disabled).</li> <li><code>EXCEPTION_WHEN_CONFIGURATION_NOT_FOUND</code> (Boolean, default: false): Throw if a configuration name is not found at all.</li> <li><code>FALLBACKS_ACROSS_SCOPES</code> (Boolean, default: true): Allow fallback to less specific scopes on reads.</li> <li><code>WRITE_FALLBACK_ACROSS_SCOPES</code> (Boolean, default: false): Allow fallback to more specific scopes on writes.</li> </ul>"},{"location":"25_config_features.html#cache-and-update-checks","title":"Cache and update checks","text":"<ul> <li><code>UPDATE_CHECK_FREQUENCY_MS</code> (Integer, default: 2000): Polling interval for cached sources.</li> <li><code>UPDATE_CHECK_SCOPES</code> (<code>List&lt;String&gt;</code>, default: all scopes): Limit update checks by scope.</li> <li><code>CACHE_CONFIGS</code> (Boolean): Cache configurations in memory (experimental).</li> <li><code>AUTOMATIC_CONFIG_LOADING</code> (Boolean): Auto-load configs before first read (experimental).</li> <li><code>AUTOMATIC_CONFIG_CREATION</code> (Boolean): Auto-create configs on write (experimental).</li> <li><code>WRITE_SYNC</code> (Boolean): Sync writes immediately (storage-dependent).</li> <li><code>NO_DEFAULT_DIRECTORIES</code> (Boolean): Disable default filesystem paths (experimental).</li> </ul>"},{"location":"25_config_features.html#modules-and-runtime-configuration","title":"Modules and runtime configuration","text":"<ul> <li><code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> (Boolean, default: false): Allow <code>MCONFIG_RUNTIME_*</code> env overrides.</li> <li><code>ENABLE_SELF_CONFIGURATION</code> (Boolean, default: true): Allow classpath self-configuration.</li> <li><code>ADDITIONAL_MODULE_PATHS</code> (<code>List&lt;String&gt;</code>): Add module IDs/paths during discovery.</li> <li><code>DISABLED_MODULE_IDS</code> (<code>List&lt;String&gt;</code>): Disable specific module IDs.</li> </ul>"},{"location":"25_config_features.html#secrets-providers-mconfigsecrets","title":"Secrets providers (mConfigSecrets)","text":"<ul> <li><code>SECRETS_PROVIDER_ID</code> (String): Primary provider ID.</li> <li><code>SECRETS_PROVIDER_CONFIG</code> (<code>Map&lt;String,Object&gt;</code>): Provider configuration.</li> <li><code>ADDITIONAL_SECRETS_PROVIDERS</code> (<code>List&lt;Map&lt;String,Object&gt;&gt;</code>): Additional providers with optional scope.</li> </ul>"},{"location":"25_config_features.html#zookeeper-mconfigsourcezookeeper","title":"ZooKeeper (mConfigSourceZooKeeper)","text":"<ul> <li><code>ZOOKEEPER_CONNECT_STRING</code> (String): Connection string.</li> <li><code>ZOOKEEPER_ROOT_PATH</code> (String, default: <code>/mconfig</code>): Root path.</li> <li><code>ZOOKEEPER_SESSION_TIMEOUT_MS</code> (Integer, default: 60000): Session timeout.</li> <li><code>ZOOKEEPER_RETRY_BASE_SLEEP_MS</code> (Integer, default: 1000): Retry base sleep.</li> <li><code>ZOOKEEPER_RETRY_MAX_RETRIES</code> (Integer, default: 3): Retry count.</li> <li><code>ZOOKEEPER_BOOTSTRAP_CONFIG_NAME</code> (String, default: <code>zookeeper</code>): Bootstrap config name.</li> </ul>"},{"location":"25_config_features.html#class-loading","title":"Class loading","text":"<ul> <li><code>USE_CONTEXT_CLASS_LOADER</code> (Boolean, default: false): Prefer thread context loader.</li> <li><code>USE_SYSTEM_CLASS_LOADER</code> (Boolean, default: false): Prefer system class loader.</li> <li></li> </ul>"},{"location":"25_config_features.html#identity-and-context","title":"Identity and context","text":"<ul> <li><code>COMPANY_NAME</code> (String, optional): Company/organization name used in OS paths. Blank/null/whitespace intentionally omits the company segment across all sources.</li> <li><code>APPLICATION_NAME</code> (String, required): Application name used in OS paths.</li> <li><code>SUB_PATH</code> (String, optional): Sub-path appended to application paths (e.g. <code>\"profile/tenantA\"</code>).</li> <li><code>CURRENT_USER_ID</code> (String, default: OS user): User ID for the current process.</li> <li><code>CURRENT_PLATFORM_OS</code> (OperatingSystem, auto-detected): Detected OS family.</li> <li><code>HOSTNAME</code> (String, auto-detected): Hostname of the current machine/container.   These are automatically set by the library; they are available as a ConfigFeature so you can override them if needed.</li> </ul>"},{"location":"25_config_features.html#patterns-to-avoid-boilerplate","title":"Patterns to avoid boilerplate","text":"<ul> <li>Missing values: prefer <code>EXCEPTION_ON_MISSING_ENTRY=false</code> and <code>DEFAULT_ON_MISSING_ENTRY=true</code> over manual <code>try/catch</code> or <code>null</code> wrapping.</li> <li>Strict config contracts: set <code>SCHEME_STRICT_MODE=true</code> instead of filtering keys by hand.</li> <li>Default overrides: use <code>SCHEME_RESETS_DEFAULTS</code> or <code>STORAGE_TYPE_PRIORITIES</code> rather than manual \"merge\" code.</li> <li>Scope behavior: use <code>FALLBACKS_ACROSS_SCOPES</code> and <code>WRITE_FALLBACK_ACROSS_SCOPES</code> instead of explicit scope iteration.</li> </ul>"},{"location":"31_writing_configurations.html","title":"3.1 Writing Configurations","text":"<p>Most of the time, we just read configs from software. After all, they are how software gets told where to find things and how to behave.</p> <p>But if you want to make things more comfortable, you'd also want to write  configs. </p> <p>One main difference from reading is that it is less automatic; it can't be. When writing a config, you must specify the Scope. Otherwise, we'd have the writes all over the place, users overwriting each other's settings, and so on.</p> <p>So, you specify which Scope you are about to write.</p>"},{"location":"31_writing_configurations.html#311-writing-priorities","title":"3.1.1 Writing Priorities","text":"<p>mConfig follows the \"principle of least surprise\" when writing to a scope: 1. Priority 1: If an entry for the key already exists in a writeable layer within the scope, that entry is updated. 2. Priority 2: If the key is new, it is added to the highest-priority writeable layer already available in the scope. 3. Priority 3: Only if no writeable layers exist is a new configuration file/storage created.</p> <p>What's half-automatic is the format and location. We can use the hierarchy used for reading in writing as well, and we have a default format preference list.</p> <p>But for your specific project, conventions may be different.</p>"},{"location":"31_writing_configurations.html#312-format-caveats-when-writing","title":"3.1.2 Format caveats when writing","text":"<p>Some formats allow extraneous information to be added manually, which is invisible from code.</p> <p>e.g. Java Properties allow comments, but its .load() function omits all of them. So if you do a load() followed by a store(), the comments will be gone in the stored version.</p> <p>You may want to think about this aspect when designing your application. mConfig helps you in this regard with layers and Scopes. </p>"},{"location":"31_writing_configurations.html#313-type-preservation-planned","title":"3.1.3 Type Preservation (Planned)","text":"<p>Current: String-first impl (<code>String.valueOf(value)</code>) for simplicity.</p> <p>Planned: Pass typed objects to formats (e.g., unquoted numbers/booleans in JSON/YAML). See <code>devdocs/type_preservation_plan.md</code>.</p>"},{"location":"31_writing_configurations.html#314-write-cache-planned","title":"3.1.4 Write Cache (Planned)","text":"<p>For batch writes, enable cache via future <code>ENABLE_CONFIG_CACHE</code> feature, then <code>flush()</code> to persist.</p> <p><code>flush()</code> will write cache and invalidate read cache.</p>"},{"location":"32_updates.html","title":"3.2 Updates","text":"<p>mConfig automatically detects and uses updates in the configuration sources.</p> <p>Thus, if you access Configuration contents, you'll receive the current values.</p> <p>Conversely, if you store the values you got from the mConfig Configuration in a local variable, that variable won't receive updates, of course.</p> <p>Now for the details.</p>"},{"location":"32_updates.html#321-update-notifications","title":"3.2.1 Update notifications","text":"<p>While the easiest way to use mConfig is just to <code>get()</code> from the Configuration whenever you need a value - there are library objects created using the values values, where you can't pass an mConfig handle. You would need to reinstantiate these, or do similar things.</p> <p>For this purpose, you can subscribe to changes, providing a callback which will get executed when a change occurs.</p>"},{"location":"32_updates.html#3211-location-level-updates","title":"3.2.1.1 Location-level updates","text":"<pre><code>Configuration.subscribeToUpdates(Consumer&lt;ConfigLocation&gt; listener)\nConfiguration.unsubscribeFromUpdates(Consumer&lt;ConfigLocation&gt; listener)\n</code></pre> <p>The callback will be executed when any of the Configuration layers in the specified scopes gets changed content.</p> <p>Note on initial discovery: For subscribers, the transition from a non-existent entry to its first assigned value is treated as a change event.  This ensures that dynamic entry creation is captured correctly.</p> <p>By default, the scopes exclude RUNTIME, because that's what you set yourself at runtime.</p> <p>The callback is provided as parameter with the <code>ConfigLocation</code> where the change occurred. (You can get the scope from it, e.g.)</p>"},{"location":"32_updates.html#3212-entry-level-updates","title":"3.2.1.2 Entry-level updates","text":"<p><pre><code>Configuration.subscribeToUpdates(String fullKey, Consumer&lt;ConfigLocation&gt; listener)\n</code></pre> Subscribe to changes of individual entries by their full key. </p> <p>The callback is called with the <code>ConfigLocation</code> where the entry change was detected.</p> <p>Unsubscribe with <code>Configuration.unsubscribeFromUpdates(Consumer&lt;ConfigLocation&gt; listener)</code> when you don't need it anymore; this feature requires a bit of CPU time when active.</p>"},{"location":"32_updates.html#322-update-settings","title":"3.2.2 Update settings","text":"<p>To reduce overhead, mConfig limits the checks for new content to every x seconds. You can set this with the parameter XXXXXXXXXXXXTOBENAMED.</p> <p>NOT IMPLEMENTED YET: If you set this parameter to 0, mConfig is instructed to perform checks on all its potential sources on each variable access. If you really need this amount of overhead... please give notice, explain the use case, and we'll get it done.</p>"},{"location":"33_getting_information.html","title":"3.3 Getting Information","text":""},{"location":"33_getting_information.html#331-locations","title":"3.3.1 Locations","text":"<p>So, where is my specific configuration looking for its contents?</p> <p>To see where a Configuration instance gets its contents from, you can use <code>getSourceLocations()</code> like this: <pre><code> System.out.println(\"config locations: \");\nfor (ConfigLocation location : cfg.getSourceLocations())\nSystem.out.println(\"\\t\" + location.getScope() + \"\\t\" + location.getURI(\"entry\", null));\n</code></pre></p> <p>And where is the overall mConfig factory instance looking, in general? There is <code>getSearchList()</code> from ConfigFactory. <pre><code> System.out.println(\"searchList: \");\nfor (ConfigLocation location : searchList)\nSystem.out.println(\"\\t\" + location.getScope() + \"\\t\" + location.getURI(\"entry\", null));\n</code></pre></p> <p>Depending on your use case, you'll want different parts of the ConfigLocation entries. Above is just a little text dump.</p>"},{"location":"33_getting_information.html#332-legacy-support-blobs-and-where-to-put-files","title":"3.3.2 Legacy support: BLOBs, and where to put files?","text":"<p>Use Configuration mechanisms where possible; this enables all the features, including scheme checking, network storage, and so on.</p>"},{"location":"33_getting_information.html#3321-raw-files-text-and-binary","title":"3.3.2.1 Raw Files (Text and Binary)","text":"<p>You may need to access the entire content of a file as a single String or byte array. mConfig provides two specialized formats for this purpose: <code>text_file</code> and <code>binary_file</code>.</p> <p>Reading a text file as a single String: By using the <code>text_file</code> format, the entire file content is read into a single entry with an empty key <code>\"\"</code>.</p> <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"myCompany\", \"myApplication\")\n.setFeature(ConfigFeature.FILE_FORMAT_READING_PRIORITIES, List.of(\"text_file\"))\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"myTextFile\");\nString content = cfg.getString(\"\");\n}\n</code></pre> <p>Reading a binary file as a byte array: The <code>binary_file</code> format works similarly but provides the content as a byte array.</p> <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"myCompany\", \"myApplication\")\n.setFeature(ConfigFeature.FILE_FORMAT_READING_PRIORITIES, List.of(\"binary_file\"))\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"myBinaryFile\");\nbyte[] content = cfg.getBytes(\"\");\n}\n</code></pre>"},{"location":"33_getting_information.html#3322-hierarchical-blobs","title":"3.3.2.2 Hierarchical BLOBs","text":"<p>In modern formats like JSON and YAML, binary data can be part of the hierarchical structure.</p> <p>JSON (Base64): If a <code>ConfigScheme</code> defines a key as type <code>BYTES</code>, mConfig will automatically decode a Base64-encoded string in a JSON file.</p> <p>YAML (!!binary): YAML supports binary data natively using the <code>!!binary</code> tag. mConfig will correctly retrieve these as byte arrays.</p> <pre><code>byte[] data = cfg.getBytes(\"server/certificate\");\n</code></pre>"},{"location":"33_getting_information.html#3323-legacy-blobs","title":"3.3.2.3 Legacy BLOBs","text":"<p>The second fallback for supporting legacy applications is that you can get filesystem paths for a given Scope. If there are several for the same Scope, mConfigUtil will prioritize the most specific entry, and prefer those which exist already over those which would need to be created.</p> <pre><code>Path localPath = ConfigUtil.whereToPutMyFiles(configFactory, ConfigScope.USER, false);\n</code></pre> <p>But please, consider using regular mConfig functionality instead where possible.</p>"},{"location":"34_definitions_and_valid_values.html","title":"3.4 Definitions and valid values","text":""},{"location":"34_definitions_and_valid_values.html#341-configuration-names","title":"3.4.1 Configuration names","text":"<p>Configuration names identify which configuration to access. This needs to be portable across different storage backends and platforms (files, environment variables, JAR resources, etc.).</p> <p>These rules aim to minimize surprises and increase security.</p> <ol> <li><code>null</code> is not allowed and will result in an error.</li> <li>The empty string \"\" is technically allowed, but reserved for internal aggregation use cases. Avoid using \"\" in normal application code.</li> <li> <p>Whitespace handling</p> <ul> <li>Leading and trailing whitespace are actively omitted.</li> <li>Multiple internal whitespace characters collapse to a single space.</li> <li>on some backends, whitespace is replaced by underscores.</li> </ul> </li> <li> <p>Allowed characters (portable set)</p> <ul> <li>Letters A\u2013Z, a\u2013z</li> <li>Digits 0\u20139</li> <li>Dot .</li> <li>Underscore _</li> <li>Hyphen -</li> <li>Space</li> <li>In regex form: [A-Za-z0-9._- ] (spaces are allowed)</li> </ul> </li> </ol> <p>Some sources (e.g. Filesystem) may sanitize dot usage to guard against path traversal attacks.</p> <ol> <li> <p>Configuration names are case sensitive.</p> </li> <li> <p>Examples</p> <ul> <li>Valid: \"testconfig\", \"my.config\", \"my_config\", \"my-config\", \"My Config\", \"prod.v2\"</li> <li>invalid: \"my/config\", \"my:config\", \"my*config\", \"conf|g\", \"config&lt;&gt;\", \"config\\tname\"</li> </ul> </li> </ol>"},{"location":"35_handling_secrets.html","title":"3.5 Handling Secrets","text":"<p>mConfig provides a secure way to handle sensitive information like passwords and keys.</p>"},{"location":"35_handling_secrets.html#351-retrieving-secrets","title":"3.5.1 Retrieving Secrets","text":"<p>The <code>getSecret(key)</code> method returns a <code>SecretValue</code> object, which provides safe access to the sensitive data.</p> <pre><code>SecretValue dbPassword = cfg.getSecret(\"database/password\");\nif (dbPassword != null)\n{\nchar[] passwordChars = dbPassword.getChars();\n// Use passwordChars ...\n// Note: SecretValue.erase() can be used to clear internal buffers\ndbPassword.erase();\n}\n</code></pre>"},{"location":"35_handling_secrets.html#352-scheme-integration","title":"3.5.2 Scheme Integration","text":"<p>To ensure an entry is treated as a secret, you must mark it with the <code>SECRET</code> flag in your <code>ConfigScheme</code>.</p> <pre><code>{\n\"database/password\": {\n\"type\": \"STRING\",\n\"flags\": [\"SECRET\"],\n\"description\": \"Database connection password\"\n}\n}\n</code></pre> <p>When an entry is marked as a secret: - It is automatically redacted in logs and <code>toString()</code> calls. - It is stored in a specialized <code>SecretConfigEntryLeaf</code> that avoids converting the value to a standard <code>String</code> where possible.</p>"},{"location":"35_handling_secrets.html#353-binary-secrets-and-crypto-libraries","title":"3.5.3 Binary Secrets and Crypto Libraries","text":"<p>mConfig seamlessly integrates with JCE and other crypto libraries. You can store raw key bytes as <code>BYTES</code> entries and retrieve them as <code>SecretValue</code>.</p> <pre><code>// Retrieving a private key\nSecretValue privKeySecret = cfg.getSecret(\"server/privateKey\");\nbyte[] keyBytes = privKeySecret.getValue();\n\n// Reconstruct the key using JCE\nKeyFactory kf = KeyFactory.getInstance(\"RSA\");\nPrivateKey privKey = kf.generatePrivate(new PKCS8EncodedKeySpec(keyBytes));\n</code></pre>"},{"location":"36_windows_registry.html","title":"3.6 Windows Registry Access","text":"<p>mConfig provides two alternative modules for accessing the Windows Registry.  Both support reading configuration data from <code>HKEY_CURRENT_USER</code> (USER scope), <code>HKEY_LOCAL_MACHINE</code> (MACHINE scope), and Group Policy Objects (GPO) in both hives (POLICY scope).</p>"},{"location":"36_windows_registry.html#361-choosing-the-right-module","title":"3.6.1 Choosing the Right Module","text":"Feature <code>mConfigWinRegistry</code> <code>mConfigWinRegistryJNI</code> Technology JNR-FFI (Dynamic Native) JNI (Java Native Interface) Artifact Size ~13 KB ~47 KB (includes DLL) Runtime Size ~1.5 MB (includes dependencies) ~47 KB Dependencies JNR-FFI, ASM, JFFI None Complexity Zero (no DLL to manage) Medium (DLL handling) Build Req. Standard Java/Maven Linux + MinGW-w64 (for DLL) Performance High Very High"},{"location":"36_windows_registry.html#mconfigwinregistry-jnr-ffi-based","title":"<code>mConfigWinRegistry</code> (JNR-FFI based)","text":"<p>This module is the easiest to use as it requires no native toolchain and handles native access dynamically.  - Pros: No native binaries to manage; works out-of-the-box. - Cons: Significantly larger footprint (~1.5 MB) due to the JNR-FFI ecosystem. - Requirement: Java 11+.</p>"},{"location":"36_windows_registry.html#mconfigwinregistryjni-jni-based","title":"<code>mConfigWinRegistryJNI</code> (JNI based)","text":"<p>This module provides the smallest footprint and highest performance by using a custom-built DLL. - Pros: Extremely lightweight; no external dependencies. - Cons: Requires building a DLL on Linux (cross-compiled for Windows); the DLL must be provided to the end-user (usually bundled in the JAR). - Requirement: Windows DLL (<code>mConfigWinRegistryJNI.dll</code>). - Signing: The bundled DLL is provided unsigned. For production deployments, application developers are responsible for signing the DLL as part of their distribution to establish a \"Chain of Trust\".</p>"},{"location":"36_windows_registry.html#362-priority-and-discovery","title":"3.6.2 Priority and Discovery","text":"<p>If both modules are present on the classpath, mConfig defaults to using <code>mConfigWinRegistryJNI</code> (<code>registryjni</code>) over <code>mConfigWinRegistry</code> (<code>registry</code>) for better performance.</p> <p>To use a specific one, you can configure <code>STORAGE_TYPE_PRIORITIES</code>: <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"company\", \"app\")\n.setFeature(ConfigFeature.STORAGE_TYPE_PRIORITIES, List.of(\"registryjni\")) // Force JNI\n.build())\n{\n// ...\n}\n</code></pre></p>"},{"location":"36_windows_registry.html#363-base-path-configuration","title":"3.6.3 Base Path Configuration","text":"<p>By default, the registry source looks under <code>Software\\\\[&lt;CompanyName&gt;\\\\\\\\]&lt;ApplicationName&gt;</code> (company segment omitted if <code>COMPANY_NAME</code> blank/null/whitespace). You can override this using the <code>REGISTRY_BASE_PATH</code> feature:</p> <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"company\", \"app\")\n.setFeature(ConfigFeature.REGISTRY_BASE_PATH, \"Software\\\\LegacyPath\\\\App\")\n.build())\n{\n// ...\n}\n</code></pre>"},{"location":"37_extensions_and_advanced_use.html","title":"3.7 Extensions and Advanced Use","text":""},{"location":"37_extensions_and_advanced_use.html#371-using-extensions","title":"3.7.1 Using extensions","text":""},{"location":"37_extensions_and_advanced_use.html#372-advanced-use","title":"3.7.2 Advanced use","text":"<p>Why perform</p> <ul> <li>parameter validation, </li> <li>checks for presence of mandatory settings,</li> <li>generation of parameter documentation yourself? mConfig has a built-in facility for this and more. </li> </ul> <p>You describe all the entries your configuration can have, and mConfig takes care of the checking. </p>"},{"location":"37_extensions_and_advanced_use.html#373-data-types","title":"3.7.3 Data types","text":""},{"location":"37_extensions_and_advanced_use.html#3731-config-scheme-formats","title":"3.7.3.1 Config scheme formats","text":""},{"location":"37_extensions_and_advanced_use.html#37311-internal-format-0-single-configschemeentry","title":"3.7.3.1.1 Internal format 0: single ConfigSchemeEntry","text":"<pre><code>{\n\"key\":\"mandatory key / configuration entry name\",\n\"TYPE\":\"mandatory type\",\n\"DEFAULT\":\"optional default value, as string\",\n\"DESCRIPTION\":\"optional description, for the documentation\",\n\"DESCRIPTION\":{\"en\":\"English description\", \"de\":\"Deutsche Beschreibung\"},\n\"PATTERN\":\"optional validation pattern\",\n\"SCOPES\":[ \"optional\", \"scopes\", \"this\", \"is\", \"valid\", \"in\"],\n\"FLAGS\":[\"flags\"],\n\"SECRET\":false,\n\"HIDDEN\":false\n}\n</code></pre> <p>Multi-language descriptions are supported by providing a map of language codes to description texts. When requested via <code>getDescription(Locale)</code>, the library will first check this map, then fall back to standard <code>ResourceBundle</code> lookup (using <code>.config/messages.properties</code>), and finally fall back to the single string description if provided.</p> <p>PLAN: For FLAGS, in the future we may chose an alternative form - each being a pair with string key and boolean value.</p>"},{"location":"37_extensions_and_advanced_use.html#37312-internal-format-1-configschemes-in-an-array-internal-use-only","title":"3.7.3.1.2 Internal format 1:  ConfigSchemes, in an array. internal use only!","text":"<pre><code>[ \nSCHEME_ENTRIES,\nGO_HERE,\nDEFINED_AS_IN_FORMAT_1\n]\n</code></pre>"},{"location":"37_extensions_and_advanced_use.html#37313-format-2-full-single-configscheme","title":"3.7.3.1.3 Format 2: full single ConfigScheme","text":"<pre><code>{\n \"name\":\"mandatory name the Configuration is identified by\",\n \"entries\":[ ENTRIES_AS_DEFINED_IN_FORMAT_2 ],\n}\n</code></pre>"},{"location":"37_extensions_and_advanced_use.html#37314-format-3-multiple-full-configschemes","title":"3.7.3.1.4 Format 3: multiple full ConfigSchemes","text":"<pre><code>[\n  FULL_CONFIG_SCHEME_AS_DEFINED_IN_FORMAT_3\n]\n</code></pre> <pre><code>stateDiagram-v2\n    direction LR\n    [*] --&gt; UNDECIDED\n    UNDECIDED --&gt; ARRAY : on [\n    UNDECIDED --&gt; SCHEME: on {\n    SCHEME --&gt; SCHEME_ENDED : on }\n    SCHEME --&gt; ENTRY_KEY: on string\n    ENTRY  --&gt; SCHEME: on next value\n</code></pre>"},{"location":"37_extensions_and_advanced_use.html#374-configure-priorities","title":"3.7.4 configure priorities","text":""},{"location":"37_extensions_and_advanced_use.html#3741-file-type-priority","title":"3.7.4.1 File Type Priority","text":"<p>You can control the resolution priority between different file types (e.g., JSON, YAML) using the <code>FILE_TYPE_PRIORITIES</code> feature. This re-orders the search list within each scope.</p>"},{"location":"37_extensions_and_advanced_use.html#3742-storage-type-priority","title":"3.7.4.2 Storage Type Priority","text":"<p>You can control the resolution priority between different storage types (e.g., Files vs. Registry) using the <code>STORAGE_TYPE_PRIORITIES</code> feature. This re-orders the search list within each scope.</p> <p><pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"company\", \"app\")\n.setFeature(ConfigFeature.STORAGE_TYPE_PRIORITIES, List.of(\"files\", \"registry\", \"registryjni\", \"JAR\"));\ntry (ConfigFactory factory = builder.build()) {\n// ...\n}\n</code></pre> Default IDs include: <code>RAM</code>, <code>secrets</code>, <code>files</code>, <code>registry</code>, <code>registryjni</code>, <code>JAR</code>.</p> <p>Additional directories provided via features like <code>ADDITIONAL_USER_DIRECTORIES</code> are typically prepended to the search list for their scope. This makes them the preferred location for creating new configuration files, while still allowing default files in standard locations to provide values (unless the same key is defined in the additional directory).</p>"},{"location":"38_code_improvements.html","title":"3.8 Code Improvements and Best Practices","text":""},{"location":"38_code_improvements.html#defaults","title":"Defaults","text":"<p>Replace code like <pre><code>    Properties defaults = new Properties();\nClassLoader classLoader = Thread.currentThread().getContextClassLoader();\nInputStream input = classLoader.getResourceAsStream(\"defaultconfig.properties\");\ntry {       defaults.load(input);\n}\ncatch (IOException e) {\ne.printStackTrace();        }\n</code></pre></p> <p>with simply using mConfig.</p> <p>Its module mConfigSourceJAR automatically loads defaults from .config/CONFIGNAME.EXTENSIONS in the resource folder of your JAR - besides all its other locations.</p> <p>So, you can remove blocks like the above entirely.</p>"},{"location":"38_code_improvements.html#common-pitfalls-and-feature-flags","title":"Common Pitfalls and Feature Flags","text":"<p>Common mistakes when starting with mConfig, and the feature flags that help avoid them:</p> <ul> <li>Redundant Null Checks: By default, <code>EXCEPTION_ON_MISSING_ENTRY</code> is <code>true</code>, so getters throw <code>ConfigException</code> instead of returning <code>null</code>. This removes the need for <code>if (value == null) value = \"placeholder\"</code> boilerplate.</li> </ul> <p>Replace: <pre><code>String version = config.getString(\"version\");\nif (version == null) {\nversion = \"unknown\";\n}\n</code></pre></p> <p>With: <pre><code>try {\nString version = config.getString(\"version\");\n// use version\n} catch (ConfigException e) {\n// handle missing value once\n}\n</code></pre>  Reminder: You can provide defaults in the resource folder of your JAR.</p> <ul> <li> <p>Manual null handling for missing values: Alternatively, use <code>EXCEPTION_ON_MISSING_ENTRY=false</code> and <code>DEFAULT_ON_MISSING_ENTRY=true</code> to automatically return scheme defaults instead of <code>null</code>.</p> </li> <li> <p>Manual strictness checks: Set <code>SCHEME_STRICT_MODE=true</code> to reject unknown keys at runtime.</p> </li> <li> <p>Manual scope fallback loops: Control with <code>FALLBACKS_ACROSS_SCOPES</code> (for reads) and <code>WRITE_FALLBACK_ACROSS_SCOPES</code> (for writes).</p> </li> <li> <p>Custom format probing: Configure <code>FILE_FORMAT_READING_PRIORITIES</code> and <code>FILE_FORMAT_WRITING_PRIORITIES</code> declaratively instead of hardcoding.</p> </li> </ul> <p>These features promote a declarative style, reducing boilerplate and errors.</p>"},{"location":"41_mconfig_tool.html","title":"4.1 mConfig Tool (<code>mconfig</code>)","text":"<p>The <code>mconfig</code> tool provides a command-line interface for inspecting and managing configurations. It allows you to list available configurations, show effective values, get detailed metadata for specific keys, search for configuration paths, and more.</p>"},{"location":"41_mconfig_tool.html#411-installation","title":"4.1.1 Installation","text":"<p>The tool is available as a \"fat JAR\" in the <code>mConfigTools</code> module. You can run it using:</p> <pre><code>java -jar mConfigTools-*.jar [OPTIONS] [COMMAND] [COMMAND_OPTIONS]\n</code></pre>"},{"location":"41_mconfig_tool.html#412-subcommands","title":"4.1.2 Subcommands","text":"<ul> <li><code>list</code>: List all available configurations for the given company and application.</li> <li><code>show</code>: Print the effective configuration (all keys and values).</li> <li><code>get</code>: Show detailed information for a specific key (value, type, source URI, scope, and description).</li> <li><code>search-paths</code>: List all directories and storage locations where mConfig looks for files.</li> <li><code>propose-scheme</code>: Generate a draft <code>ConfigScheme</code> JSON from an existing configuration.</li> <li><code>validate</code>: Validate a configuration against its scheme.</li> <li><code>set</code>: Set or update a configuration entry. Requires <code>--value</code> and <code>--scope</code>.</li> <li><code>monitor</code>: Monitor a configuration for real-time changes. Keeps running until interrupted.</li> </ul>"},{"location":"41_mconfig_tool.html#4121-set-command-options","title":"4.1.2.1 <code>set</code> command options:","text":"<ul> <li><code>-V, --value=&lt;value&gt;</code>: The value to set.</li> <li><code>-S, --scope=&lt;scope&gt;</code>: Target <code>ConfigScope</code> (<code>USER</code>, <code>HOST</code>, <code>SESSION</code>, <code>RUNTIME</code>, etc.).</li> <li><code>-T, --type=&lt;type&gt;</code>: <code>ConfigEntryType</code> (optional, inferred from scheme if available).</li> <li><code>-d, --dry-run</code>: Display what would be changed without performing the actual write.</li> </ul>"},{"location":"41_mconfig_tool.html#4122-monitor-command-options","title":"4.1.2.2 <code>monitor</code> command options:","text":"<ul> <li><code>--dump</code>: Print the full effective configuration before starting the monitor loop.</li> <li><code>-v, --verbose</code>: Provide more detail about changes (e.g., the scope of the change).</li> </ul>"},{"location":"41_mconfig_tool.html#413-global-options-and-commands","title":"4.1.3 Global Options and Commands","text":"<p>Options can be placed both before and after the command (verb).</p> <ul> <li><code>-c, --company=&lt;name&gt;</code>: Company name (default: <code>MCONFIG_COMPANY</code> env var). Use <code>\"\"</code> (empty string) intentionally to omit the company segment in all paths/sources (e.g., <code>~/.config/myapp/</code>).</li> <li><code>-a, --app=&lt;name&gt;</code>: Application name (default: <code>MCONFIG_APP</code> env var)</li> <li><code>-C, --config=&lt;name&gt;</code>: Configuration name (default: <code>MCONFIG_CONFIG</code> env var)</li> <li><code>-k, --key=&lt;name&gt;</code>: Specific configuration key</li> <li><code>-o, --output=&lt;format&gt;</code>: Output format (<code>HUMAN</code>, <code>JSON</code>, <code>CSV</code>)</li> <li><code>-v, --verbose</code>: Enable verbose output (shows source URIs and scopes)</li> <li><code>-l, --lang=&lt;lang&gt;</code>: Preferred language for descriptions (default: <code>en</code>)</li> </ul> <p>Do not underestimate the power of \"-v\" verbose mode! Try it and see which extra information you can get out of it.</p>"},{"location":"41_mconfig_tool.html#414-shortened-syntax","title":"4.1.4 Shortened Syntax","text":"<p>For quick interactive use, the tool supports a positional argument in the format: <code>[COMPANY:]APPLICATION[:CONFIGNAME[:KEY]]</code> where <code>COMPANY</code> can be empty <code>\"\"</code> to omit the company segment in paths (use leading <code>:</code> e.g. <code>:myapp:settings</code>).</p> <p>Examples: - <code>mconfig mycompany:myapp:database show</code> (with company) - <code>mconfig :myapp:database show</code> (app-only)   Both equivalent to <code>mconfig --company [\"\"\"\"] --app myapp --config database show</code>.</p>"},{"location":"41_mconfig_tool.html#415-environment-variables","title":"4.1.5 Environment Variables","text":"<p>The tool automatically picks up the following environment variables if the corresponding options are not provided: - <code>MCONFIG_COMPANY</code> - <code>MCONFIG_APP</code> - <code>MCONFIG_CONFIG</code></p>"},{"location":"41_mconfig_tool.html#416-examples","title":"4.1.6 Examples","text":"<ol> <li> <p>List configurations:    <pre><code>mconfig --company mycomp --app myapp list\n</code></pre></p> </li> <li> <p>Show effective configuration:    <pre><code>mconfig mycomp:myapp:settings show\n# OR\nmconfig show --company mycomp --app myapp --config settings\n</code></pre></p> </li> <li> <p>Get value and metadata for a specific key:    <pre><code>mconfig mycomp:myapp:db:password get\n</code></pre></p> </li> <li> <p>Change output to JSON for scripting:    <pre><code>mconfig mycomp:myapp:settings show -o JSON\n</code></pre></p> </li> <li> <p>See where the values in your configuration are coming from:    <pre><code>mconfig mycomp:myapp:settings show -v\n</code></pre></p> </li> <li> <p>Set a configuration value:    <pre><code>mconfig mycomp:myapp:db:user set --value=\"dbuser\" --scope=USER\n</code></pre></p> </li> <li> <p>Update a configuration value with dry-run and validation:    <pre><code>mconfig mycomp:myapp:settings:timeout set -V 30 -S HOST -T NUMBER --dry-run\n</code></pre></p> </li> <li> <p>Monitor configuration changes:   This one's for you, SRE and developers!    <pre><code>mconfig mycomp:myapp:settings monitor --dump -v\nmconfig :myapp:settings monitor --dump -v  # app-only\n</code></pre></p> </li> <li> <p>App-only examples (omit company segment):    <pre><code>mconfig -c \"\" myapp list\nmconfig :myapp:db get password\n</code></pre></p> </li> </ol>"},{"location":"42_logging.html","title":"4.2 Logging in mConfig","text":"<p>mConfig uses a custom logging abstraction defined by the <code>ConfigLoggingInterface</code>. This allows the library to remain independent of specific logging frameworks while still providing necessary diagnostic information.</p>"},{"location":"42_logging.html#available-implementations","title":"Available Implementations","text":"Implementation Module Priority Service Name Use Case <code>NullLogging</code> <code>mConfigCore</code> 0 <code>null</code> Default; silent operation. <code>ConsoleLogging</code> <code>mConfigCore</code> 1 <code>console</code> Dev/tests; prints to stdout/stderr. Not for production. <code>Slf4j2Logger</code> <code>mConfigLoggingSlf4j</code> 5 <code>slf4j</code> Production use; forwards to SLF4J."},{"location":"42_logging.html#internal-and-hidden-implementations","title":"Internal and Hidden Implementations","text":"<p><code>InternalLogger</code> (<code>mConfigCore</code>, <code>impl.core</code>): Activated if <code>ConfigFeature.LOGGING_REDIRECT_TARGET</code> is set. Redirects to specified target.</p>"},{"location":"42_logging.html#using-slf4j2logger-in-production","title":"Using SLF4J2Logger in Production","text":"<p><code>Slf4j2Logger</code> (priority 5) bridges mConfig logging to SLF4J.</p>"},{"location":"42_logging.html#421-add-dependencies","title":"4.2.1 Add Dependencies","text":"<p>Maven:</p> <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.metabit.platform.support.config&lt;/groupId&gt;\n&lt;artifactId&gt;mConfigLoggingSlf4j&lt;/artifactId&gt;\n&lt;version&gt;${mconfig.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Gradle:</p> <pre><code>implementation 'org.metabit.platform.support.config:mConfigLoggingSlf4j:${mconfig.version}'\n</code></pre> <p>Note: Also need SLF4J API + impl (e.g., logback-classic).</p>"},{"location":"42_logging.html#422-auto-discovery","title":"4.2.2 Auto-Discovery","text":"<p>With <code>mConfigLoggingSlf4j</code> on classpath, auto-selected (highest prio).</p> <p>Override with <code>ConfigFactoryBuilder.setFeature(ConfigFeature.LOGGING_TO_USE_IN_CONFIGLIB, \"slf4j\")</code>.</p>"},{"location":"42_logging.html#423-configuration","title":"4.2.3 Configuration","text":"<p>Configure SLF4J via <code>logback.xml</code>, etc. </p> <p><code>Slf4j2Logger</code> uses logger name from <code>ConfigFactoryBuilder</code> company/app or default \"mConfig\".</p>"},{"location":"42_logging.html#consolelogging-for-development-and-tests","title":"ConsoleLogging for Development and Tests","text":"<p><code>ConsoleLogging</code> is a lightweight console logger (stdout for lower levels, stderr for WARN/ERROR) for debugging mConfig internals. No external dependencies required.</p>"},{"location":"42_logging.html#424-build-configuration-maven-gradle","title":"4.2.4 Build Configuration (Maven &amp; Gradle)","text":"<p>To use <code>ConsoleLogging</code> in modules other than <code>mConfigCore</code>, you must include the <code>mConfigCore</code> <code>test-jar</code> dependency in your build:</p> <p>Maven:</p> <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.metabit.platform.support.config&lt;/groupId&gt;\n&lt;artifactId&gt;mConfigCore&lt;/artifactId&gt;\n&lt;version&gt;${mconfig.version}&lt;/version&gt;\n&lt;type&gt;test-jar&lt;/type&gt;\n&lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Gradle:</p> <pre><code>testImplementation 'org.metabit.platform.support.config:mConfigCore:${mconfig.version}:tests'\n</code></pre>"},{"location":"42_logging.html#425-manual-activation","title":"4.2.5 Manual Activation","text":"<p>You can instantiate <code>ConsoleLogging</code> directly and pass it to components.</p> <pre><code>import org.metabit.platform.support.config.impl.logging.ConsoleLogging;\nimport org.metabit.platform.support.config.ConfigFeature;\n\n// ... in your test ...\nConsoleLogging logger = new ConsoleLogging(\"MyModuleTest\");\nlogger.setLevel(\"DEBUG\");\n\n// Use with a component that takes a logger\ncomponent.testComponent(settings, logger);\n</code></pre>"},{"location":"42_logging.html#426-usage-with-configfactorybuilder","title":"4.2.6 Usage with ConfigFactoryBuilder","text":"<p><code>ConfigFactoryBuilder</code> uses <code>ServiceLoader</code> to discover <code>ConfigLoggingInterface</code> implementations. </p> <p>Note for Modular Projects: <code>ConsoleLogging</code> is fully supported via <code>provides</code> in the <code>mConfigCore</code> <code>module-info.java</code>.</p> <p>To force the use of <code>ConsoleLogging</code> when using <code>ConfigFactoryBuilder</code> in tests, you can set the feature:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"company\", \"app\");\nbuilder.setFeature(ConfigFeature.LOGGING_TO_USE_IN_CONFIGLIB, \"console\");\n</code></pre> <p>This will only work if the <code>ConsoleLogging</code> class is discoverable by <code>ServiceLoader</code>. If discovery fails, it will fall back to <code>NullLogging</code>.</p>"},{"location":"42_logging.html#configuration","title":"Configuration","text":""},{"location":"42_logging.html#log-levels","title":"Log Levels","text":"<p>Available levels: <code>TRACE</code>, <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code>, <code>ERROR</code>. Default level for <code>ConsoleLogging</code> is <code>INFO</code>.</p> <p>You can set the level via <code>setLevel(String)</code>: <pre><code>logger.setLevel(\"TRACE\");\n</code></pre></p>"},{"location":"42_logging.html#output-redirection","title":"Output Redirection","text":"<ul> <li><code>INFO</code>, <code>DEBUG</code>, <code>TRACE</code> are printed to <code>System.out</code>.</li> <li><code>WARN</code>, <code>ERROR</code> are printed to <code>System.err</code>.</li> </ul>"},{"location":"42_logging.html#how-logging-is-discovered-and-selected","title":"How Logging is Discovered and Selected","text":"<p>In <code>DefaultConfigFactoryBuilder.findLoggerForConfigUse()</code>:</p> <ol> <li> <p>If <code>ConfigFeature.LOGGING_REDIRECT_TARGET</code> is set, instantiate <code>InternalLogger</code> with target and init.</p> </li> <li> <p>Load <code>ServiceLoader&lt;ConfigLoggingInterface&gt;</code>:</p> </li> <li>Prefer exact match to <code>ConfigFeature.LOGGING_TO_USE_IN_CONFIGLIB</code> by service name (case-insensitive).</li> <li>Otherwise, select highest priority (<code>getServiceModulePriority()</code>) among those that <code>init()</code> successfully.</li> <li>Fallback to <code>NullLogging</code>.</li> </ol> <p>All loggers must implement <code>init(ConfigFactorySettings)</code> (usually returns <code>true</code>) and <code>exit()</code>.</p>"},{"location":"43_faq.html","title":"4.3 FAQ - Frequently Asked Questions","text":""},{"location":"43_faq.html#431-i-want-to","title":"4.3.1 I want to...","text":""},{"location":"43_faq.html#i-want-to-extract-a-subconfiguration-to-a-properties-object","title":"I want to extract a subconfiguration to a Properties object.","text":"<p>If your configuration contains a subset of entries, say, for an existing Java component which expects them that way, and you just want to get an pass them on,</p> <p>then  <code>ConfigUtil.copyPrefixedEntriesToJavaProperties()</code> is what should help you.</p> <p>You specify the prefix, including possible \".\" from the hierarchy, and get a java.util.Properties instance with all the contents from the Configuration which start with the prefix. The prefix is removed automatically.</p> <p>Caveat: This will skip configuration layers where the source does not allow enumeration of its contents. So the result of this call may yield results different from what you'd get if you were using the Configuration itself!</p> <p>Recommendation: If that subconfig can be limited in what it may and should contain, please consider using a ConfigScheme (in addition, or instead).</p> <p>Also, have a look at other methods in the ConfigUtil class, for similar use cases.</p>"},{"location":"43_faq.html#i-want-to-know-where-my-configuration-files-are-located","title":"I want to know where my configuration files are located.","text":"<p>Use the mConfigTool provided. It can tell you the general search paths (potential locations), as well as the actual locations of the files it found, and where the values in individual entries come from.</p>"},{"location":"43_faq.html#432-why-is","title":"4.3.2 Why is...","text":""},{"location":"43_faq.html#why-cant-i-state-my-defaults-right-at-the-place-im-asking-for-the-value","title":"Why can't I state my defaults right at the place I'm asking for the value?","text":"<p>This approach sounds simpler - <code>getInteger(\"weightInTons\",5)</code> looks good at first sight. Until you realize what happens when you ask for this value a second time, or a third... Also, this prevents you from generating a proper documentation of your configuration parameters.</p> <p>ConfigSchemes should not be hard to use. Try them, please.</p> <p>But if you insist on using the old way,  there is the mConfigCheese module - for those who like their code a bit pungent.</p>"},{"location":"43_faq.html#433-how-can-i-fix","title":"4.3.3 How can I fix...","text":""},{"location":"43_faq.html#quick-verification-checklist","title":"Quick Verification Checklist","text":"<p>If it's not working yet:</p> <ol> <li> <p>Place a test config file:    Create <code>~/.config/myCompany/myApplication/network.properties</code> (Linux/Mac) or <code>%APPDATA%\\myCompany\\myApplication\\network.properties</code> (Windows):    <pre><code>peer = localhost\nport = 8080\nprobability = 0.5\n</code></pre></p> </li> <li> <p>List discovered configs: <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"myCompany\", \"myApplication\").build()) {\nfactory.listAvailableConfigurations().forEach(System.out::println);\n}\n</code></pre></p> </li> <li> <p>Enable logging: Add <code>mConfigLoggingSlf4j</code> dep + SLF4J config (see No mConfig logging output below).</p> </li> <li> <p>Use mConfigTool CLI: <code>mconfig myCompany:myApplication get network.peer -v</code> (requires building mConfigTools; see mConfigTools README).</p> </li> <li> <p>See detailed troubleshooting sections below.</p> </li> </ol>"},{"location":"43_faq.html#updates-to-config-files-are-not-detected","title":"Updates to config files are not detected","text":"<ol> <li>You are not buffering the results in some local variables, are you?  Your own variables are not updated by mConfig. Ask the Configuration object for the value instead whenever you need it.</li> <li>Are the directories and files accessible for the account the program runs as? mConfig needs to be able to list directory contents and read config files; inaccessible dirs and files cause debug messages at most, but no error.</li> <li>The cache setting doesn't match with your expected reaction time. For efficiency, files are not checked and re-read on every config value access. There is a delay between checks. If the default value (2 seconds) is too long for your purposes, you can change it. @TODO name the config settings key. Keep in mind a higher update frequency increases overhead.</li> <li>Is the format supported? You can choose and combine mconfig Format modules; if the file extension pattern of the config file does not match with a file format present in your current build, it won't be read.</li> </ol>"},{"location":"43_faq.html#jpms-module-access-errors","title":"JPMS Module Access Errors","text":"<p>If your application uses JPMS (named <code>module-info.java</code>) but omits <code>requires</code> for mConfig modules, you will see access errors.</p> <p>Compile-time (javac): <pre><code>cannot access metabit.mconfig.core.ConfigFactory\n  module your.module does not read module metabit.mconfig.core\n</code></pre></p> <p>Runtime (java): <pre><code>java.lang.IllegalAccessError: class your.package.YourClass cannot access class metabit.mconfig.core.ConfigFactory (in module metabit.mconfig.core) because module your.module does not read module metabit.mconfig.core\n</code></pre></p> <p>Fix: Add the required <code>requires</code> directives to your <code>module-info.java</code>.</p> <p>The list depends on the mConfig variant:</p> <ul> <li>mConfigFull (JPMS <code>requires</code> section)</li> <li>mConfigStandard (JPMS <code>requires</code> section)</li> </ul> <p>See also JPMS introduction.</p>"},{"location":"43_faq.html#config-values-always-returning-defaults-or-null","title":"Config values always returning defaults or null","text":"<p>Symptoms: Calls like <code>cfg.getString(\"key\")</code> return <code>null</code> or scheme defaults; no exceptions or warnings.</p> <p>Common causes: - Mismatched <code>company</code>, <code>application</code>, or <code>configName</code> (case-sensitive). - No config files in standard locations (classpath <code>src/main/resources/.config/&lt;company&gt;/&lt;app&gt;/&lt;configName&gt;.properties</code> or filesystem equivalents). - File extension not matching available formats (e.g., <code>.yaml</code> without YAML format module). - Permissions issues on directories/files (check logs).</p> <p>Fix steps: 1. Use <code>factory.listAvailableConfigurations()</code> to list discovered configs and their sources. 2. Run mConfigTool CLI for full diagnostics: paths searched, files found, entry origins. 3. Verify placements per Getting Started. 4. Add missing format modules (e.g., <code>mConfigFormatYAMLwithJackson</code> for YAML).</p>"},{"location":"43_faq.html#tests-not-loading-expected-configurations","title":"Tests not loading expected configurations","text":"<p>Symptoms: Unit/integration tests use production defaults or empty configs despite <code>setTestMode(true)</code>.</p> <p>Causes: - Missing <code>ConfigFactoryBuilder.setTestMode(true)</code> before <code>build()</code>. - Test files not in correct locations. - <code>forbidTestMode()</code> called or <code>PERMIT_TEST_MODE=false</code>.</p> <p>Fix: 1. Add <code>@BeforeAll static void setup() { ConfigFactoryBuilder.setTestMode(true); }</code> 2. Place files in:    - <code>src/test/resources/.config/&lt;company&gt;/&lt;app&gt;/&lt;configName&gt;.ext</code> (preferred)    - <code>src/test/resources/config/&lt;SCOPE&gt;</code> (e.g., <code>USER</code>) 3. Custom: <code>ConfigFactoryBuilder.setFeature(ConfigFeature.TESTMODE_DIRECTORIES, List.of(\"USER:src/test/configs\"));</code> 4. See full details in Test Mode.</p>"},{"location":"43_faq.html#no-mconfig-logging-output","title":"No mConfig logging output","text":"<p>Symptoms: Silent on config discovery, errors, or debug info.</p> <p>Fix: 1. Add dependency: <code>mConfigLoggingSlf4j</code>. 2. Configure SLF4J backend (e.g., Logback <code>logback.xml</code>):    <pre><code>&lt;logger name=\"metabit.config\" level=\"DEBUG\"/&gt;\n</code></pre> 3. Ensure SLF4J implementation (logback-classic, log4j-slf4j) on classpath. See Logging.</p>"},{"location":"43_faq.html#environment-variables-dont-provide-config-values","title":"Environment variables don't provide config values","text":"<p>Symptoms: Env vars like <code>myapp-network-peer=localhost</code> ignored.</p> <p>Fix: 1. Add <code>mConfigSourceEnvVar</code> dependency. 2. Use naming scheme: <code>&lt;application&gt;_&lt;configName&gt;_&lt;key&gt;</code> (lowercase, e.g., <code>myapp_network_peer</code>). 3. Scope: <code>SESSION</code> (overrides USER). 4. Verify via <code>mConfigTool</code> or enable logging. See mConfigSourceEnvVar README.</p>"},{"location":"44_design_consolidated.html","title":"4.4 mConfig Consolidated Design Document","text":""},{"location":"44_design_consolidated.html#441-overview","title":"4.4.1 Overview","text":"<p>mConfig is a modular configuration library for Java, designed for flexibility,  extensibility, and standardized configuration management  across different operating systems and environments.</p>"},{"location":"44_design_consolidated.html#4411-multi-platform-portability-goal","title":"4.4.1.1 Multi-Platform Portability Goal","text":"<p>While the primary implementation is in Java, mConfig is designed  with future ports to other languages (e.g., C, Rust, Python) in mind. - Abstraction over Platform Specifics: Core logic (in <code>mConfigCore</code>) MUST  remain agnostic of specific packaging formats (like JARs) or environment-specific APIs (like Java ClassLoaders). - Module Isolation: Platform-specific logic (e.g., scanning Java classpath for resources) must be isolated in dedicated modules (like <code>mConfigSourceJAR</code>). - Standardized Interfaces: Use generic interfaces for discovery and storage to ensure that the core behavior can be mirrored in other language environments without significant architectural changes.</p>"},{"location":"44_design_consolidated.html#core-architectural-principle-layered-stack","title":"Core Architectural Principle: Layered Stack","text":"<p>Configurations are resolved through a stack of layers, prioritized by scope specificity. Cache (optional) -&gt; Found Sources (ordered by scope) -&gt; Defaults</p>"},{"location":"44_design_consolidated.html#442-scopes-and-priority","title":"4.4.2 Scopes and Priority","text":"<p>Scopes define the visibility and precedence of configuration data.</p> Scope Description Priority POLICY Enforced policy settings (e.g., GPO), overriding everything else. 1 (Highest) RUNTIME Volatile, in-memory settings for the current process. 2 SESSION Specific to the current user session or working directory. 3 USER Personal settings for the current user (e.g., <code>~/.config/</code>). 4 APPLICATION Settings specific to the application installation/portable root. 5 HOST Host / OS instance settings (e.g., <code>/etc/</code>, Windows Registry HKLM). 6 CLUSTER Settings for a cluster of hosts. 7 CLOUD Cloud-based configurations, shared across multiple clusters. 8 ORGANIZATION Settings shared across an organization/licensee. 9 PRODUCT Hardcoded defaults provided by the application or modules. 10 (Lowest) <p>Tie-breaking within the same scope: Later-added layers take precedence over earlier-added ones.</p>"},{"location":"44_design_consolidated.html#4421-storage-type-priority","title":"4.4.2.1 Storage Type Priority","text":"<p>Resolution priority between different storage types (within the same scope) is deterministic.</p> <p>Default Order (Highest to Lowest): 1. <code>RAM</code> (In-memory overrides) 2. <code>secrets</code> (Encrypted/sensitive data) 3. <code>files</code> (Local filesystem) 4. <code>registry</code> (Windows Registry - JNR-FFI) 5. <code>registryjni</code> (Windows Registry - JNI) 6. <code>zookeeper</code> (ZooKeeper - Experimental, Self-configuring) 7. <code>JAR</code> (Classpath resources/defaults)</p> <p>This order can be customized via <code>STORAGE_TYPE_PRIORITIES</code> (List of IDs) and <code>STORAGE_TYPE_ALLOW_ALL_STORAGES</code> (Boolean).</p>"},{"location":"44_design_consolidated.html#4422-self-configuration","title":"4.4.2.2 Self-Configuration","text":"<p>mConfig supports \"self-configuration\" to allow the library to configure  its own behavior using the same discovery mechanisms it provides to applications.</p>"},{"location":"44_design_consolidated.html#44221-library-self-configuration-configfactorysettings","title":"4.4.2.2.1 Library Self-Configuration (ConfigFactorySettings)","text":"<p>When the <code>mConfigSourceJAR</code> module is present, mConfig automatically searches for a properties file named <code>mconfig.properties</code> in the following classpath location: <code>.config/metabit/mConfig/mconfig.properties</code></p> <p>This file is used to populate <code>ConfigFactorySettings</code> during the  <code>ConfigFactory</code> initialization. It supports setting any <code>ConfigFeature</code>. (Thus, handle with care; it is as powerful as its code counterparts.)</p> <ul> <li>Discovery: It uses <code>ClassLoader.getResources()</code> to find  all occurrences of this file in the classpath, allowing settings to be provided from multiple JARs or resource paths.</li> <li>Format: Standard Java <code>.properties</code> format only. Keys (ignoring case) are matched against <code>ConfigFeature</code> constants.</li> <li>Disabling: This feature is enabled by default for convenience, but can be disabled via <code>ConfigFeature.ENABLE_SELF_CONFIGURATION = false</code> for environments with strict classpath security requirements.</li> </ul>"},{"location":"44_design_consolidated.html#44222-networked-source-self-configuration","title":"4.4.2.2.2 Networked Source Self-Configuration","text":"<p>Networked sources (like ZooKeeper) can also retrieve their own connection settings (connect string, root path, etc.) from previously loaded layers (e.g., JAR defaults or local filesystem overrides).</p> <p>Resolution Order during Startup: 1.  Core Discovery: Modules (Storages, Formats) and <code>ConfigFactoryComponent</code>s are identified. 2.  Library Self-Configuration: <code>SelfConfigurationComponent</code> (from <code>mConfigSourceJAR</code>) is initialized, populating <code>ConfigFactorySettings</code> from <code>mconfig.properties</code>. 3.  Local Source Initialization: <code>JARConfigSource</code> and <code>FileConfigStorage</code> are initialized based on <code>STORAGE_TYPE_PRIORITIES</code>. 4.  Networked Source Initialization:     - <code>ZooKeeperConfigStorage.init()</code> is called.     - It requests its own configuration (default name: <code>\"zookeeper\"</code>) from the factory via <code>ctx.getFactory().getConfig(\"zookeeper\")</code>.     - If settings are found in JAR defaults or local files, it connects and registers its locations (e.g., <code>CLUSTER</code>, <code>ORGANIZATION</code>).     - If settings are missing, it remains inactive (zero-config support). 5.  Finalization: The factory is ready, including any successfully activated networked layers.</p> <p>See ZooKeeper Example for detailed configuration snippets.</p>"},{"location":"44_design_consolidated.html#443-core-components","title":"4.4.3 Core Components","text":""},{"location":"44_design_consolidated.html#configfactory","title":"ConfigFactory","text":"<p>The main entry point. It manages the <code>ConfigSearchList</code> and instantiates <code>Configuration</code> objects.</p>"},{"location":"44_design_consolidated.html#configsearchlist","title":"ConfigSearchList","text":"<p>A prioritized list of <code>ConfigLocation</code> entries defining where the library should look for configurations.</p>"},{"location":"44_design_consolidated.html#configlocation-configsource","title":"ConfigLocation &amp; ConfigSource","text":"<ul> <li>ConfigLocation: Defines where a configuration might be found (Storage + Handle + Scope).</li> <li>ConfigSource: An instantiated <code>ConfigLocation</code> that is associated with a specific <code>ConfigLayer</code>. It confirms the configuration exists and is readable.</li> </ul>"},{"location":"44_design_consolidated.html#configstorage","title":"ConfigStorage","text":"<p>Provides low-level access to data (e.g., <code>FileConfigStorage</code>, <code>WindowsRegistryConfigStorage</code>, <code>EnvVarConfigStorage</code>).</p>"},{"location":"44_design_consolidated.html#configformat","title":"ConfigFormat","text":"<p>Parses and writes data in specific formats (e.g., <code>Properties</code>, <code>JSON</code>, <code>YAML</code>, <code>TOML</code>, <code>JSON5</code>, <code>INI</code>). It is responsible for instantiating <code>ConfigLayer</code> objects.</p>"},{"location":"44_design_consolidated.html#configlayer","title":"ConfigLayer","text":"<p>A concrete instance of configuration data from a <code>ConfigLocation</code>. It maps hierarchical keys (e.g., <code>database/host</code>) to <code>ConfigEntry</code> objects.</p>"},{"location":"44_design_consolidated.html#configentry","title":"ConfigEntry","text":"<p>A leaf node in the configuration tree, containing the value and metadata (like the source location).</p>"},{"location":"44_design_consolidated.html#444-operational-modes","title":"4.4.4 Operational Modes","text":""},{"location":"44_design_consolidated.html#test_mode","title":"TEST_MODE","text":"<ul> <li>Bypasses standard OS locations.</li> <li>Uses only explicitly provided test paths (via <code>TESTMODE_DIRECTORIES</code> feature) and standard test resources.</li> <li><code>TESTMODE_DIRECTORIES</code> entries support the <code>SCOPENAME \":\" PATH</code> format.</li> <li>Prevents tests from interfering with or relying on actual user configurations.</li> <li>Security: Employs a two-tier gate system (Global Static Gate + Instance Dynamic Gate). <code>PERMIT_TEST_MODE</code> defaults to <code>true</code> (\"Productive by Default\") but can be locked down per instance.</li> </ul>"},{"location":"44_design_consolidated.html#additional_directories","title":"ADDITIONAL_DIRECTORIES","text":"<ul> <li><code>ADDITIONAL_RUNTIME_DIRECTORIES</code> and <code>ADDITIONAL_USER_DIRECTORIES</code> allow adding custom search paths at runtime.</li> <li>Support the <code>SCOPENAME \":\" PATH</code> format, allowing paths to be assigned to any scope (not just their default scope).</li> <li>Prepended to the search list of their respective scope, ensuring they take precedence over default locations.</li> </ul>"},{"location":"44_design_consolidated.html#service-mode-auto-refresh-monitoring","title":"SERVICE-mode (Auto-refresh &amp; Monitoring)","text":"<ul> <li>If enabled, every access re-checks the search list for new or updated configuration files.</li> <li>Recommended to be used with a Cache Layer to mitigate performance overhead.</li> <li>Cache entries should have a configurable TTL (Time-To-Live).</li> <li>Monitoring Support: <code>Configuration</code> supports the <code>subscribeToUpdates(Consumer&lt;ConfigLocation&gt;)</code> mechanism.    This is used by the <code>monitor</code> CLI command to provide real-time reporting of changes.</li> </ul>"},{"location":"44_design_consolidated.html#4442-self-configuration-security","title":"4.4.4.2 Self-Configuration Security","text":"<p>Self-configuration (see section 2.2.1) automatically applies settings from the classpath. In environments where the classpath might contain untrusted JARs, this feature can be disabled: <pre><code>ConfigFactoryBuilder.create(\"metabit\", \"APP\")\n.setFeature(ConfigFeature.ENABLE_SELF_CONFIGURATION, false)\n.build();\n</code></pre> Disabling self-configuration ensures that the <code>ConfigFactory</code> starts with only the settings explicitly provided in code, preventing \"configuration injection\" via the classpath.</p>"},{"location":"44_design_consolidated.html#445-reading-and-writing","title":"4.4.5 Reading and Writing","text":""},{"location":"44_design_consolidated.html#reading","title":"Reading","text":"<ul> <li>Sequential search from most specific to least specific scope.</li> <li>Value conversion (String to Integer, Boolean, etc.) is handled at the <code>Configuration</code> facade level.</li> </ul>"},{"location":"44_design_consolidated.html#writing","title":"Writing","text":"<ul> <li>Direct Write: Attempt to write back to the <code>ConfigLocation</code> where the entry was found.</li> <li>Scope-based Write: Specify a scope for the write operation.</li> <li>Write Fallback (Fall-forward): If writing to the preferred location fails, attempt to write to a more specific scope (e.g., if MACHINE is read-only, write to USER).</li> <li>Write Cache: Optional layer that buffers writes until a <code>flush()</code> is called.</li> </ul>"},{"location":"44_design_consolidated.html#446-security-and-secrets","title":"4.4.6 Security and Secrets","text":"<p>mConfig provides specialized handling for sensitive data (API keys, passwords, certificates).</p>"},{"location":"44_design_consolidated.html#4461-secret-entries","title":"4.4.6.1 Secret Entries","text":"<ul> <li>Sensitive data should be handled via <code>SecretValue</code> and <code>SecretConfigEntryLeaf</code>.</li> <li>Values are obfuscated in memory (<code>char[]</code> or <code>byte[]</code> instead of <code>String</code> where possible).</li> <li><code>toString()</code> implementation of secret entries is automatically redacted (<code>[REDACTED]</code>).</li> <li><code>ConfigFacadeImpl.getSecret(key)</code> is the preferred API to retrieve a <code>SecretValue</code>.</li> </ul>"},{"location":"44_design_consolidated.html#4462-scheme-driven-secrets","title":"4.4.6.2 Scheme-Driven Secrets","text":"<p>A <code>ConfigEntry</code> is treated as a secret if its <code>ConfigEntrySpecification</code> (from a <code>ConfigScheme</code>) has the <code>SECRET</code> flag set. - <code>ConfigEntryFactory</code> automatically creates a <code>SecretConfigEntryLeaf</code> if the scheme marks the key as a secret. - Intelligent Type Selection: When creating a secret entry, the factory chooses a <code>SecretType</code> (e.g., <code>PLAIN_TEXT</code> vs <code>SYMMETRIC_KEY</code>) based on the requested <code>ConfigEntryType</code>.</p>"},{"location":"44_design_consolidated.html#4463-external-secrets-providers","title":"4.4.6.3 External Secrets Providers","text":"<p>External authentication (e.g., towards networked sources like HashiCorp Vault)  can be integrated via specialized modules implementing <code>ConfigSecretsProviderInterface</code>. - Secret providers are initialized during the configuration loading phase. - They can receive a <code>ConfigurationPhaseWrapper</code> to access  partially loaded configurations for their own initialization (e.g., to read the Vault address from a local file).</p>"},{"location":"44_design_consolidated.html#447-format-specifics","title":"4.4.7 Format Specifics","text":""},{"location":"44_design_consolidated.html#java-properties","title":"Java .properties","text":"<ul> <li>Flat key-value pairs. Trims whitespace.</li> <li>Supports multi-line values with <code>\\</code>.</li> </ul>"},{"location":"44_design_consolidated.html#json-json5","title":"JSON / JSON5","text":"<ul> <li>Toplevel must be an Object or Array.</li> <li>JSON5 adds support for comments, trailing commas, and unquoted keys.</li> </ul>"},{"location":"44_design_consolidated.html#yaml","title":"YAML","text":"<ul> <li>Supports hierarchical structures.</li> <li>Implementation must ensure secure parsing (avoiding arbitrary command execution).</li> </ul>"},{"location":"44_design_consolidated.html#ini","title":"INI","text":"<ul> <li>Section-based (<code>[section]</code>).</li> <li>Hierarchical keys can be mapped to sections using <code>/</code> (e.g., <code>[first/second]</code>).</li> </ul>"},{"location":"44_design_consolidated.html#4477-writing-priorities","title":"4.4.7.7 Writing Priorities","text":"<p>When writing to a configuration (e.g., via <code>put</code>), mConfig applies the following priorities within the requested scope(s):</p> <ol> <li>Priority 1: Update Existing Entry. The highest-priority writeable layer in the scope that already contains the key is updated.</li> <li>Priority 2: Add to Existing Layer. If the key is new to the scope, it is added to the highest-priority writeable layer already instantiated in that scope.</li> <li>Priority 3: Create New Layer. If no writeable layers exist for the scope, mConfig attempts to create a new one using the prioritized <code>ConfigStorage</code> and <code>ConfigFormat</code> settings.</li> </ol> <p>Writes are strictly scope-isolated unless <code>WRITE_FALLBACK_ACROSS_SCOPES</code> is enabled. For multi-scope writes, mConfig iterates from the most specific to the most generic scope, stopping at the first successful write.</p>"},{"location":"44_design_consolidated.html#448-blobs-binary-data","title":"4.4.8 BLOBs (Binary Data)","text":"<p>mConfig supports Binary Large Objects (certs, licenses, keys) in two distinct ways:</p>"},{"location":"44_design_consolidated.html#4481-hierarchical-blobs-keyed-leaves","title":"4.4.8.1 Hierarchical BLOBs (Keyed Leaves)","text":"<p>In hierarchical formats like JSON and YAML, binary data can exist as a leaf node with a specific key (e.g., <code>server/certificate</code>). - YAML: Native support via the <code>!!binary</code> tag. - JSON: Supported via Base64 encoding. If a <code>ConfigScheme</code> marks a key as <code>BYTES</code>, the JSON format will automatically decode the Base64 string into a <code>BlobConfigEntryLeaf</code>. - These entries are part of the regular configuration tree and can be accessed via <code>getValueAsBytes()</code>.</p>"},{"location":"44_design_consolidated.html#4482-flat-blobs-opaque-files","title":"4.4.8.2 Flat BLOBs (Opaque Files)","text":"<p>Entire files can be treated as a single binary blob using the <code>FileRawBinaryFormat</code> (extension <code>.bin</code>). - These are opaque and have no internal structure. - The entry is always accessed using the empty string key (<code>\"\"</code>). - Requesting any other key from a flat binary layer will return <code>null</code>.</p>"},{"location":"44_design_consolidated.html#449-crypto-library-interaction","title":"4.4.9 Crypto Library Interaction","text":"<p>mConfig is designed to work seamlessly with standard Java crypto libraries (JCE) and third-party libraries like BouncyCastle.</p> <ul> <li>JCE Integration: <code>SecretValue</code> can store raw bytes of <code>PrivateKey</code>, <code>PublicKey</code>, or <code>SecretKey</code>. Conversion typically involves <code>key.getEncoded()</code>.</li> <li>BouncyCastle: Can be used to process <code>SecretValue</code> contents (e.g., parsing a PEM-encoded certificate stored as a <code>BYTES</code> entry).</li> <li>Test Strategy: Integration tests (<code>SecretsJCETest</code>, <code>SecretsBCTest</code>) verify that low-level binary secrets are preserved exactly as they move through the configuration stack.</li> </ul>"},{"location":"44_design_consolidated.html#4410-configuration-schemes","title":"4.4.10 Configuration Schemes","text":"<p>Configuration Schemes define the contract for a set of configuration entries, specifying keys, types, defaults, and validation rules.</p> <p>See the detailed Configuration Schemes for information on: - Scheme structure and properties - Future-proofing with the <code>MANDATORY</code> block - JSON format variants - Discovery and registration via <code>ConfigSchemeRepository</code></p>"},{"location":"44_design_consolidated.html#44101-discovery-and-precedence","title":"4.4.10.1 Discovery and Precedence","text":"<p>Schemes are automatically discovered from the classpath (specifically within <code>.config/</code> directories) if the <code>JARConfigSource</code> is active.</p> <ul> <li>Unified Discovery: Discovery is performed across all classpath resources, including both <code>main</code> and <code>test</code> resource directories.</li> <li>Precedence: If multiple scheme files for the same configuration name are discovered, a \"Last-One-Wins\" strategy is applied based on the order returned by the <code>ClassLoader</code>. In typical development environments (Maven/Gradle), this means production resources might overwrite test resources if they appear later in the classpath enumeration.</li> <li>Scope Agnosticism: Unlike configuration data (layers), schemes are not scope-isolated in <code>TEST_MODE</code>. Production schemes are always loaded to ensure a consistent contract.</li> </ul>"},{"location":"44_design_consolidated.html#44102-discovery-and-binding-flow-mermaid","title":"4.4.10.2 Discovery and Binding Flow (Mermaid)","text":"<p>The following diagram illustrates how schemes are discovered by storages, registered in the factory, and finally bound to configuration instances.</p> <pre><code>sequenceDiagram\n    participant S as ConfigStorage (e.g. JAR)\n    participant C as ConfigFactoryInstanceContext\n    participant F as ConfigFactory\n    participant L as LayeredConfiguration\n    participant DL as DefaultLayer\n\n    Note over S, C: Discovery Phase (during Storage.init)\n    S-&gt;&gt;C: registerDiscoveredScheme(name, json)\n\n    Note over C, F: Registration Phase (during Factory.init)\n    F-&gt;&gt;C: getDiscoveredSchemes()\n    F-&gt;&gt;F: addConfigScheme(name, scheme)\n\n    Note over F, L: Binding Phase (during factory.getConfig)\n    F-&gt;&gt;L: instantiate with matching scheme\n    L-&gt;&gt;DL: transferDefaults(scheme)</code></pre>"},{"location":"44_design_consolidated.html#layered-configuration-mermaid","title":"Layered Configuration (Mermaid)","text":"<pre><code>%%{init: {'theme':'neutral'}}%%\nerDiagram\n    Configuration ||--|| BasicConfiguration : \"facade for\"\n    BasicConfiguration ||--|| LayeredConfiguration : \"implemented by\"\n    LayeredConfiguration ||--o| CacheLayer : \"at top\"\n    LayeredConfiguration ||--o{ ConfigSource : \"stacked in the middle\"\n    LayeredConfiguration ||--|| DefaultLayer : \"at bottom\"\n    LayeredConfiguration ||--o| ConfigScheme : \"bound to\"\n    ConfigScheme ||--|| DefaultLayer : \"populates\"\n    ConfigScheme ||--o{ ConfigEntrySpecification : \"contains\"\n    ConfigEntry }|--o| ConfigEntrySpecification : \"validated by\"\n    ConfigSource }|--|| ConfigScope : \"belongs to\"\n    ConfigSource ||--|| ConfigLocation : \"where to look\"\n    ConfigSource }o--|| ConfigStorage : \"how to access\"\n    ConfigSource }o--|{ ConfigFormat : \"maps paths to entries\"</code></pre>"},{"location":"44_design_consolidated.html#4411-extending-mconfig","title":"4.4.11 Extending mConfig","text":""},{"location":"44_design_consolidated.html#44111-adding-new-storages","title":"4.4.11.1 Adding New Storages","text":"<p>This is intended for library maintainers extending mConfig with new backends (e.g., databases, cloud stores).</p> <p>When implementing a new <code>ConfigStorage</code>:</p> <ol> <li>Module Creation: Create <code>mConfigSource&lt;Name&gt;</code> module with <code>ConfigStorageInterface</code> impl.</li> <li>init(ctx): Populate <code>ctx.getSearchList()</code> with <code>ConfigLocationImpl</code> for scopes/formats/paths.</li> <li>Read Layers: In <code>tryToReadConfigurationLayers</code>, load/parse entries into <code>LayeredConfiguration</code>.</li> <li>Classpath Order: Auto-discovered; control via <code>ConfigFeature.STORAGE_TYPE_PRIORITIES</code>.</li> <li>Testing: Add unit/integration tests; verify with full <code>mvn clean test</code>.</li> </ol> <p>Examples: <code>FileConfigStorage</code>, <code>JARConfigSource</code>, <code>WindowsRegistryConfigSource</code>.</p> <p>In case a specific config format is to be supported as well, it can go into the same module.</p>"},{"location":"44_design_consolidated.html#44112-adding-new-configfeatures","title":"4.4.11.2 Adding New ConfigFeatures","text":"<p>This is not for library consumers; only project owners should need to perform this step.</p> <p>When adding a new constant to the <code>ConfigFeature</code> enum in <code>mConfigCore</code>, you MUST perform the following steps to ensure technical consistency and avoid runtime errors:</p> <ol> <li>Enum Constant: Add the new constant to the <code>ConfigFeature</code> enum.</li> <li>Type Initialization: In the <code>static</code> initialization block of <code>ConfigFeature</code>, you MUST assign a <code>ValueType</code> to the <code>valueType</code> field of the new constant.<ul> <li>Example: <code>REGISTRY_BASE_PATH.valueType = ValueType.STRING;</code></li> </ul> </li> <li>Default Values (Optional): If the feature should have a default value, assign it to the <code>defaultValue</code> field in the same <code>static</code> block.<ul> <li>Example: <code>MY_FEATURE.defaultValue = Boolean.TRUE;</code></li> </ul> </li> <li>Verification: Run the <code>ConfigFeatureTypesTest</code> unit test to ensure that all features have a valid type assigned. A missing type will cause a <code>NullPointerException</code> when the feature is accessed via <code>ConfigFactorySettings</code>.</li> </ol>"},{"location":"44_design_consolidated.html#4412-best-practices","title":"4.4.12 Best Practices","text":""},{"location":"44_design_consolidated.html#classpath-layout","title":"Classpath Layout","text":"<ul> <li>Production Defaults: <code>src/main/resources/.config/&amp;lt;company&amp;gt;/&amp;lt;app&amp;gt;/&amp;lt;config&amp;gt;.&amp;lt;ext&amp;gt;</code> (JARConfigSource).</li> <li>Test Mode: <code>src/test/resources/.config/&amp;lt;company&amp;gt;/&amp;lt;app&amp;gt;/</code> + <code>config/{SCOPE}</code> (overrides project).</li> <li>Schemes: Same path + <code>.scheme.json</code>.</li> </ul>"},{"location":"44_design_consolidated.html#logging","title":"Logging","text":"<ul> <li>Implement <code>ConfigLoggingInterface</code> for structured logs (SLF4J/JUL/Logback).</li> <li>Avoid: <code>System.out.println</code> (blocks UI/threads).</li> <li>Secrets auto-redacted.</li> </ul>"},{"location":"44_design_consolidated.html#secrets-handling","title":"Secrets Handling","text":"<ul> <li>Retrieve: <code>SecretValue sv = config.getSecret(key)</code> (scheme-marked SECRET).</li> <li>Use: <code>byte[] data = sv.getValue()</code>; <code>sv.erase()</code> post-use (secure wipe).</li> <li>Storage: Formats preserve <code>SecretValue</code>; logs masked.</li> </ul> <p>See Handling Secrets.</p>"},{"location":"45_ai_guidance.html","title":"4.5 AI Guidance (Notes for Code-Generating Tools)","text":"<p>We just know people will use code generators. So it's probably for the best to give the AI some hints.</p> <p>This document summarizes mConfig behaviours that code generators often miss. The goal is to prevent boilerplate, duplicate logic, or incorrect assumptions.</p>"},{"location":"45_ai_guidance.html#logging-and-runtime-debug-control","title":"Logging and runtime debug control","text":"<ul> <li>Runtime logging overrides are provided by <code>mConfigSourceEnvVar</code> and are only   enabled if <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> is set to <code>true</code>.</li> <li>Environment variables start with <code>MCONFIG_RUNTIME_</code>:</li> <li><code>MCONFIG_RUNTIME_DEBUG_LEVEL</code> = off|0, error|1, warn|2, info|3, debug|4, trace|5</li> <li><code>MCONFIG_RUNTIME_DEBUG_OUTPUT</code> = \"stderr\", \"stdout\", \"quiet\",     or <code>file:&lt;path&gt;</code> (appended if present, created if missing)</li> <li><code>MCONFIG_RUNTIME_DEBUG_OUTPUT</code> is handled internally by <code>InternalLogger</code>.   You do not need to implement a custom logger for this.</li> </ul> <p>Related docs: - mConfigSourceEnvVar README - logging</p>"},{"location":"45_ai_guidance.html#console-logging-for-devtests","title":"Console logging for dev/tests","text":"<ul> <li><code>ConsoleLogging</code> in <code>mConfigCore</code> main jar (service <code>\"console\"</code>).</li> <li>Production logging should use <code>mConfigLoggingSlf4j</code> or the default   <code>NullLogging</code>.</li> <li>Enable with <code>ConfigFeature.LOGGING_TO_USE_IN_CONFIGLIB = \"console\"</code>.</li> </ul> <p>Related docs: - logging</p>"},{"location":"45_ai_guidance.html#defaults-belong-in-resources-not-in-code","title":"Defaults belong in resources, not in code","text":"<ul> <li><code>mConfigSourceJAR</code> automatically loads defaults from resources located at   <code>.config/&lt;company&gt;/&lt;app&gt;/&lt;config&gt;.&lt;ext&gt;</code>.</li> <li>For a standard Maven layout, the default location is:</li> <li><code>src/main/resources/.config/&lt;company&gt;/&lt;app&gt;/&lt;config&gt;.properties</code></li> <li>Schemes (typed defaults and validation) live next to the config file:</li> <li><code>src/main/resources/.config/&lt;company&gt;/&lt;app&gt;/&lt;config&gt;.scheme.json</code></li> <li>Avoid manual loading of <code>Properties</code> defaults. mConfig already layers JAR   defaults with filesystem, environment, and other sources.</li> <li>Avoid null checks. mConfig has ConfigFeature flags to control behaviour,    whether to throw an exception or return a default value. Prefer setting defaults   as described above.</li> </ul> <p>Related docs: - simple configuration loading - 3.8 code improvements - regular use</p>"},{"location":"45_ai_guidance.html#fallbacks-and-conversion-are-built-in","title":"Fallbacks and conversion are built in","text":"<ul> <li>Fallback across scopes is a first-class feature:</li> <li><code>FALLBACKS_ACROSS_SCOPES</code> controls reads (default: true)</li> <li><code>WRITE_FALLBACK_ACROSS_SCOPES</code> controls writes (default: false)</li> <li>Typed getters (<code>getInteger</code>, <code>getBoolean</code>, etc.) perform conversion for you.   Do not parse values manually.</li> <li>To return scheme defaults on missing entries, use:</li> <li><code>EXCEPTION_ON_MISSING_ENTRY=false</code></li> <li><code>DEFAULT_ON_MISSING_ENTRY=true</code></li> </ul> <p>Related docs: - 2.5 config features - design consolidated - 3.8 code improvements</p>"},{"location":"45_ai_guidance.html#converters-and-mappers","title":"converters and mappers","text":"<ul> <li>ConfigMapper is provided to map from and to POJOs.</li> <li>ConfigUtil.fromProperties(...) is a bridge to convert legacy <code>Properties</code>.</li> <li>ConfigUtil.withOverrides(...) is a bridge to merge custom maps.</li> <li>ConfigUtil.remapped(...) is a bridge to prefix sub-configs.</li> <li>See examples/configuration_views.md for more.</li> </ul>"},{"location":"45_ai_guidance.html#overrides-use-scopes-not-ad-hoc-logic","title":"Overrides: use scopes, not ad-hoc logic","text":"<ul> <li>For in-process overrides, prefer <code>ConfigScope.RUNTIME</code> via <code>put(...)</code>.   It is the highest regular scope and overrides everything except <code>POLICY</code>.</li> <li>For environment/session overrides, use <code>ConfigScope.SESSION</code> (env vars and CLI).   Avoid custom precedence logic.</li> </ul> <p>Related docs: - regular use - 2.1 how it works</p>"},{"location":"45_ai_guidance.html#test-mode-is-a-first-class-feature","title":"Test Mode is a first-class feature","text":"<ul> <li>Enable with <code>ConfigFactoryBuilder.setTestMode(true)</code> or via   <code>MCONFIG_RUNTIME_TEST_MODE=true</code> when <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> is on.</li> <li>Test Mode bypasses OS paths and prefers test resources such as   <code>src/test/resources/.config/&lt;company&gt;/&lt;app&gt;/</code> and <code>src/test/resources/config/{SCOPE}</code>.</li> <li>Test Mode can be locked down globally with <code>ConfigFactoryBuilder.forbidTestMode()</code>.</li> </ul> <p>Related docs: - test mode - testing configuration</p>"},{"location":"45_ai_guidance.html#prefer-mconfigutil-adapters-for-legacy-interop","title":"Prefer mConfigUtil adapters for legacy interop","text":"<ul> <li><code>ConfigUtil.withOverrides(...)</code>: immutable overlay; prefer over custom map merges.</li> <li><code>ConfigUtil.remapped(...)</code>: prefix remapping for sub-config views.</li> <li><code>ConfigUtil.fromProperties(...)</code>: bridge legacy <code>Properties</code> without re-parsing.</li> </ul> <p>Related docs: - configuration views - <code>mConfigUtil/src/main/java/org/metabit/platform/support/config/util/ConfigUtil.java</code></p>"},{"location":"46_versions.html","title":"4.6 Versions","text":"<p>0.8.5  comprehensive documentation overhaul and restructuring full comment preservation for TOML, INI, and (partial) YAML; separate TOML module write support via ConfigCursor updated examples and starters</p> <p>0.8.0  public relase on github and maven central formats: .properties, .json, .yaml, .toml, .ini sources: JAR, filesystem, environment variables, ZooKeeper, Windows registry dynamic configuration updates, config schemes, input validation, secrets, packaged in multiple modules, mConfigStandard and mConfigFull as POM collections. .deb generated in mConfigTools, in addition to .jar.  user-requested code smell pattern finds its place in mConfigCheese.</p> <p>0.5.3  public release layered configurations, .properties format, raw files, OS-specific defaults, config scheme basics. packaged as a single JAR. JPMS support.</p> <p>0.4.2 first public release, 2018-03-29 released on macven central and metabit repository + website </p>"},{"location":"47_contributing.html","title":"4.7 Contributing","text":"<p>Feature requests and bug reports are welcome. Please use the github issue tracker for now.</p> <p>Pull requests are possible, but please discuss your changes first, follow the code style of the project, and keep the current LICENSE in mind.</p>"},{"location":"48_legal.html","title":"4.8 Legal","text":"<p>The mConfig libraries are provided for use free of charge, including free of charge use in commercial environments.</p> <p>Until the architecture is finalized, metabit reserves the right to change API and contents, and will not allow forks of the source, yet.</p> <p>As of 2026, the mConfig libraries are licensed under Polyform Shield License. See LICENSE file for details.</p>"},{"location":"49_links.html","title":"4.9 Links","text":""},{"location":"49_links.html#491-requirements-and-dependencies","title":"4.9.1 Requirements and Dependencies","text":"<p>mConfig in its Java incarnation requires the Java JRE, version 8 or higher.</p> <p>Additional dependencies are introduced only by its optional modules.</p> <ul> <li>mConfigLoggingSlf4j depends on slf4j-api from the org.slf4j package, see slf4j.org</li> </ul>"},{"location":"49_links.html#492-references","title":"4.9.2 References","text":"<p>mConfig is an original work by metabit, J.Wilkes.</p> <p>Platform specific information was gathered from these sources:</p> <ul> <li>Linux</li> <li></li> <li>Windows</li> <li></li> <li>MacOS</li> <li></li> <li>Android</li> <li>...</li> </ul>"},{"location":"snippets.html","title":"Snippets: Quick Solutions to Common Config Problems","text":"<p>mConfig shines for everyday config pains. Copy-paste these snippets\u2014no setup hassles.</p> <p>Each solves a general problem using mConfig's magic (OS paths, layers, reloads, schemes).</p> <p>Starters for full projects \u2022 FAQ for fixes \u2022 CLI</p>"},{"location":"snippets.html#1-replace-hardcoded-stringsports-zero-magic-strings","title":"1. Replace Hardcoded Strings/Ports (Zero Magic Strings)","text":"<p>Problem: Ports, hosts scattered in code\u2014hard to change/deploy.</p> <pre><code>Config cfg = ConfigUtil.quickConfig(\"myco\", \"myapp\", \"network\");\nString peer = cfg.getString(\"peer\");  // localhost\nint port = cfg.getInteger(\"port\");    // 8080\ndouble prob = cfg.getDouble(\"probability\");  // 0.5\n</code></pre> <p>Place: <code>~/.config/myco/myapp/network.properties</code> (auto-discovered).</p> <p>Why mConfig? Searches OS standards (XDG, AppData), formats (properties/YAML/JSON), reloads live.</p> <p>Getting Started</p>"},{"location":"snippets.html#2-env-vars-structured-config-no-manual-parsing","title":"2. Env Vars \u2192 Structured Config (No Manual Parsing)","text":"<p>Problem: <code>process.env</code> mess; want hierarchical config.</p> <p>Add dep: <code>mConfigSourceEnvVar</code></p> <p>Env vars: <pre><code>myapp_network_peer=localhost\nmyapp_network_port=8080\n</code></pre></p> <pre><code>try (ConfigFactory f = ConfigFactoryBuilder.create(\"myco\", \"myapp\").build()) {\nString peer = f.getConfig(\"network\").getString(\"peer\");  // SESSION override\n}\n</code></pre> <p>Why? <code>&lt;app&gt;_&lt;config&gt;_&lt;key&gt;</code> convention; layers over files.</p> <p>mConfigSourceEnvVar</p>"},{"location":"snippets.html#3-type-safe-config-with-defaultsvalidation","title":"3. Type-Safe Config with Defaults/Validation","text":"<p>Problem: Runtime <code>NumberFormatException</code>; scattered defaults.</p> <p><code>src/main/resources/.config/myco/myapp/network.scheme.json</code>: <pre><code>[{\"name\":\"port\",\"type\":\"int\",\"default\":8080,\"min\":1,\"max\":65535}]\n</code></pre></p> <pre><code>ConfigScheme scheme = ConfigScheme.fromClasspath(\"network.scheme.json\");\nConfig cfg = factory.getConfig(\"network\", scheme);\nint port = cfg.getInteger(\"port\");  // Validates!\n</code></pre> <p>Why? Centralized scheme\u2014no call-site defaults.</p> <p>Configuration Schemes</p>"},{"location":"snippets.html#4-hot-reload-on-file-changes","title":"4. Hot-Reload on File Changes","text":"<p>Problem: Restart for config tweaks? No thanks.</p> <pre><code>Config cfg = factory.getConfig(\"network\");  // Watches files\n// Edit network.properties \u2192 cfg.getInteger(\"port\") updates instantly\n</code></pre> <p>Why? Built-in watcher; no polling/Spring @Refresh.</p> <p>Priorities</p>"},{"location":"snippets.html#5-discover-available-configs-no-guesswork","title":"5. Discover Available Configs (No Guesswork)","text":"<p>Problem: \"Where's my config?\"</p> <pre><code>factory.listAvailableConfigurations().forEach(cdi -&gt;\nSystem.out.println(cdi.getConfigName() + \" @ \" + cdi.getUri())\n);\n</code></pre> <p>Why? Traces sources/scopes; CLI equiv: <code>mconfig myco:myapp list</code></p>"},{"location":"snippets.html#6-secrets-without-log-leaks","title":"6. Secrets Without Log Leaks","text":"<p>Problem: Passwords in logs/heap.</p> <p>In scheme: <code>\"type\":\"secret\"</code></p> <pre><code>SecretValue pw = (SecretValue) cfg.getEntry(\"db.password\");  // Masked: ********\nString clear = pw.clearValue();  // JIT decrypt/use\n</code></pre> <p>mConfigSecrets</p>"},{"location":"snippets.html#7-jpms-compatible-no-illegalaccesserror","title":"7. JPMS-Compatible (No IllegalAccessError)","text":"<p><code>module-info.java</code>: <pre><code>module com.example {\nrequires metabit.mconfig.core;\nrequires metabit.mconfig.util;\n}\n</code></pre></p> <p>Deps: <code>mConfigStandard</code> (BOM) or <code>mConfigBase</code>.</p> <p>JPMS FAQ</p>"},{"location":"snippets.html#8-tests-isolated-configs","title":"8. Tests: Isolated Configs","text":"<pre><code>ConfigFactoryBuilder.setTestMode(true);\nConfigFactoryBuilder.setTestConfigPaths(ConfigScope.USER, List.of(\"src/test/resources\"));\nConfig cfg = ConfigFactoryBuilder.create(\"myco\", \"myapp\").build().getConfig(\"network\");\n</code></pre> <p><code>src/test/resources/.config/myco/myapp/network.properties</code></p> <p>Test Mode</p> <p>Pro Tip: Enable logging (<code>mConfigLoggingSlf4j</code> + DEBUG) for traces.</p> <p>Full Docs</p>"},{"location":"examples/index.html","title":"mConfig Examples","text":""},{"location":"examples/index.html#getting-started","title":"getting started","text":"<p>First, include the following dependency in your project:</p> <p>Maven: <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.metabit.platform.support.config&lt;/groupId&gt;\n&lt;artifactId&gt;mConfigStandard&lt;/artifactId&gt;\n&lt;version&gt;${mconfig.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p> <p>Gradle: <pre><code>implementation 'org.metabit.platform.support.config:mConfigStandard:${mconfig.version}'\n</code></pre></p> <p>Next, in your code, instantiate a Configuration object/handle.</p> <p>The shortcut is something like <code>Configuration cfg = ConfigUtil.quickConfig(\"ACME\", \"ourApp\", \"itsConfig\")</code> but the proper, recommended way is to go like this: <pre><code>    try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\").build())\n{\nConfiguration cfg = factory.getConfiguration(\"itsConfig\"); // ... use cfg ...\n}\n</code></pre> This way, you can set features for the factory, and get different configurations for different purposes.</p> <p>Supplying your company name (in this example, \"ACME\") and application name (\"ourApp\") is expected minimum.</p> <p>These two are used across OS to differentiate between different applications, and avoid conflicts.</p> <ul> <li>You must supply the application name, it is mandatory. </li> <li>If you choose to omit the company name, that may work, but it's not guaranteed - or recommended. (Company name may also be organization, vendor, or anything similar. We call it \"company\" to be consistent with OS conventions.)</li> </ul> <p>From the Configuation, you then get the values you need. It's as simple as this: <pre><code>    String  myString = cfg.getString(\"theStringKey\");\nInteger myInt = cfg.getString(\"theIntKey\");\nbyte[]  myBinary = cfg.getBytes(\"theBinaryKey\");\nList&lt;String&gt; myList = cfg.getStringList(\"theListKey\");\n</code></pre> So, where do I put my configuration files? Before we get into the topic of Scopes, a quick answer: that depends on your OS; and <code>ConfigUtil.printConfigPaths(final String companyName, final String applicationName)</code>  will print you to stdout all the paths where you can find them in your OS.</p> <p>In a regular maven project, you can put the defaults in <code>src/main/resources/.config/</code> and <code>src/test/resources/.config/</code> for development and testing respectively. For above example <code>ACME.ourApp.itsConfig</code> would be in <code>src/main/resources/.config/ACME/ourApp/itsConfig.properties</code>.</p> <p>Also, it doesn't have to be files, but we get to that later.</p>"},{"location":"examples/index.html#scopes-and-overrides","title":"Scopes and Overrides","text":"<p>Some config entries are for the installed application, some are for the current user. Some are for the current machine. And some are your defaults. </p> <p>You can change that (as a lot of things), but out of the box, mConfig uses a layered configuration hierarchy:  the more specific scopes override the less specific ones.</p> <p>So, the local application configuration overrides the defaults; the user configuration overrides the local application configuration, and so on.</p> <p>This is not \"entire file replacement\", it is granular for each entry.</p> <p>And this is also why you should place your defaults in the resources folder, instead of hardcoding them in your code. But if you want to, you can do that too - there's the \"cheese\" module for that.</p> <p>The mConfigStandard module is a sensible minimum to get you started. The mConfigFull module has everything (stable), and in between, your choice.</p> <p>mConfig is not a framework, it is a modular library. You pick and choose what you need. See the mConfig Modules page for more details.</p>"},{"location":"examples/index.html#specific-examples","title":"Specific Examples","text":"<ul> <li>Simple Configuration Loading</li> <li>Testing Configurations</li> <li>Immutable Configuration Views</li> <li>Configuration Scheme Examples</li> <li>Advanced Configuration Handling</li> <li>Integration with CI/CD</li> <li>Crypto Keys and Certificates</li> <li>ZooKeeper Configuration Source</li> </ul>"},{"location":"examples/advanced_configuration_handling.html","title":"Advanced Configuration Handling","text":"<p>This page collects higher-level patterns for controlling how mConfig resolves, validates, and writes configuration data.</p>"},{"location":"examples/advanced_configuration_handling.html#1-write-with-scope-control","title":"1. Write with scope control","text":"<p>Writes are scoped and follow a \"least surprise\" policy:</p> <pre><code>Configuration cfg = factory.getConfiguration(\"network\");\n\ncfg.put(\"server/port\", 8081, ConfigScope.USER);\n</code></pre>"},{"location":"examples/advanced_configuration_handling.html#2-control-file-format-order","title":"2. Control file format order","text":"<p>Reading and writing can use different format orders:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.FILE_FORMAT_READING_PRIORITIES,\nList.of(\"TOML\", \"YAML\", \"JSON\", \"properties\"))\n.setFeature(ConfigFeature.FILE_FORMAT_WRITING_PRIORITIES,\nList.of(\"TOML\", \"YAML\", \"JSON\"));\n</code></pre>"},{"location":"examples/advanced_configuration_handling.html#3-use-strict-schemes","title":"3. Use strict schemes","text":"<p>To reject unknown keys, turn on strict mode:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.SCHEME_STRICT_MODE, true);\n</code></pre>"},{"location":"examples/advanced_configuration_handling.html#4-missing-values-behavior","title":"4. Missing values behavior","text":"<p>If you want scheme defaults instead of exceptions:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.EXCEPTION_ON_MISSING_ENTRY, false)\n.setFeature(ConfigFeature.DEFAULT_ON_MISSING_ENTRY, true);\n</code></pre>"},{"location":"examples/advanced_configuration_handling.html#5-subscribe-to-updates","title":"5. Subscribe to updates","text":"<p>React when values change at runtime:</p> <pre><code>Configuration cfg = factory.getConfiguration(\"network\");\n\ncfg.subscribeToUpdates(location -&gt; {\nSystem.out.println(\"Config changed in scope: \" + location.getScope());\n});\n</code></pre> <p>NB: The changes are automatically propagated to the mConfig Configurations anyhow. If you take the values from the Configurations directly, they will be up-to-date. Above subscription is to support triggering actions when the configuration changes, e.g. thread restarts.</p>"},{"location":"examples/advanced_configuration_handling.html#6-control-scope-fallbacks","title":"6. Control scope fallbacks","text":"<p>By default, mConfig falls back to less specific scopes when a value is missing. You can change that:</p> <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.FALLBACKS_ACROSS_SCOPES, false)\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"network\");\n// Only the requested scope (plus PRODUCT defaults) is considered.\n}\n</code></pre>"},{"location":"examples/advanced_configuration_handling.html#7-prioritize-storage-types","title":"7. Prioritize storage types","text":"<p>If multiple storage backends are available, change their priority within a scope:</p> <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.STORAGE_TYPE_PRIORITIES,\nList.of(\"files\", \"registry\", \"JAR\"))\n.build())\n{\n// Files override registry, registry overrides JAR defaults.\n}\n</code></pre>"},{"location":"examples/advanced_configuration_handling.html#8-use-secrets-providers","title":"8. Use secrets providers","text":"<p>If you have secrets in schemes, add a secrets provider to resolve them:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.SECRETS_PROVIDER_ID, \"my-secrets\")\n.setSecretsProviderConfig(Map.of(\"endpoint\", \"https://vault.example\"));\n</code></pre> <p>Related docs: - Config Features - Priorities and Hierarchies - Writing Configurations</p>"},{"location":"examples/configuration_views.html","title":"Immutable Configuration Views","text":"<p>These utility methods in <code>ConfigUtil</code> create lightweight, immutable <code>Configuration</code> views for overrides, prefix remapping, and <code>Properties</code> adaptation. They support chaining and inherit scheme validation where applicable.</p>"},{"location":"examples/configuration_views.html#withoverrides","title":"withOverrides","text":"<p>Overlay in-memory overrides on a parent <code>Configuration</code>:</p> <pre><code>Configuration parent = factory.getConfiguration(\"app\");\nMap&lt;String, Object&gt; overrides = Map.of(\n\"db.host\", \"localhost\",\n\"db.port\", 5432\n);\nConfiguration cfg = ConfigUtil.withOverrides(parent, overrides);\n\nString host = cfg.getString(\"db.host\"); // \"localhost\"\nInteger port = cfg.getInteger(\"db.port\"); // 5432 (auto-convert)\n</code></pre> <ul> <li>Overrides take precedence.</li> <li>Lazy type conversion (null on parse fail).</li> <li>If <code>parent</code> has <code>ConfigScheme</code>, validates overrides (throws <code>IllegalArgumentException</code> on mismatch).</li> <li><code>getAllConfigurationKeysFlattened()</code>: union of keys.</li> </ul>"},{"location":"examples/configuration_views.html#remapped","title":"remapped","text":"<p>Remap prefixed keys for sub-config views (e.g., DB modules):</p> <pre><code>Configuration cfg = ConfigUtil.remapped(parent, \"super_db.\", \"db.\");\nString host = cfg.getString(\"db.host\"); // \u2192 parent.getString(\"super_db.host\")\nString other = cfg.getString(\"other.key\"); // passthru\n</code></pre> <ul> <li><code>get(\"db.xxx\")</code> \u2192 <code>parent.get(\"super_db.xxx\")</code>.</li> <li>Non-matching keys delegate directly.</li> <li>Trims prefixes/keys aggressively.</li> <li>Uniform for all typed getters; projects <code>getAll*</code>.</li> <li>Inherits scheme.</li> </ul>"},{"location":"examples/configuration_views.html#fromproperties","title":"fromProperties","text":"<p>Adapt legacy <code>java.util.Properties</code>:</p> <pre><code>Properties props = new Properties();\nprops.setProperty(\"key1\", \"value1\");\nprops.setProperty(\"key2\", \"42\");\nConfiguration cfg = ConfigUtil.fromProperties(props);\n\nString v1 = cfg.getString(\"key1\"); // \"value1\"\nInteger v2 = cfg.getInteger(\"key2\"); // 42 (null on fail)\n</code></pre> <ul> <li>Lazy parsing, null on errors.</li> <li>No scheme.</li> <li><code>getAllConfigurationKeysFlattened()</code>: props keys.</li> </ul>"},{"location":"examples/configuration_views.html#chaining","title":"Chaining","text":"<p>Combine freely:</p> <pre><code>Configuration dbView = ConfigUtil.withOverrides(\nConfigUtil.remapped(parent, \"legacy_db.\", \"db.\"), Map.of(\"db.timeout\", 30)\n);\n</code></pre> <p>Views are read-only (<code>put*</code> throws <code>UnsupportedOperationException</code>).\"</p>"},{"location":"examples/handling_crypto_keys_and_certificates.html","title":"Handling Cryptographic Keys and Certificates with mConfig","text":"<p>mConfig supports storing and retrieving cryptographic material (keys, certificates) securely using <code>SecretValue</code>.  Binary data (DER) is stored as <code>BYTES</code> entries marked as <code>SECRET</code> in schemes.  PEM can be stored as <code>STRING</code> or <code>BYTES</code> and parsed with BouncyCastle.</p> <p>Note: Sensitive data is redacted in logs. Use <code>SecretValue.erase()</code> after use.</p>"},{"location":"examples/handling_crypto_keys_and_certificates.html#1-prerequisites","title":"1. Prerequisites","text":"<ul> <li>JCE: Included in JDK.</li> <li>BouncyCastle (optional, for PEM/EC/FIPS): Add to classpath:   Maven:   <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;\n&lt;artifactId&gt;bcprov-jdk18on&lt;/artifactId&gt;\n&lt;version&gt;1.78&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>   Gradle:   <pre><code>implementation 'org.bouncycastle:bcprov-jdk18on:1.78'\n</code></pre></li> <li>Mark scheme entries as <code>SECRET</code>:   <pre><code>{\n\"keys/rsa/private\": {\n\"type\": \"BYTES\", \"flags\": [\"SECRET\"],\n\"secretType\": \"PRIVATE_KEY\"\n},\n\"certs/server\": {\n\"type\": \"BYTES\",\n\"flags\": [\"SECRET\"],\n\"secretType\": \"CERTIFICATE\"\n}\n}\n</code></pre></li> </ul>"},{"location":"examples/handling_crypto_keys_and_certificates.html#2-setup-configfactory","title":"2. Setup ConfigFactory","text":"<pre><code>ConfigScheme scheme = ConfigScheme.fromJSON(...) // load scheme\nConfigFactory factory = ConfigFactoryBuilder.create(\"mycompany\", \"myapp\")\n.setFeature(ConfigFeature.CONFIG_SCHEME_LIST, Map.of(\"crypto\", scheme))\n.build();\nConfiguration config = factory.getConfig(\"crypto\");\n</code></pre> <p>Instead of specifying the scheme programmatically, you can also  place the scheme file in the respective resource directory within the jar/classpath. (separate folders below \"main\" for production, below \"test\" for integration tests.)</p>"},{"location":"examples/handling_crypto_keys_and_certificates.html#3-generate-and-store-rsa-keypair-jce","title":"3. Generate and Store RSA Keypair (JCE)","text":"<pre><code>import java.security.*;\n\n// Generate\nKeyPairGenerator kpg = KeyPairGenerator.getInstance(\"RSA\");\nkpg.initialize(2048);\nKeyPair kp = kpg.generateKeyPair();\n\n// DER bytes\nbyte[] privDer = kp.getPrivate().getEncoded();\nbyte[] pubDer = kp.getPublic().getEncoded();\n\n// Store as SecretValue (auto-typed if scheme helps)\nconfig.put(\"keys/rsa/private\", new BasicSecretValue(privDer, SecretType.PRIVATE_KEY), ConfigScope.USER);\nconfig.put(\"keys/rsa/public\", pubDer, ConfigScope.USER); // Public OK as non-secret\n\n// To HOST scope (elevated privs may be needed)\nconfig.put(\"keys/rsa/private\", new BasicSecretValue(privDer, SecretType.PRIVATE_KEY), ConfigScope.HOST);\n</code></pre>"},{"location":"examples/handling_crypto_keys_and_certificates.html#4-read-der-private-key-jce","title":"4. Read DER Private Key (JCE)","text":"<pre><code>SecretValue privSecret = config.getSecret(\"keys/rsa/private\");\nif (privSecret != null) {\nbyte[] derBytes = privSecret.getValue();\nKeyFactory kf = KeyFactory.getInstance(\"RSA\");\nPKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(derBytes);\nPrivateKey privateKey = kf.generatePrivate(keySpec);\nprivSecret.erase(); // Secure wipe\n}\n</code></pre>"},{"location":"examples/handling_crypto_keys_and_certificates.html#5-generate-and-store-self-signed-x509-certificate-bouncycastle","title":"5. Generate and Store Self-Signed X.509 Certificate (BouncyCastle)","text":"<pre><code>import org.bouncycastle.jce.provider.BouncyCastleProvider;\nimport org.bouncycastle.cert.*; // etc.\n// ...\nSecurity.addProvider(new BouncyCastleProvider());\n\nKeyPairGenerator kpg = KeyPairGenerator.getInstance(\"RSA\", \"BC\");\nkpg.initialize(2048);\nKeyPair kp = kpg.generateKeyPair();\n\nlong now = System.currentTimeMillis();\nX500Name issuer = new X500Name(\"CN=TestCA\");\nBigInteger serial = BigInteger.valueOf(now);\nDate notBefore = new Date(now - 5000);\nDate notAfter = new Date(now + 365L * 24 * 3600 * 1000);\n\nContentSigner signer = new JcaContentSignerBuilder(\"SHA256withRSA\").setProvider(\"BC\").build(kp.getPrivate());\nX509v3CertificateBuilder builder = new JcaX509v3CertificateBuilder(issuer, serial, notBefore, notAfter, issuer, kp.getPublic());\nX509CertificateHolder holder = builder.build(signer);\nX509Certificate cert = new JcaX509CertificateConverter().setProvider(\"BC\").getCertificate(holder);\n\n// Store DER\nbyte[] certDer = cert.getEncoded();\nconfig.put(\"certs/server\", new BasicSecretValue(certDer, SecretType.CERTIFICATE), ConfigScope.USER);\n</code></pre>"},{"location":"examples/handling_crypto_keys_and_certificates.html#6-read-x509-certificate-jce","title":"6. Read X.509 Certificate (JCE)","text":"<pre><code>SecretValue certSecret = config.getSecret(\"certs/server\");\nif (certSecret != null)\n{\nbyte[] derBytes = certSecret.getValue();\nCertificateFactory cf = CertificateFactory.getInstance(\"X.509\");\nX509Certificate cert = (X509Certificate) cf.generateCertificate(new ByteArrayInputStream(derBytes));\ncertSecret.erase();\n}\n</code></pre>"},{"location":"examples/handling_crypto_keys_and_certificates.html#7-pem-handling-bouncycastle","title":"7. PEM Handling (BouncyCastle)","text":""},{"location":"examples/handling_crypto_keys_and_certificates.html#generate-pem-private-key","title":"Generate PEM Private Key","text":"<pre><code>import org.bouncycastle.util.io.pem.PemWriter;\nimport org.bouncycastle.openssl.PEMEncryptedKeyPair;\nimport org.bouncycastle.openssl.jcajce.JcaPEMWriter; // Simpler\n\ntry (StringWriter sw = new StringWriter(); JcaPEMWriter pemWriter = new JcaPEMWriter(sw)) {\npemWriter.writeObject(kp.getPrivate());\nString pem = sw.toString();\nconfig.put(\"keys/rsa/private.pem\", pem, ConfigScope.USER); // STRING\n}\n</code></pre>"},{"location":"examples/handling_crypto_keys_and_certificates.html#read-pem-private-key","title":"Read PEM Private Key","text":"<pre><code>String pemStr = (String) config.getValue(\"keys/rsa/private.pem\"); // or SecretValue if marked\ntry (PEMParser pemParser = new PEMParser(new StringReader(pemStr)))\n{\nObject obj = pemParser.readObject();\nif (obj instanceof PEMKeyPair)\n{\nPEMKeyPair pemPair = (PEMKeyPair) obj;\nJcaPEMKeyConverter conv = new JcaPEMKeyConverter().setProvider(\"BC\");\nPrivateKey privKey = conv.getPrivateKey(pemPair.getPrivateKeyInfo());\n}\n}\n</code></pre>"},{"location":"examples/handling_crypto_keys_and_certificates.html#8-writing-to-specific-scopesdirs","title":"8. Writing to Specific Scopes/Dirs","text":"<p>mConfig writes to OS-standard paths: - USER: <code>~/.config/&lt;company&gt;/&lt;app&gt;/crypto</code> (JSON/TOML/etc.) - HOST: <code>/etc/&lt;app&gt;/crypto</code> (Linux; admin req'd)</p> <p>Use <code>config.put(key, value, scope)</code>.</p>"},{"location":"examples/handling_crypto_keys_and_certificates.html#tips","title":"Tips","text":"<ul> <li>Use <code>SecretType.PRIVATE_KEY</code>, <code>CERTIFICATE</code> for typing.</li> <li>Tests: integrationtestSecretsBC/JCE verify roundtrip.</li> <li>Prod: Rotate keys via CLI <code>mconfig set --scope USER</code>.</li> </ul> <p>See ../44_design_consolidated.md for more.</p>"},{"location":"examples/integration_with_cicd.html","title":"Integration with CI/CD","text":"<p>This example shows how to make mConfig predictable in CI/CD and automated pipelines.</p>"},{"location":"examples/integration_with_cicd.html#1-enable-test-mode-via-environment-variables","title":"1. Enable Test Mode via environment variables","text":"<p>mConfig can enable Test Mode without code changes when <code>ALLOW_MCONFIG_RUNTIME_SETTINGS</code> is on.</p> <pre><code>export MCONFIG_RUNTIME_TEST_MODE=true\nexport MCONFIG_RUNTIME_DEBUG_LEVEL=debug\n</code></pre> <p>In code, allow runtime settings: <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.ALLOW_MCONFIG_RUNTIME_SETTINGS, true)\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"network\");\n}\n</code></pre></p>"},{"location":"examples/integration_with_cicd.html#2-keep-test-configs-in-test-resources","title":"2. Keep test configs in test resources","text":"<p>CI usually runs tests from the build tree. Keep your test configs here: - <code>src/test/resources/.config/ACME/ourApp/network.properties</code></p>"},{"location":"examples/integration_with_cicd.html#3-prefer-configuration-schemes-in-ci","title":"3. Prefer configuration schemes in CI","text":"<p>Schemes are recommended in CI because they: 1. Prevent most cases of incomplete configs by providing defaults. 2. Enforce mandatory values and validation rules early.</p> <p>Add a scheme in test resources: - <code>src/test/resources/.config/ACME/ourApp/network.scheme.json</code></p> <pre><code>[\n{ \"KEY\": \"server/host\", \"TYPE\": \"STRING\", \"DEFAULT\": \"127.0.0.1\" },\n{ \"KEY\": \"server/port\", \"TYPE\": \"NUMBER\", \"DEFAULT\": 8080 },\n{ \"KEY\": \"server/tls\", \"TYPE\": \"BOOLEAN\", \"DEFAULT\": false }\n]\n</code></pre>"},{"location":"examples/integration_with_cicd.html#4-use-explicit-test-directories-optional","title":"4. Use explicit test directories (optional)","text":"<p>If your CI environment mounts a special directory, point mConfig at it:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setTestMode(true)\n.setFeature(ConfigFeature.TESTMODE_DIRECTORIES,\nList.of(\"USER:/mnt/ci/config/user\", \"APPLICATION:/mnt/ci/config/app\"));\n</code></pre>"},{"location":"examples/integration_with_cicd.html#5-pin-formats-and-storage-priority-optional","title":"5. Pin formats and storage priority (optional)","text":"<p>Avoid surprises from environment changes by pinning priorities:</p> <pre><code>ConfigFactoryBuilder builder = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setFeature(ConfigFeature.FILE_FORMAT_READING_PRIORITIES,\nList.of(\"TOML\", \"YAML\", \"JSON\", \"properties\"))\n.setFeature(ConfigFeature.STORAGE_TYPE_PRIORITIES,\nList.of(\"files\", \"JAR\"));\n</code></pre> <p>Related docs: - Test Mode - Configuration Schemes - Config Features</p>"},{"location":"examples/java-modules.html","title":"Java Platform Module System (JPMS)","text":"<p>Java 9 introduced the Java Platform Module System (JPMS), often referred to as \"Java Modules\". JPMS adds strong encapsulation and explicit dependencies between modules.</p> <p>mConfig is modular and uses JPMS so you can choose only the parts you need. If your application uses <code>module-info.java</code>, you should explicitly declare the mConfig modules you depend on.</p>"},{"location":"examples/java-modules.html#why-this-matters","title":"Why this matters","text":"<ul> <li>Stronger encapsulation: internal packages are hidden unless exported.</li> <li>Explicit dependencies: missing <code>requires</code> entries cause compile-time errors.</li> <li>Service loading: mConfig uses the service loader to discover formats and sources.</li> </ul>"},{"location":"examples/java-modules.html#minimal-module-infojava","title":"Minimal <code>module-info.java</code>","text":"<p>If you only use the core and utility APIs: <pre><code>module my.app {\nrequires metabit.mconfig.core;\nrequires metabit.mconfig.util;\n}\n</code></pre></p>"},{"location":"examples/java-modules.html#typical-setup","title":"Typical setup","text":"<p>If you use the standard bundle: <pre><code>module my.app {\n// ...\nrequires metabit.mconfig.core;\nrequires metabit.mconfig.scheme;\nrequires metabit.mconfig.secrets;\nrequires metabit.mconfig.util;\nrequires metabit.mconfig.modules.jar;\nrequires metabit.mconfig.modules.filesystem;\nrequires metabit.mconfig.format.javaproperties;\n// ...\n}\n</code></pre></p>"},{"location":"examples/java-modules.html#notes-on-auto-discovery","title":"Notes on auto-discovery","text":"<p>Most format and source modules are discovered via the service loader. You do not need to <code>requires</code> them directly unless you reference their classes. But they must be on the classpath, and visible to the service loader.</p> <p>Related docs: - Getting Started - mConfig Modules</p>"},{"location":"examples/mconfig-modules.html","title":"mConfig Modules","text":"<p>mConfig is a modular library with which you can pick and choose the components you need.</p>"},{"location":"examples/mconfig-modules.html#choosing-your-modules","title":"Choosing Your Modules","text":"<ul> <li>Start simple: Use <code>mConfigStandard</code> for most applications</li> <li>Need more formats?: Use <code>mConfigFull</code> to get JSON, YAML, and JSON5 support</li> <li>Custom setup: Include only the specific modules you need</li> <li>Reduce if needed: start with 'mConfigCore' and add only what you need</li> </ul> <p>All modules share the same version number and are designed to work together seamlessly.</p> <p>Just add the modules you need to your project's dependencies. mConfig will automatically load them at runtime, when they are in the classpath.</p> <p>Java JPMS (since Java 9) considerations: see Java Platform Module System.</p>"},{"location":"examples/mconfig-modules.html#mconfigstandard-modules","title":"mConfigStandard Modules","text":"<p>The <code>mConfigStandard</code> module provides a sensible minimum configuration to get started quickly.</p> Module Artifact ID Description Core API mConfigCore Core interfaces and base classes File Source mConfigSourceFile configuration from files in standard OS locations System Properties Source mConfigSourceSystemProperties configuration from Java system properties Properties Format mConfigFormatJavaProperties Support for Java .properties file format <p>Maven: <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.metabit.platform.support.config&lt;/groupId&gt;\n&lt;artifactId&gt;mConfigStandard&lt;/artifactId&gt;\n&lt;version&gt;${mconfig.version}&lt;/version&gt;\n&lt;type&gt;pom&lt;/type&gt;\n&lt;/dependency&gt;\n</code></pre> Caveat: Do not omit/forget the type being <code>pom</code>.</p> <p>Gradle: <pre><code>implementation 'org.metabit.platform.support.config:mConfigStandard:${mconfig.version}'\n</code></pre></p>"},{"location":"examples/mconfig-modules.html#additional-mconfigfull-modules","title":"Additional mConfigFull Modules","text":"<p>The <code>mConfigFull</code> module includes everything from <code>mConfigStandard</code> plus additional mature, stable modules:</p> Module Artifact ID Description Environment Variables Source mConfigSourceEnvVar Read configuration from environment variables Windows Registry Source mConfigWinRegistry Read configuration from Windows Registry (Windows only) JSON Format mConfigFormatJSONwithJackson Support for JSON configuration files using Jackson JSON5 Format mConfigFormatJSONwithJackson Support for JSON5 configuration files using Jackson YAML (Jackson) Format mConfigFormatYAMLwithJackson Support for YAML configuration files using Jackson YAML (SnakeYAML) Format mConfigFormatYAMLwithSnakeYAML Support for YAML configuration files using SnakeYAML TOML Format mConfigFormatTOMLwithJackson Support for TOML configuration files using Jackson INI Format mConfigFormatINI Support for INI configuration files Mapper mConfigMapper Map configuration to Java objects SLF4J Logging mConfigLoggingSlf4j Logging integration with SLF4J <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.metabit.platform.support.config&lt;/groupId&gt;\n&lt;artifactId&gt;mConfigFull&lt;/artifactId&gt;\n&lt;version&gt;${mconfig.version}&lt;/version&gt;\n&lt;type&gt;pom&lt;/type&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"examples/mconfig-modules.html#other-available-modules","title":"Other Available Modules","text":"<p>Additional modules that are not included in <code>mConfigStandard</code> or <code>mConfigFull</code>:</p> Module Artifact ID Description Cheese mConfigCheese some fragrant code for those with a taste for it"},{"location":"examples/mconfig-modules.html#planned-modules","title":"planned Modules","text":"Module Artifact ID Description XML Format mConfigFormatXML Support for XML configuration files JUL Logging mConfigLoggingJUL Logging integration with Java Util Logging (Database Source) mConfigSource(DatabaseName) Read configuration from database (Remote Source) mConfigSource(NetworkService) Read configuration from remote servers"},{"location":"examples/schemes.html","title":"Configuration Scheme Examples","text":"<p>This page provides various examples of configuration schemes, ranging from simple key-value pairs to complex nested structures with validation.</p>"},{"location":"examples/schemes.html#1-simple-application-configuration","title":"1. Simple Application Configuration","text":"<p>A basic scheme for a small application with a few parameters.</p> <pre><code>[\n{\n\"KEY\": \"app/name\",\n\"TYPE\": \"STRING\",\n\"DESCRIPTION\": \"The name of the application.\",\n\"DEFAULT\": \"My Awesome App\"\n},\n{\n\"KEY\": \"app/version\",\n\"TYPE\": \"STRING\",\n\"PATTERN\": \"\\\\d+\\\\.\\\\d+\\\\.\\\\d+\",\n\"DESCRIPTION\": \"Application version (SemVer).\",\n\"MANDATORY\": true\n},\n{\n\"KEY\": \"app/debug\",\n\"TYPE\": \"BOOLEAN\",\n\"DEFAULT\": false\n}\n]\n</code></pre>"},{"location":"examples/schemes.html#2-network-and-server-settings","title":"2. Network and Server Settings","text":"<p>Using numeric ranges, enums, and list types.</p> <pre><code>{\n\"network-settings\": {\n\"NAME\": \"network-settings\",\n\"ENTRIES\": [\n{\n\"KEY\": \"server/host\",\n\"TYPE\": \"STRING\",\n\"DEFAULT\": \"localhost\",\n\"DESCRIPTION\": \"Hostname or IP address.\"\n},\n{\n\"KEY\": \"server/port\",\n\"TYPE\": \"NUMBER\",\n\"PATTERN\": \"uint16\",\n\"DEFAULT\": 8080,\n\"DESCRIPTION\": \"Port number (0-65535).\"\n},\n{\n\"KEY\": \"server/logLevel\",\n\"TYPE\": \"ENUM\",\n\"PATTERN\": \"DEBUG|INFO|WARN|ERROR\",\n\"DEFAULT\": \"INFO\"\n},\n{\n\"KEY\": \"server/allowedIps\",\n\"TYPE\": \"MULTIPLE_STRINGS\",\n\"ARITY\": \"1..*\",\n\"DESCRIPTION\": \"A list of IP addresses that are allowed to connect.\"\n}\n]\n}\n}\n</code></pre>"},{"location":"examples/schemes.html#3-database-configuration-with-secrets","title":"3. Database Configuration with Secrets","text":"<p>Handling sensitive data and mandatory fields.</p> <pre><code>[\n{\n\"KEY\": \"db/url\",\n\"TYPE\": \"STRING\",\n\"MANDATORY\": true,\n\"DESCRIPTION\": \"JDBC connection URL.\"\n},\n{\n\"KEY\": \"db/username\",\n\"TYPE\": \"STRING\",\n\"DEFAULT\": \"admin\"\n},\n{\n\"KEY\": \"db/password\",\n\"TYPE\": \"STRING\",\n\"SECRET\": true,\n\"DESCRIPTION\": \"Database password (will be redacted in logs).\"\n},\n{\n\"KEY\": \"db/poolSize\",\n\"TYPE\": \"NUMBER\",\n\"PATTERN\": \"[1, 50]\",\n\"DEFAULT\": 10\n}\n]\n</code></pre>"},{"location":"examples/schemes.html#4-complex-validation-with-arity","title":"4. Complex Validation with Arity","text":"<p>Using <code>ENUM_SET</code> and arity constraints.</p> <pre><code>{\n\"advanced-features\": {\n\"ENTRIES\": [\n{\n\"KEY\": \"features/enabled\",\n\"TYPE\": \"ENUM_SET\",\n\"PATTERN\": \"LOGGING|METRICS|TRACING|AUTH\",\n\"ARITY\": \"1..3\",\n\"DEFAULT\": [\"LOGGING\", \"METRICS\"],\n\"DESCRIPTION\": \"Select up to 3 features to enable.\"\n}\n]\n}\n}\n</code></pre>"},{"location":"examples/simple_configuration_loading.html","title":"Simple Configuration Loading","text":"<p>This example shows the minimal setup for loading a configuration and reading a few values.</p>"},{"location":"examples/simple_configuration_loading.html#1-create-a-factory-and-configuration","title":"1. Create a factory and configuration","text":"<pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\").build())\n{\nConfiguration cfg = factory.getConfiguration(\"network\");\n\nString host = cfg.getString(\"server/host\");\nint port = cfg.getInteger(\"server/port\");\nboolean tls = cfg.getBoolean(\"server/tls\");\n}\n</code></pre>"},{"location":"examples/simple_configuration_loading.html#2-provide-defaults-recommended","title":"2. Provide defaults (recommended)","text":"<p>Add defaults in your resources so the configuration works out of the box: <code>src/main/resources/.config/ACME/ourApp/network.properties</code></p> <p>Example contents: <pre><code>server.host=127.0.0.1\nserver.port=8080\nserver.tls=false\n</code></pre></p>"},{"location":"examples/simple_configuration_loading.html#3-optional-add-a-scheme","title":"3. Optional: add a scheme","text":"<p>Add a scheme next to the config file to define types and defaults: <code>src/main/resources/.config/ACME/ourApp/network.scheme.json</code></p> <pre><code>[\n{ \"KEY\": \"server/host\", \"TYPE\": \"STRING\", \"DEFAULT\": \"127.0.0.1\" },\n{ \"KEY\": \"server/port\", \"TYPE\": \"NUMBER\", \"DEFAULT\": 8080 },\n{ \"KEY\": \"server/tls\", \"TYPE\": \"BOOLEAN\", \"DEFAULT\": false }\n]\n</code></pre> <p>Related docs: - Getting Started - Configuration Schemes</p>"},{"location":"examples/testing_configurations.html","title":"Testing Configurations","text":"<p>This example shows how to enable Test Mode and point mConfig at test-specific directories.</p>"},{"location":"examples/testing_configurations.html#1-enable-test-mode-in-code","title":"1. Enable Test Mode in code","text":"<pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setTestMode(true)\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"network\");\n// ... test using cfg ...\n}\n</code></pre>"},{"location":"examples/testing_configurations.html#2-provide-test-only-config-files","title":"2. Provide test-only config files","text":"<p>Place test configurations in your test resources: - <code>src/test/resources/.config/ACME/ourApp/network.properties</code></p> <p>These take precedence in Test Mode, keeping production defaults intact.</p>"},{"location":"examples/testing_configurations.html#3-junit-example","title":"3. JUnit example","text":"<pre><code>import static org.junit.jupiter.api.Assertions.assertEquals;\n\nimport org.junit.jupiter.api.Test;\nimport org.metabit.platform.support.config.*;\n\nclass NetworkConfigTest {\n\n@Test\nvoid loadsTestConfigDefaults() throws Exception {\ntry (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setTestMode(true)\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"network\");\n\nassertEquals(\"127.0.0.1\", cfg.getString(\"server/host\"));\nassertEquals(8080, cfg.getInteger(\"server/port\"));\n}\n}\n}\n</code></pre>"},{"location":"examples/testing_configurations.html#4-override-test-directories-explicitly-optional","title":"4. Override test directories explicitly (optional)","text":"<p>If you want to point to custom test directories, use <code>TESTMODE_DIRECTORIES</code>: <pre><code>try (ConfigFactory factory = ConfigFactoryBuilder.create(\"ACME\", \"ourApp\")\n.setTestMode(true)\n.setFeature(ConfigFeature.TESTMODE_DIRECTORIES,\nList.of(\"USER:/tmp/mconfig-tests/user\", \"APPLICATION:/tmp/mconfig-tests/app\"))\n.build())\n{\nConfiguration cfg = factory.getConfiguration(\"network\");\n// ...\n}\n</code></pre></p>"},{"location":"examples/testing_configurations.html#5-security-note","title":"5. Security note","text":"<p>Test Mode can be disabled globally with <code>ConfigFactoryBuilder.forbidTestMode()</code>. If you do that, <code>TEST_MODE</code> and <code>setTestMode(true)</code> have no effect.</p> <p>Related docs: - Test Mode - Configuration Schemes</p>"},{"location":"examples/zookeeper.html","title":"ZooKeeper Configuration Source (Experimental)","text":"<p>The <code>mConfigSourceZooKeeper</code> module allows mConfig to retrieve configuration data from an Apache ZooKeeper ensemble. This is particularly useful for cluster-wide or organization-wide settings.</p>"},{"location":"examples/zookeeper.html#1-bootstrap-configuration","title":"1. Bootstrap Configuration","text":"<p>Following the \"self-configuration\" principle, the ZooKeeper source doesn't require hardcoded connection strings in your application code. Instead, it looks for its own settings in a configuration named <code>zookeeper</code>.</p> <p>You can provide these bootstrap settings in any standard mConfig location, such as a JAR resource (for defaults) or a local file (for overrides).</p>"},{"location":"examples/zookeeper.html#example-configzookeeperjson-bootstrap","title":"Example: <code>.config/zookeeper.json</code> (Bootstrap)","text":"<p>Place this file in <code>src/main/resources/.config/zookeeper.json</code> or <code>/etc/metabit/myapp/zookeeper.json</code>.</p> <pre><code>{\n\"zookeeper\": {\n\"connectString\": \"zk-node-1:2181,zk-node-2:2181,zk-node-3:2181\",\n\"rootPath\": \"/mconfig/prod\",\n\"sessionTimeoutMs\": 30000\n}\n}\n</code></pre>"},{"location":"examples/zookeeper.html#2-data-structure-in-zookeeper","title":"2. Data Structure in ZooKeeper","text":"<p>By default, the ZooKeeper source registers itself for the <code>CLUSTER</code> and <code>ORGANIZATION</code> scopes. It maps configuration names to ZNode paths relative to the <code>rootPath</code>.</p> <p>If your <code>rootPath</code> is <code>/mconfig/prod</code>, and you request a configuration named <code>database-settings</code>, the source will look at: - <code>/mconfig/prod/cluster/database-settings</code> - <code>/mconfig/prod/organization/database-settings</code></p> <p>The content of the ZNode should be in a supported format (like JSON or Java Properties).</p>"},{"location":"examples/zookeeper.html#example-znode-content-at-mconfigprodclusterapp-config","title":"Example: ZNode content at <code>/mconfig/prod/cluster/app-config</code>","text":"<pre><code>{\n\"database\": {\n\"host\": \"prod-db-server\",\n\"port\": 5432\n},\n\"features\": {\n\"enableNewDashboard\": true\n}\n}\n</code></pre>"},{"location":"examples/zookeeper.html#3-usage-in-code","title":"3. Usage in Code","text":"<p>To use the ZooKeeper source, simply include the <code>mConfigSourceZooKeeper</code> module in your classpath. mConfig will automatically discover and initialize it.</p> <pre><code>// Standard initialization\ntry (ConfigFactory factory = ConfigFactoryBuilder.create(\"metabit\", \"myapp\").build())\n{\n// Requesting a configuration that might be in ZooKeeper\nConfiguration config = factory.getConfig(\"app-config\");\n\n// Accessing values (mConfig handles the layering)\nString dbHost = config.getString(\"database/host\");\nboolean useDashboard = config.getBoolean(\"features/enableNewDashboard\");\n}\n</code></pre>"},{"location":"examples/zookeeper.html#4-how-it-works-self-configuration","title":"4. How it Works (Self-Configuration)","text":"<p>The ZooKeeper source follows a specific startup sequence:</p> <ol> <li>Local Initialization: <code>JARConfigSource</code> and <code>FileConfigStorage</code> are initialized first.</li> <li>Bootstrap Lookup: <code>ZooKeeperConfigStorage</code> calls <code>factory.getConfig(\"zookeeper\")</code>. This request is resolved using the already initialized local sources.</li> <li>Activation: If a <code>connectString</code> is found, the storage connects to ZooKeeper and adds its networked locations to the global search list.</li> <li>Transparent Layering: Subsequent calls to <code>factory.getConfig(\"app-config\")</code> will now automatically include layers found in ZooKeeper, prioritized by scope (e.g., <code>CLUSTER</code> settings will override <code>DEFAULT</code> settings from the JAR).</li> </ol>"},{"location":"examples/zookeeper.html#5-test-mode-isolation","title":"5. Test Mode Isolation","text":"<p>In <code>TEST_MODE</code>, the ZooKeeper source will naturally point to your test resources (e.g., <code>src/test/resources/.config/zookeeper.json</code>). This ensures that unit tests do not accidentally connect to production ZooKeeper ensembles.</p> <p>Related docs: - Test Mode</p>"}]}